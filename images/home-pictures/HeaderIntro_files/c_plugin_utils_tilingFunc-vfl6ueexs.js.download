define(["exports"],(function(t){"use strict";const a=t=>t/180*Math.PI,e=({image:t,scale:e,opacity:n,angle:o})=>{const h=a(o),i=document.createElement("canvas"),s=i.getContext("2d");if(!s)throw new Error("Cannot draw on canvas");const c=t.width*e,r=t.height*e;i.width=Math.round(Math.abs(c*Math.cos(h))+Math.abs(r*Math.sin(h))),i.height=Math.round(Math.abs(c*Math.sin(h))+Math.abs(r*Math.cos(h)));let l=0,d=0;return o<90?d=c*Math.sin(h):o<180?(l=-c*Math.cos(h),d=c*Math.sin(h)-r*Math.cos(h)):o<270?(l=-c*Math.cos(h)-r*Math.sin(h),d=-r*Math.cos(h)):l=-r*Math.sin(h),s.globalAlpha=n,s.translate(l,d),s.rotate(-h),s.drawImage(t,0,0,c,r),{canvas:i,actualUnrotatedHeight:r,actualUnrotatedWidth:c}},n=(t,a,e,n,o=!1)=>{t.save(),t.font=`${e}px ${n}`;const h=t.measureText(a);return t.restore(),o?{width:h.width,height:h.actualBoundingBoxAscent+h.actualBoundingBoxDescent||e}:{width:h.width,height:h.fontBoundingBoxAscent+h.fontBoundingBoxDescent||e}},o=({text:t,size:e,fontFamily:o,color:h,opacity:i,angle:s})=>{const c=a(s),r=document.createElement("canvas"),l=r.getContext("2d");if(!l)throw new Error("Cannot draw on canvas");const{width:d,height:M}=n(l,t,e,o);r.width=Math.abs(d*Math.cos(c))+Math.abs(M*Math.sin(c)),r.height=Math.abs(d*Math.sin(c))+Math.abs(M*Math.cos(c));let g="#000";"light"===h&&(g="#fff"),l.font=`${e}px ${o}`,l.globalAlpha=i,l.fillStyle=g,l.textBaseline="bottom";let u=0,w=r.height;s<90?u=M*Math.sin(c):s<180?(u=M*Math.sin(c)-d*Math.cos(c),w+=M*Math.cos(c)):s<270?(u=-d*Math.cos(c),w=0):w+=d*Math.sin(c),l.translate(u,w),l.rotate(-c),l.fillText(t,0,0);const{width:f,height:m}=n(l,t,e,o,!0);return{canvas:r,actualUnrotatedHeight:m,actualUnrotatedWidth:f}};t.drawImageTile=e,t.drawTextTile=o,t.tilingFunc=({scale:t,mode:n,imageWatermarkOptions:h,textWatermarkOptions:i})=>{let s=i;"image"===n&&(s=h);const{angle:c}=s,r=a(c)%(Math.PI/2);let l,d,M;if("text"===n){const{text:a,size:e,fontFamily:n,color:h,opacity:s}=i,r=o({text:a,size:e*t,fontFamily:n,color:h,opacity:s,angle:c});l=r.canvas,d=r.actualUnrotatedHeight,M=r.actualUnrotatedWidth}else{const{image:a,size:n,opacity:o}=h;if(!a)throw new Error("NO_TILE_INPUT");const i=e({image:a,scale:n*t,opacity:o,angle:c});l=i.canvas,d=i.actualUnrotatedHeight,M=i.actualUnrotatedWidth}const g=Math.max(d,M);let u=g/2,w=g/2;"text"===n&&(u=2*d,w=i.lineHeight*d);const f=M+u,m=d+w;let x=0,p=0,b=0;return c%180==0?(x=f,p=m,b=u/-1.2):c%180==90?(x=m,p=f):c>0&&c<90||c>180&&c<270?(x=m/Math.sin(r),p=f*Math.sin(r),b=-f*Math.cos(r)):(c>90&&c<180||c>270&&c<360)&&(x=m/Math.cos(r),p=f*Math.cos(r),b=f*Math.sin(r)),{canvas:l,width:l.width,height:l.height,distanceX:x,distanceY:p,startX:-l.width/2,startY:-l.height/2,offsetXPerRow:b,offsetYPerCol:0}}}));
//# sourceMappingURL=c_plugin_utils_tilingFunc.js-vflaAhoM8.map
