define(["exports","./c_tslib","./e_edison","./c_spectrum_util_raf_throttle"],(function(t,e,o,s){"use strict";const r=t=>{var{children:s,className:r,style:i,tagName:n,topOffset:l,height:a}=t,h=e.__rest(t,["children","className","style","tagName","topOffset","height"]);return o.react.exports.createElement(n,Object.assign({className:r,style:Object.assign(Object.assign({},i),{position:"absolute",top:l,width:"100%",height:a})},h),s)};function i(t){const{document:e,innerHeight:o,pageYOffset:s}=t||window,{documentElement:r,body:i}=e,{scrollHeight:n,scrollTop:l}=r;return{fromBottom:n-(o+s),fromTop:Math.max(l,i.scrollTop),innerHeight:o,totalBottom:n-o,totalTop:n}}r.displayName="CulledItem";class n extends o.react.exports.Component{constructor(t){super(t),this.lastFromTop=null,this.lastTotalTop=null,this.lastFromBottom=null,this.lastTotalBottom=null,this.reportScroll=()=>{const{onScroll:t}=this.props,{fromBottom:e,fromTop:o,innerHeight:s,totalBottom:r,totalTop:i}=function(t){const{scrollHeight:e,clientHeight:o,scrollTop:s}=t;return{fromBottom:e-(o+s),fromTop:s,innerHeight:o,totalBottom:e-o,totalTop:e}}(this.scrollElement),n=o!==this.lastFromTop||i!==this.lastTotalTop,l=e!==this.lastFromBottom||r!==this.lastTotalBottom;this.lastFromTop=o,this.lastTotalTop=i,this.lastFromBottom=e,this.lastTotalBottom=r,(n||l)&&t({fromBottom:e,fromTop:o,innerHeight:s,totalBottom:r,totalTop:i})};const{window:e}=t;this.throttle=new s.RafThrottle(this.reportScroll,e)}componentWillUnmount(){this.throttle.cancelPending()}render(){const{children:t,className:s,height:r}=this.props,i=this.props,{tagName:n="div"}=i;if(e.__rest(i,["tagName"]),!t)return null;const l={height:r,overflow:"auto",position:"relative"};return o.react.exports.createElement(n,{children:t,className:s,onScroll:this.throttle.request,ref:t=>this.scrollElement=t,style:l})}}n.displayName="ElementScrollMonitor",n.defaultProps={tagName:"div"};class l extends o.react.exports.Component{constructor(t){super(t),this.lastFromTop=null,this.lastTotalTop=null,this.lastFromBottom=null,this.lastTotalBottom=null,this.reportScroll=()=>{const{onScroll:t,window:e}=this.props,{fromBottom:o,fromTop:s,innerHeight:r,totalBottom:n,totalTop:l}=i(e),a=s!==this.lastFromTop||l!==this.lastTotalTop,h=o!==this.lastFromBottom||n!==this.lastTotalBottom;this.lastFromTop=s,this.lastTotalTop=l,this.lastFromBottom=o,this.lastTotalBottom=n,(a||h)&&t({fromBottom:o,fromTop:s,totalBottom:n,totalTop:l,innerHeight:r})};const{window:e}=t;this.throttle=new s.RafThrottle(this.reportScroll,e)}componentDidMount(){this.setupScrollListeners()}componentWillUnmount(){this.destroyScrollListeners(),this.throttle.cancelPending()}render(){const{children:t}=this.props,s=this.props,{tagName:r="div",window:i,onScroll:n}=s,l=e.__rest(s,["tagName","window","onScroll"]);return t?o.react.exports.createElement(r,Object.assign({},l)):null}setupScrollListeners(){const{window:t}=this.props;t.addEventListener("scroll",this.throttle.request,{passive:!0})}destroyScrollListeners(){const{window:t}=this.props;t.removeEventListener("scroll",this.throttle.request)}}function a(t,e,o=!1,s=0,r){if(!t.length)return-1;const i=t.length-1;if(void 0===r&&(r=i),s===r||e<t[s]||o&&e===t[s])return s;if(e>=t[i])return r;const n=s+Math.floor((r-s)/2),l=t[n];return e===l?n+1:e<l?a(t,e,o,s,n):a(t,e,o,n+1,r)}l.displayName="WindowScrollMonitor",l.defaultProps={tagName:"div",window:"undefined"!=typeof window?window:void 0};const h=15e5;class c extends o.react.exports.PureComponent{constructor(t){super(t),this.handleScroll=t=>{this.scrollPosition=t.fromTop,this.viewportHeight=t.innerHeight;const{startIndex:e,endIndex:o}=this.state,{scrollThreshold:s}=this.props,[r,i]=this.getIndexRangeInView(),n=Math.abs(r-e),l=Math.abs(i-o);(n>=s||l>=s)&&this.setState({startIndex:r,endIndex:i})};const{items:e,listItemHeight:o}=t;this.updateOffsetCache(e,o);const s=this.getIndexRangeInView(t);this.state={startIndex:s[0],endIndex:s[1]}}UNSAFE_componentWillMount(){const{viewportHeight:t,scrollPosition:e,shouldUseWindowAsScrollContainer:o}=this.props,s=void 0!==t,r=void 0!==e;if(s&&(this.viewportHeight=t),r&&(this.scrollPosition=e),o){const{fromTop:t,innerHeight:e}=i(window);s||(this.viewportHeight=e),r||(this.scrollPosition=t)}}UNSAFE_componentWillReceiveProps(t){const{viewportHeight:e,scrollPosition:o,items:s,listItemHeight:r}=t;void 0!==e&&(this.viewportHeight=e),void 0!==o&&(this.scrollPosition=o),this.updateOffsetCache(s,r);const i=this.getIndexRangeInView(t);this.setState({startIndex:i[0],endIndex:i[1]})}componentDidUpdate(){const{startIndex:t,endIndex:e}=this.state,{onRangeInView:o}=this.props;o&&o(t,e)}renderItemContainer(t){const{role:e,id:s,"aria-labelledby":r,className:i}=this.props,n=t.tagName||"div";return o.react.exports.createElement(n,{role:e,id:s,"aria-labelledby":r,children:t.children,className:i,key:`Container ${t.containerIndex}`,style:{height:t.height}})}wrapWithElementScrollMonitor(t){const{viewportHeight:e,scrollContainerTagName:s,window:r}=this.props;return o.react.exports.createElement(n,{height:e,tagName:s,onScroll:this.handleScroll,window:r},t)}renderWithMaxHeightGrouping(){const{id:t,"aria-labelledby":e,className:s,items:r,listItemHeight:i,role:n,shouldUseWindowAsScrollContainer:a,tagName:c,window:d}=this.props,m=r.length,{startIndex:p,endIndex:g}=this.state,u=[];let f=[];if(a&&f.push(o.react.exports.createElement(l,{window:d,onScroll:this.handleScroll})),Array.isArray(i)){const o=i;let r=0;for(let i=0;i<m;i++)r+o[i]>h&&(u.push(this.renderItemContainer({tagName:c,className:s,children:f,containerIndex:u.length,height:r,role:n,id:t,ariaLabelledby:e})),f=[],r=0),i>=p&&i<=g&&f.push(this.renderItem(i,o[i],r)),r+=o[i];r>0&&(u.push(this.renderItemContainer({tagName:c,className:s,children:f,containerIndex:u.length,height:r,role:n,id:t,ariaLabelledby:e})),f=[])}else{const o=i,r=Math.floor(h/o);let l=r*o,a=m%r*o;a||(a=l);const d=Math.ceil(m/r),w=Math.floor(p/r);for(let o=0;o<w;o++)u.push(this.renderItemContainer({tagName:c,className:s,children:[],containerIndex:u.length,height:l,role:n,id:t,ariaLabelledby:e}));let I=r*(w+1),x=p%r*o;for(let i=p;i<=g;i++)i===I&&(u.push(this.renderItemContainer({tagName:c,className:s,children:f,containerIndex:u.length,height:l,role:n,id:t,ariaLabelledby:e})),f=[],I+=r,x=0),f.push(this.renderItem(i,o,x)),x+=o;for(let o=u.length;o<d;o++)o===d-1&&(l=a),u.push(this.renderItemContainer({tagName:c,className:s,children:f,containerIndex:u.length,height:l,role:n,id:t,ariaLabelledby:e})),f=[]}return 1===u.length?u[0]:o.react.exports.createElement("div",{className:"mc-culled-list-container-wrapper"},u)}renderWithoutMaxHeightGrouping(){const{className:t,items:e,listItemHeight:s,shouldUseWindowAsScrollContainer:r,role:i,tagName:n,window:a,id:h,"aria-labelledby":c}=this.props,d=e.length,{startIndex:m,endIndex:p}=this.state,g=[];r&&g.push(o.react.exports.createElement(l,{window:a,onScroll:this.handleScroll}));let u=0;if(Array.isArray(s)){const t=s;for(let e=0;e<d;e++)e>=m&&e<=p&&g.push(this.renderItem(e,t[e],u)),u+=t[e]}else{const t=s;for(let e=m;e<=p;e++)g.push(this.renderItem(e,t,e*t));u=t*d}return this.renderItemContainer({tagName:n,className:t,children:g,containerIndex:0,height:u,role:i,id:h,ariaLabelledby:c})}render(){const{enableMaxHeightGrouping:t,shouldUseWindowAsScrollContainer:e}=this.props;let o=t?this.renderWithMaxHeightGrouping():this.renderWithoutMaxHeightGrouping();return e||(o=this.wrapWithElementScrollMonitor(o)),o}renderItem(t,e,o){const{items:s,getItemKey:r,renderRow:i}=this.props,n=s[t];return r&&r(n,t),i(n,t,o)}getIndexRangeInView(t=this.props){const{itemBuffer:e,items:o,listItemHeight:s,scrollPositionOffset:r,scrollThreshold:i,window:n,viewportHeight:l=this.viewportHeight,scrollPosition:h=this.scrollPosition,shouldUseWindowAsScrollContainer:c}=t,{documentElement:d}=n.document;let m=h;void 0===m&&(m=c?Math.max(d.scrollTop,0):0),r&&(m-=r);const p=o.length,g=e+Math.max(i-1,0);return Array.isArray(s)?function(t,e,o,s){if(!t.length)return[];const r=a(t,o,!1),i=a(t,o+e,!0,r);return[Math.max(r-s,0),Math.min(i+s,t.length-1)]}(this.cachedItemOffsets,l,m,g):function(t,e,o,s,r){const i=e*t,n=Math.floor(o/i*t),l=Math.max(n-r,0),a=Math.ceil((o+s||1)/i*t)-1;return[l,Math.min(a+r,t-1)]}(p,s,m,l,g)}updateOffsetCache(t,e){if(Array.isArray(e)){if(t.length!==e.length)throw new Error("Must supply a height for every item.");this.cachedItemOffsets=e.reduce(((t,e)=>(t.push(e+(t[t.length-1]||0)),t)),[])}}}c.displayName="CulledList",c.defaultProps={itemBuffer:10,itemTagName:"li",enableMaxHeightGrouping:!1,scrollThreshold:1,shouldUseWindowAsScrollContainer:!0,tagName:"ul",window:"undefined"!=typeof window?window:void 0},t.CulledItem=r,t.CulledList=c}));
//# sourceMappingURL=c_spectrum_culled_list.js-vflRSJnuf.map
