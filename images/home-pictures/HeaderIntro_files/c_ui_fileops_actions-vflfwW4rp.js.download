define(["exports","./c_tslib","./e_edison","./e_ui_page_files_router","./c_data_action_creators_index","./c_files_view_file_actions_file_from_metadata","./c_action_bar_file_actions_logging","./c_sharing_async_share_modal_util","./c_core_i18n","./c_core_notify","./c_core_uri","./c_lodash-es_lodash","./c_apex-metrics_src_types","metaserver/static/js/modules/constants/files_spa","./e_core_exception","./c_core_exception_info","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/constants/request","metaserver/static/js/modules/constants/env","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/viewer","metaserver/static/js/modules/constants/auth","./c_api_v2_noauth_client","./c_browser_cookies","./c_src_sink_index","./c_core_browser_detection","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/ajax_strings","./c_csrf","./c_core_xhr","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/webtiming","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/trademark","metaserver/static/js/modules/constants/campaigns_orchestration","metaserver/static/js/modules/constants/maestro_nav_strings","metaserver/static/js/modules/constants/search","metaserver/static/js/modules/constants/undo_strings","metaserver/static/js/modules/constants/contacts","metaserver/static/js/modules/constants/login_and_register","metaserver/static/js/modules/core/langpack","./c_history","./c_ux_analytics_dispatch_custom_event","./c_browse_crypto_subtle_digest","./c_file_actions_strings"],(function(e,t,s,o,n,a,i,r,l,c,d,u,m,f,g,_,h,S,M,v,p,b,E,k,A,w,y,F,I,N,T,C,x,L,U,P,O,j,W,R,D,Y,V,z,q){"use strict";const B="view_only_access_error",Q="off_team_owner_error",$="owner_only_manage_membership_error",H="team_space_owner_only_manage_membership_error",Z="team_space_only_on_team_sharing_error",X="ns_have_mounted_children_ns_error",G="action_nested_shared_folder_ownership_surrender",J="action_move_implicit_share",K=e=>{const{files:t,newPath:s,checkFSWs:n,onSuccess:a,onRequestNotSent:i,onUndo:r,user:c,dataApi:d=o.BrowseApi}=e;!d.copyFiles({files:t,newPath:s,checkFSWs:n,userId:c.id,onSuccess:({newFiles:n,changesets:i,failureDetails:d})=>{if(d){const t=()=>{K(Object.assign(Object.assign({},e),{checkFSWs:!1}))};o.showFileSystemWarningsModal({fsws:d,onFinalAccept:t,confirmText:l.intl.formatMessage({id:"r3T3xT",defaultMessage:"Copy"})})}else a&&a(n),o.notifyCopySuccess(t.length,c,i,s,(()=>{r&&r()}))}})&&i&&i()},ee=(e,t)=>n=>s.React$1.createElement(o.Link,{hasNoUnderline:!0,inverse:!0,href:o.browse_uri_for_fq_path(e,t).toString()},s.React$1.createElement("strong",null,n));const te=({entries:e,loggingInfo:t,jobId:s,uid:n})=>{e.forEach((a=>{switch(a[".tag"]){case"failure":o.logFileAction({uid:n,action:t.failItemLogAction,num_files_selected:e.length,num_folders_selected:0,error_summary:a.failure[".tag"],error:a.failure[".tag"],jobId:s,extra:t.extra});break;case"other":o.logFileAction({uid:n,action:t.failItemLogAction,num_files_selected:e.length,num_folders_selected:0,error_summary:"other",error:"other",jobId:s,extra:t.extra});break;case"success":o.logFileAction({uid:n,action:t.successItemLogAction,num_files_selected:e.length,num_folders_selected:0,jobId:s,extra:t.extra,item_id:"file"===a.success[".tag"]||"folder"===a.success[".tag"]?a.success.id:void 0,item_size:"file"===a.success[".tag"]||"folder"===a.success[".tag"]?a.success.size:void 0,item_mime:"file"===a.success[".tag"]?a.success.mime_type:void 0})}}))};const se=e=>{const{path:t,files:s,newPath:n,checkFSWs:a,onSuccess:i,onRequestNotSent:r,onUndo:d,user:u,dataApi:m=o.BrowseApi}=e,f=({newFiles:t,changesets:a,failureDetails:r})=>{if(r){const t=()=>{se(Object.assign(Object.assign({},e),{checkFSWs:!1}))};o.showFileSystemWarningsModal({fsws:r,onFinalAccept:t,confirmText:l.intl.formatMessage({id:"ds25UH",defaultMessage:"Move"})})}else o.notifyMoveSuccess(s.length,u,a,n,(()=>{d&&d()})),i&&i(t)};!m.moveFiles({path:t,files:s,newPath:n,checkFSWs:a,userId:u.id,onSuccess:f,onError:e=>{"This will result in losing ownership of these folders."===e?(c.Notify.clear(),o.showConfirmOwnershipTransferModal((()=>{m.moveFiles({path:t,files:s,newPath:n,userId:u.id,onSuccess:f,allowOwnershipTransfer:!0})}))):ae(u,e,s,n)},allowOwnershipTransfer:!1})&&r&&r()},oe=l.intl.formatMessage({id:"zYM4td",defaultMessage:"Please unlock your Vault before attempting to add to this folder."}),ne=l.intl.formatMessage({id:"p2aC9a",defaultMessage:"Those files already exist in that folder."});function ae(e,t,a,i,d){const u=o.Viewer.get_viewer().team_name;let m=!1;"is_cdm_member"in e&&e.is_cdm_member&&o.inSubDirectory(e.cdm_tmf_path,i)&&(m=!0);const f=function(e,t,n,a,i){const r=l.intl.formatMessage({id:"gVzSq7",defaultMessage:"You don’t have permission to move some of these items. Try moving items individually."});let c=null;const d=e=>0===e.length?"":o.getFilenameFromActionInfo(e[0]),u=d(a);t===Q?c=1===a.length?null==n?l.intl.formatMessage({id:"eqzXgU",defaultMessage:"The owner of <strong>{file_name}</strong> is a member of another team."},{file_name:o.Emstring.em_snippet(u,o.SNIPPET_SIZES.FILENAME),strong:e=>s.React$1.createElement("strong",{style:{fontWeight:500}},e)}):l.intl.formatMessage({id:"F7A+9f",defaultMessage:"The owner of <strong>{file_name}</strong> isn’t a member of {team_name}."},{team_name:n,file_name:o.Emstring.em_snippet(u,o.SNIPPET_SIZES.FILENAME),strong:e=>s.React$1.createElement("strong",{style:{fontWeight:500}},e)}):null==n?l.intl.formatMessage({id:"1mkOQ2",defaultMessage:"The owner of some of these shared folders is a member of another team."}):l.intl.formatMessage({id:"kXptr+",defaultMessage:"The owner of some of these shared folders isn’t a member of {team_name}."},{team_name:n}):t===$?c=1===a.length?"is_cdm_member"in e&&e.is_cdm_member&&!i?l.intl.formatMessage({id:"rLKsQF",defaultMessage:"Only the owner of <strong>{file_name}</strong> can move it to the {team_name} team space."},{team_name:n,file_name:o.Emstring.em_snippet(u,o.SNIPPET_SIZES.FILENAME),strong:e=>s.React$1.createElement("strong",{style:{fontWeight:500}},e)}):l.intl.formatMessage({id:"Xkb8gG",defaultMessage:"Only the owner of <strong>{file_name}</strong> can move it to a team folder."},{file_name:o.Emstring.em_snippet(u,o.SNIPPET_SIZES.FILENAME),strong:e=>s.React$1.createElement("strong",{style:{fontWeight:500}},e)}):"is_cdm_member"in e&&e.is_cdm_member&&!i?l.intl.formatMessage({id:"Ic3QpQ",defaultMessage:"Only the owner can move some of these folders to the {team_name} team space."},{team_name:n}):l.intl.formatMessage({id:"AGXz3U",defaultMessage:"Only the owner can move some of these folders to a team folder."}):t===B?c=1===a.length?l.intl.formatMessage({id:"4nfaRz",defaultMessage:"You can only view <strong>{file_name}</strong>. Ask an owner or editor of the folder for access to edit it."},{file_name:o.Emstring.em_snippet(u,o.SNIPPET_SIZES.FILENAME),strong:e=>s.React$1.createElement("strong",{style:{fontWeight:500}},e)}):l.intl.formatMessage({id:"vSscn6",defaultMessage:"You can’t edit some of these folders. Ask an owner or editor of the folders for access to edit them."}):t===H||t===Z?c=1===a.length?l.intl.formatMessage({id:"xYXgy4",defaultMessage:"If you need to move <strong>{file_name}</strong>, ask your admin to move it for you."},{file_name:o.Emstring.em_snippet(u,o.SNIPPET_SIZES.FILENAME),strong:e=>s.React$1.createElement("strong",{style:{fontWeight:500}},e)}):r:t===X&&(c=1===a.length?l.intl.formatMessage({id:"sFivS0",defaultMessage:"<strong>{file_name}</strong> has other shared folders inside it. Try moving each shared folder individually."},{file_name:o.Emstring.em_snippet(u,o.SNIPPET_SIZES.FILENAME),strong:e=>s.React$1.createElement("strong",{style:{fontWeight:500}},e)}):r);return c}(e,t,u,a,m);if(null==f)return void(d&&d());c.Notify.clear();const g=t===H||t===Z||t===X,_=function(e,t,s,n,a){if(t)return 1===n?l.intl.formatMessage({id:"MHxxzk",defaultMessage:"Can’t move out of the team space"}):l.intl.formatMessage({id:"XJI7dZ",defaultMessage:"Can’t move {num_of_files} items"},{num_of_files:n});return"is_cdm_member"in e&&e.is_cdm_member&&!a?l.intl.formatMessage({id:"S+fFwb",defaultMessage:"{count, plural, one{Can’t move shared folder to the {team_name} team space} other{Can’t move shared folders to the {team_name} team space}}"},{count:n,team_name:o.Emstring.em_snippet(s,o.SNIPPET_SIZES.DISPLAY_NAME)}):l.intl.formatMessage({id:"thmzHN",defaultMessage:"{count, plural, one{Can’t move shared folder to a team folder} other{Can’t move shared folders to a team folder}}"},{count:n})}(e,g,u,a.length,m);let h="";h=g?"/help/business/team-space-overview#moveout":"/help/business/team-space-overview#movein";const S=1===a.length,M=a[0]instanceof o.File&&S&&!g?l.intl.formatMessage({id:"tHNeW4",defaultMessage:"See owner"}):void 0;o.showMoveErrorModal({title:_,content:f,learnMoreLink:h,buttonString:M,onClick:()=>{a[0]instanceof o.File&&r.asyncShowShareModal(e.id,a[0],{origin:o.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS},(({path:e,qargs:t})=>o.getStoreForBrowse().dispatch(n.setUrl({path:e,qargs:t}))))}})}function ie(e){return ge(e)&&"relocation_error"===e.failure[".tag"]&&"cant_nest_shared_folder"===e.failure.relocation_error[".tag"]}function re(e,s,n,a){return!e.isError&&e.result.changeset_data&&e.result.changeset_data.length>0?()=>t.__awaiter(this,void 0,void 0,(function*(){o.Snackbar.close("browse-action"),o.logFileAction({uid:s.id,action:n.undoingLogAction,num_files_selected:e.result.entries.length,num_folders_selected:0,extra:n.extra}),i.rollback({changeset_data:e.result.changeset_data,userId:s.id,onSuccess:()=>{o.Snackbar.complete(n.undoSuccessSnackbarText,"browse-action"),o.logFileAction({uid:s.id,action:n.undoSuccessLogAction,num_files_selected:e.result.entries.length,num_folders_selected:0}),a&&a(!0)}})})):void 0}function le(){o.open_tab("https://help.dropbox.com/files-folders/share/shared-folder-differences#move_shared_folder")}const ce={showPartialSuccess:(e,t)=>t?(o.setHandleUndo(t),o.Snackbar.show(s.React$1.createElement(o.Snackbar,{title:e,variant:"complete",actionButtonText:l.intl.formatMessage({id:"OfxyEk",defaultMessage:"Undo"}),onActionClick:t,closeButtonText:l.intl.formatMessage({id:"N4y79U",defaultMessage:"Learn More"}),onCloseClick:le,timeoutDelayMs:5e3,id:"browse-action"}))):o.Snackbar.show(s.React$1.createElement(o.Snackbar,{closeButtonText:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),actionButtonText:l.intl.formatMessage({id:"N4y79U",defaultMessage:"Learn More"}),onActionClick:le,timeoutDelayMs:5e3,title:e,variant:"complete",id:"browse-action"})),showFailure:e=>o.Snackbar.show(s.React$1.createElement(o.Snackbar,{closeButtonText:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),actionButtonText:l.intl.formatMessage({id:"N4y79U",defaultMessage:"Learn More"}),onActionClick:le,timeoutDelayMs:5e3,title:e,variant:"fail",id:"browse-action"}))},de=(e,t,s,n,a,i={})=>{if(t>0&&s>0){const s=n.getPartialSuccessSnackbarText(t,e,i);i.isNestedNamespaceError?ce.showPartialSuccess(s,a):a?(o.setHandleUndo(a),o.Snackbar.completeWithUndo(s,a,"browse-action")):o.Snackbar.complete(s,"browse-action")}else if(t>0){const e=n.getSuccessSnackbarText(t);a?(o.setHandleUndo(a),o.Snackbar.completeWithUndo(e,a,"browse-action")):o.Snackbar.complete(e,"browse-action")}else{const e=n.getFailureSnackbarText(s,i);i.isNestedNamespaceError?ce.showFailure(e):o.Snackbar.fail(e,"browse-action")}};function ue({folderLinkCta:e,folderName:t,fswIDs:s,successActions:o}){return(null==s?void 0:s.includes(J))?l.intl.formatMessage({id:"P6vPej",defaultMessage:"{count, plural, one{{count} item moved and can now be accessed by everyone with access to “{folderName}.”} other{{count} items moved and can now be accessed by everyone with access to “{folderName}.”}}"},{count:o,folderName:t,link:e}):l.intl.formatMessage({id:"315R6Z",defaultMessage:"{count, plural, one{Moved {count} item to <link>{folderName}</link>.} other{Moved {count} items to <link>{folderName}</link>.}}"},{count:o,folderName:t,link:e})}function me({folderLinkCta:e,folderName:t,fswIDs:s,isNestedNamespaceError:o,successActions:n,totalActions:a}){return(null==s?void 0:s.includes("action_move_implicit_share"))?l.intl.formatMessage({id:"FrPyCz",defaultMessage:"{successActions} of {totalActions} items moved and can now be accessed by everyone with access to “{folderName}.”"},{successActions:n,totalActions:a,folderName:t,link:e}):o?l.intl.formatMessage({id:"v6wzJx",defaultMessage:"{count, plural, one{Moved {succesfully_moved_files} out of {count} item to <link>{folderName}</link>.} other{Moved {succesfully_moved_files} out of {count} items to <link>{folderName}</link>.}} Shared folders can’t be moved to other shared folders."},{count:a,succesfully_moved_files:n,folderName:t,link:e}):l.intl.formatMessage({id:"VgRH6k",defaultMessage:"{count, plural, one{Moved {succesfully_moved_files} out of {count} item to <link>{folderName}</link>.} other{Moved {succesfully_moved_files} out of {count} items to <link>{folderName}</link>.}}"},{count:a,succesfully_moved_files:n,folderName:t,link:e})}function fe(e){return"success"===e[".tag"]}function ge(e){return"failure"===e[".tag"]}function _e(e,t){const s=e.entries.filter(fe),o=s.length,n=e.entries.filter(ge);return{numberOfSuccessfulActions:o,numberOfFailedActions:t.length-o,get updatedFiles(){return((e,t)=>{const s=[];return e.forEach((e=>{if("file"===e.success[".tag"]||"folder"===e.success[".tag"]){const o=e.success,n=t.find((e=>"file_id"in e?e.file_id===o.id:"id"in e&&e.id===o.id));if(n){const e=a.fileFromMetadata(n,o);s.push(e)}}})),s})(s,t)},get allErrorCounts(){return n.reduce(((e,t)=>{var s;return(e=null!=e?e:{})[t.failure[".tag"]]=(null!==(s=e[t.failure[".tag"]])&&void 0!==s?s:0)+1,e}),void 0)},get numberOfSuccessfulFiles(){return s.filter((e=>"file"===e.success[".tag"])).length},get numberOfSuccessfulFolders(){return s.filter((e=>"folder"===e.success[".tag"])).length},get firstErrorSummary(){var e,t;return null===(t=null===(e=null==n?void 0:n[0])||void 0===e?void 0:e.failure)||void 0===t?void 0:t[".tag"]}}}e.copyFilesDeprecated=K,e.copyFiles_v2=function(e){return t.__awaiter(this,void 0,void 0,(function*(){const{files:t,newPath:s,onError:n,onUndo:a,onSuccess:i,user:r,isLockedVaultFolder:c,isPasteAction:d,actionId:u=""}=e;if(c)return o.Snackbar.fail(oe,"browse-action"),void(null==n||n("client.cant_move_into_vault"));const m=o.filename(s),f=ee(r,s),g=d?{sync:e=>l.intl.formatMessage({id:"xegVmx",defaultMessage:"{count, plural, one{Pasting {count} item...} other{Pasting {count} items...}}"},{count:e}),undo:l.intl.formatMessage({id:"xkxhEq",defaultMessage:"Undoing paste..."}),undoFail:l.intl.formatMessage({id:"biijKe",defaultMessage:"Couldn’t undo paste."}),undoComplete:l.intl.formatMessage({id:"gevTNB",defaultMessage:"Paste undone."}),failure:e=>l.intl.formatMessage({id:"fJ21+e",defaultMessage:"{count, plural, one{Couldn’t paste {count} item.} other{Couldn’t paste {count} items.}}"},{count:e}),partialSuccess:(e,t)=>l.intl.formatMessage({id:"o9R5u2",defaultMessage:"{count, plural, one{Pasted {succesfully_copied_files} out of {count} item.} other{Pasted {succesfully_copied_files} out of {count} items.}}"},{count:t,succesfully_copied_files:e}),success:e=>l.intl.formatMessage({id:"TIeF91",defaultMessage:"{count, plural, one{Pasted {count} item.} other{Pasted {count} items.}}"},{count:e})}:function(e,t){return{sync:e=>l.intl.formatMessage({id:"Xq8RFm",defaultMessage:"{count, plural, one{Copying {count} item...} other{Copying {count} items...}}"},{count:e}),undo:l.intl.formatMessage({id:"X8FnSw",defaultMessage:"Undoing copy..."}),undoFail:l.intl.formatMessage({id:"oYs0zq",defaultMessage:"Couldn’t undo copy."}),undoComplete:l.intl.formatMessage({id:"zgCNlD",defaultMessage:"Copy undone."}),failure:s=>l.intl.formatMessage({id:"0OnruC",defaultMessage:"{count, plural, one{Couldn’t copy {count} item to <link>{folderName}</link>.} other{Couldn’t copy {count} items to <link>{folderName}</link>.}}"},{count:s,folderName:e,link:t}),partialSuccess:(s,o)=>l.intl.formatMessage({id:"QA6Uk4",defaultMessage:"{count, plural, one{Copied {succesfully_copied_files} out of {count} item to <link>{folderName}</link>.} other{Copied {succesfully_copied_files} out of {count} items to <link>{folderName}</link>.}}"},{count:o,succesfully_copied_files:s,folderName:e,link:t}),success:s=>l.intl.formatMessage({id:"c5FpTz",defaultMessage:"{count, plural, one{Copied {count} item to <link>{folderName}</link>.} other{Copied {count} items to <link>{folderName}</link>.}}"},{count:s,folderName:e,link:t})}}(m,f);o.Snackbar.sync(g.sync(t.length),!0,"browse-action"),t.forEach((e=>{o.logFileAction({uid:r.id,action:o.WebUserActionLogEvent.COPY_ITEM_ATTEMPT,num_files_selected:t.length,num_folders_selected:0,item_id:e.file_id,extra:{action_id:u}})}));const _=yield o.copyFiles(t,s,r.id,{checkFSWs:!1}),h={attemptItemLogAction:o.WebUserActionLogEvent.COPY_ITEM_ATTEMPT,failItemLogAction:o.WebUserActionLogEvent.COPY_ITEM_FAIL,successItemLogAction:o.WebUserActionLogEvent.COPY_ITEM_SUCCESS,successLogAction:o.WebUserActionLogEvent.COPY_REQUEST_SUCCESS,failedLogAction:o.WebUserActionLogEvent.COPY_REQUEST_FAIL,undoingLogAction:o.WebUserActionLogEvent.COPY_UNDO,undoFailedLogAction:o.WebUserActionLogEvent.COPY_UNDO_REQUEST_FAIL,undoSuccessLogAction:o.WebUserActionLogEvent.COPY_UNDO_REQUEST_SUCCESS,undoingSnackbarText:g.undo,undoFailedSnackbarText:g.undoFail,undoSuccessSnackbarText:g.undoComplete,getFailureSnackbarText:g.failure,getPartialSuccessSnackbarText:g.partialSuccess,getSuccessSnackbarText:g.success};if(_.isError){o.Snackbar.close("browse-action"),null==n||n(_.error_summary);const e=()=>{o.Snackbar.fail(h.getFailureSnackbarText(t.length),"browse-action")};return ae(r,_.error[".tag"],t,s,e),void o.logFileAction({uid:r.id,action:h.failedLogAction,num_files_selected:t.length,num_folders_selected:0,error_summary:_.error_summary,error:_.error[".tag"],jobId:null==_?void 0:_.jobId,extra:h.extra})}te({entries:_.result.entries,loggingInfo:h,jobId:_.jobId,uid:r.id});const S=_e(_.result,t),M=re(_,r,h,a);de(t.length,S.numberOfSuccessfulActions,S.numberOfFailedActions,h,M,{isNestedNamespaceError:_.result.entries.some(ie)}),null==i||i(S.updatedFiles,S.allErrorCounts),o.logFileAction({uid:r.id,action:h.successLogAction,num_files_selected:S.numberOfSuccessfulFiles,num_folders_selected:S.numberOfSuccessfulFolders,jobId:_.jobId,error_summary:S.firstErrorSummary,extra:h.extra})}))},e.getBatchUndoHandler=re,e.getMovePartialSuccessSnackbarText=me,e.getMoveSuccessSnackbarText=ue,e.moveFiles=function e(s){var n,a;return t.__awaiter(this,void 0,void 0,(function*(){const{path:t,files:i,newPath:r,onError:c,onUndo:d,onSuccess:u,user:m,dataApiV2:f=o.ApiV2,checkFSWs:g,isLockedVaultFolder:_,extra:h,fswIDs:S=[],actionId:M=""}=s;if(_)return o.Snackbar.fail(oe,"browse-action"),void(null==c||c("client.cant_move_into_vault"));if(o.paths_are_equal(t,r))return o.Snackbar.fail(ne,"browse-action"),void(null==c||c("client.disallowed_name"));const v=function(e,t,s){return{sync:e=>l.intl.formatMessage({id:"IE0PNM",defaultMessage:"{count, plural, one{Moving {count} item...} other{Moving {count} items...}}"},{count:e}),undo:l.intl.formatMessage({id:"XkY9GW",defaultMessage:"Undoing move..."}),undoFail:l.intl.formatMessage({id:"htZAqt",defaultMessage:"Couldn’t undo move."}),undoComplete:l.intl.formatMessage({id:"rrCngs",defaultMessage:"Move undone."}),failure:(s,{isNestedNamespaceError:o}={})=>o?l.intl.formatMessage({id:"U2agKj",defaultMessage:"{count, plural, one{Couldn’t move {count} item to <link>{folderName}</link>.} other{Couldn’t move {count} items to <link>{folderName}</link>.}} Shared folders can’t be moved to other shared folders."},{count:s,folderName:e,link:t}):l.intl.formatMessage({id:"aWWTan",defaultMessage:"{count, plural, one{Couldn’t move {count} item to <link>{folderName}</link>.} other{Couldn’t move {count} items to <link>{folderName}</link>.}}"},{count:s,folderName:e,link:t}),success:o=>ue({folderLinkCta:t,folderName:e,fswIDs:s,successActions:o}),partialSuccess:(o,n,{isNestedNamespaceError:a}={})=>me({folderLinkCta:t,folderName:e,fswIDs:s,isNestedNamespaceError:a,successActions:o,totalActions:n})}}(o.filename(r),ee(m,r),S);o.Snackbar.sync(v.sync(i.length),!0,"browse-action"),i.forEach((e=>{o.logFileAction({uid:m.id,action:o.WebUserActionLogEvent.MOVE_ITEM_ATTEMPT,num_files_selected:i.length,num_folders_selected:0,item_id:e.file_id,extra:{action_id:M}})}));const p=yield f.moveFiles(i,r,m.id,{allowOwnershipTransfer:S.includes(G),checkFSWs:g}),b={attemptItemLogAction:o.WebUserActionLogEvent.MOVE_ITEM_ATTEMPT,failItemLogAction:o.WebUserActionLogEvent.MOVE_ITEM_FAIL,successItemLogAction:o.WebUserActionLogEvent.MOVE_ITEM_SUCCESS,successLogAction:o.WebUserActionLogEvent.MOVE_REQUEST_SUCCESS,failedLogAction:o.WebUserActionLogEvent.MOVE_REQUEST_FAIL,undoingLogAction:o.WebUserActionLogEvent.MOVE_UNDO,undoFailedLogAction:o.WebUserActionLogEvent.MOVE_UNDO_REQUEST_FAIL,undoSuccessLogAction:o.WebUserActionLogEvent.MOVE_UNDO_REQUEST_SUCCESS,undoingSnackbarText:v.undo,undoFailedSnackbarText:v.undoFail,getPartialSuccessSnackbarText:v.partialSuccess,getSuccessSnackbarText:v.success,undoSuccessSnackbarText:v.undoComplete,getFailureSnackbarText:v.failure,extra:h};if(p.isError){if(o.Snackbar.close("browse-action"),null==c||c(p.error_summary),"to"===p.error[".tag"]&&"file_system_warnings"===p.error.to[".tag"]){const t=(null===(a=null===(n=p.error.to)||void 0===n?void 0:n.details)||void 0===a?void 0:a.map((({id:e})=>e)))||[],i=()=>e(Object.assign(Object.assign({},s),{checkFSWs:!1,fswIDs:t}));return void o.showFileSystemWarningsModal({fsws:p.error.to.details,onFinalAccept:i,confirmText:l.intl.formatMessage({id:"ds25UH",defaultMessage:"Move"})})}const t=()=>{o.Snackbar.fail(b.getFailureSnackbarText(i.length),"browse-action")};return ae(m,p.error[".tag"],i,r,t),void o.logFileAction({uid:m.id,action:b.failedLogAction,num_files_selected:i.length,num_folders_selected:0,error_summary:p.error_summary,error:p.error[".tag"],jobId:null==p?void 0:p.jobId,extra:b.extra})}te({entries:p.result.entries,loggingInfo:b,jobId:p.jobId,uid:m.id});const E=_e(p.result,i),k=re(p,m,b,d);de(i.length,E.numberOfSuccessfulActions,E.numberOfFailedActions,b,k,{isNestedNamespaceError:p.result.entries.some(ie)}),null==u||u(E.updatedFiles,E.allErrorCounts),o.logFileAction({uid:m.id,action:b.successLogAction,num_files_selected:E.numberOfSuccessfulFiles,num_folders_selected:E.numberOfSuccessfulFolders,jobId:p.jobId,error_summary:E.firstErrorSummary,extra:b.extra})}))},e.moveFiles_LEGACY=se,e.nestedNamespaceSnackbars=ce,e.showBatchCompletedSnackbar=de}));
//# sourceMappingURL=c_ui_fileops_actions.js-vflJk2cSn.map
