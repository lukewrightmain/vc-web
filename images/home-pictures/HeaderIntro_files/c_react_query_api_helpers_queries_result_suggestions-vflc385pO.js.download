define(["exports","./c_react_query_api_helpers_helpers","./e_ui_page_files_router","./c_tslib","./e_core_exception","./c_core_exception_info"],(function(e,s,t,r,a,i){"use strict";const o=s.createApiv2Query({requestMethod:"assistant:get_assistance",optionsFn:e=>Object.assign(Object.assign({},e),{cacheTime:1/0,staleTime:1/0})}),n="files:get_query_suggestions",u=s.createApiv2Query({requestMethod:n,getQueryKey:s.getApiv2QueryKey(n,(e=>{e.search_session_id="MASKED",e.typeahead_session_id="MASKED"})),optionsFn:e=>Object.assign(Object.assign({},e),{cacheTime:1/0,staleTime:1/0})}),g=s.createApiv2Query({requestMethod:"manual_tagging:tags/get_viewable_tags",optionsFn:e=>Object.assign(Object.assign({},e),{cacheTime:1/0,staleTime:1/0})}),c=s.createApiv2Query({requestMethod:"search_suggestion:get_people_suggestion",optionsFn:e=>Object.assign(Object.assign({},e),{cacheTime:1/0,staleTime:1/0})}),d="files:search_v2",l=s.createApiv2Query({requestMethod:d,getQueryKey:s.getApiv2QueryKey(d,(e=>{e.session_id="MASKED",e.typeahead_session_id="MASKED",e.options&&(e.options.last_modified_date_range=void 0,e.options.media_filters&&(e.options.media_filters.date_taken=void 0),e.options.flexible_query=void 0)})),optionsFn:e=>Object.assign(Object.assign({},e),{cacheTime:1/0,staleTime:1/0})}),_=(e,s)=>{if(!s)return e;const{expSearchEnableMSOfficeThumbnails:t,isAdvancedSearchOperatorsEnabled:r,isAdvancedSearchOperatorsMockingEnabled:a,manualTaggingVariant:i,searchDocClassification:o}=s;return Object.assign(Object.assign({},e),{enableMSOfficeThumbnails:"V1"===t,searchDocClassification:"OFF"!==o,searchResponseIncludeFql:r,searchResponseIncludeQuery:r,searchTags:"OFF"!==i,searchWebEnableAsoMocking:!1})},p=e=>{const s=S(e.isPaperEnabled,!0),r=S(e.searchTags,!1),a=S(e.lastModifiedDate,t.DateRange.Any),i=S(e.dateTaken,t.DateRange.Any),o=S(e.selectedDimensions,[]),n=S(e.searchDocClassification,!1),u=S(e.isDropdown,!1),g=S(e.includeHighlights,!0),c=S(e.filenameOnly,!1),d=e.fileCategories,l=d&&!t.allCategoriesChecked(d,s)?t.fileCategoriesToString(d):"",_=e.sortOrder?t.sortFieldToOrderBy(e.sortOrder.sortField):"",p=e.sortOrder?t.sortDirectionToReverseOrder(e.sortOrder.sortDirection):"",h=Object.assign(Object.assign({query:e.query,fq_path:e.path,cursor:e.cursor,max_results:e.maxResults,show_paper_results:!0,include_browse_context:e.includeBrowseContext,typeahead_session_id:e.typeaheadSessionId,search_session_id:e.searchSessionId},l&&{file_categories:l}),{order_by:_,reverse_order:p,exclude_shared_docs:!1,filename_only:c,include_highlights:g,include_snippets:!1,user_filter_account_id:e.filteredAccountId,search_tags:r,last_modified_date:a,custom_last_modified_date_range:e.customLastModifiedDateRange,selected_dimensions:o,date_taken:i,custom_date_taken_range:e.customDateTakenRange,search_doc_classification:n,is_dropdown:u,enable_msoffice_thumbnails:e.enableMSOfficeThumbnails,is_for_result_suggestions:!0,search_response_include_fql:e.searchResponseIncludeFql,search_response_include_query:e.searchResponseIncludeQuery,search_web_enable_aso_mocking:e.searchWebEnableAsoMocking,flexible_query:e.flexibleQuery,should_search_by_fql:e.shouldSearchByFql});return t.convertRequestDataToV2(h)},S=(e,s)=>void 0===e?s:e;e.PEOPLE_SUGGESTIONS_DROPDOWN_LIMIT=3,e.formatQuerySuggestions=e=>e.map(t.convertQuerySuggestionResultToQuerySuggestion),e.formatQuerySuggestionsLoadingState=({isError:e,isLoading:s,isSuccess:r})=>e?t.QuerySuggestionsLoadingState.FAILED:s?t.QuerySuggestionsLoadingState.LOADING:r?t.QuerySuggestionsLoadingState.LOADED:void 0,e.formatRecentItemSuggestions=e=>e.slice(0,5).map(t.convertRecentItemToRecentItemSuggestion),e.formatRecentItemSuggestionsLoadingState=({isError:e,isLoading:s,isSuccess:r})=>e?t.RecentItemSuggestionsLoadingState.FAILED:s?t.RecentItemSuggestionsLoadingState.LOADING:r?t.RecentItemSuggestionsLoadingState.LOADED:void 0,e.formatResultSuggestion=(e,s)=>t.convertSearchResultToResultSuggestion(e,t.mustGetActiveUser(),s),e.formatResultSuggestionsLoadingState=({isError:e,isLoading:s,isSuccess:r})=>e?t.ResultSuggestionsLoadingState.FAILED:s?t.ResultSuggestionsLoadingState.LOADING:r?t.ResultSuggestionsLoadingState.LOADED:void 0,e.formatTagsSuggestions=e=>e.slice(0,7).map(t.convertTagToTagSuggestion),e.formatTagsSuggestionsLoadingState=({isError:e,isLoading:s,isSuccess:r})=>e?t.TagsSuggestionsLoadingState.FAILED:s?t.TagsSuggestionsLoadingState.LOADING:r?t.TagsSuggestionsLoadingState.LOADED:void 0,e.formatZeroPeopleSuggestionsLoadingState=({isError:e,isLoading:s,isSuccess:r})=>e?t.PeopleSuggestionsLoadingState.FAILED:s?t.PeopleSuggestionsLoadingState.LOADING:r?t.PeopleSuggestionsLoadingState.LOADED:void 0,e.useQuerySuggestionsQueryBy=(e,s,o)=>{var n;const g={query:e,max_results:t.SEARCH_POSTERIOR_QUERY_SUGGESTIONS_CAPACITY,search_session_id:s,typeahead_session_id:o},c=u.useQuery({apiArg:g},{enabled:!!e},{perUseQueryFnWrapper:(s,o,n)=>r.__awaiter(void 0,void 0,void 0,(function*(){var r,o,u;try{const a=performance.now(),i=yield s(),g=performance.now()-a,c=null!==(o=null===(r=i.query_suggestions)||void 0===r?void 0:r.length)&&void 0!==o?o:0,d=null!==(u=n.responseHeaders)&&void 0!==u?u:{},l=parseInt(d["x-server-response-time"],10),_=isNaN(l)?void 0:l;t.logQuerySuggestionsFetched(e,c,g);const p=_?g-_:void 0;return t.logQuerySuggestionsLatencyToAmp(g,_,p),i}catch(s){const r=s.raw?new Error(s.raw.responseBody):s;throw a.reportException({err:r,tags:["js:search","search_bar","search_bar_query_suggestions","search_react_query"],severity:i.SEVERITY.NON_CRITICAL}),t.logQuerySuggestionsFailed(e),new Error(s)}}))}),d=((null===(n=c.data)||void 0===n?void 0:n.query_suggestions)||[]).filter((s=>{var t;return(null===(t=s.text)||void 0===t?void 0:t.toLowerCase())!==e.toLowerCase()}));return[c,d]},e.useRecentItemsQuery=(e,s)=>{var r,a;const i=o.useQuery({apiArg:{request_params:{features:[{".tag":"recent"}],num_items:5,metadata_configs:{include_file_metadata:!0,include_paper_metadata:!0,include_user_info:!0,file_metadata_options:[{".tag":"with_url"},{".tag":"with_icon"},{".tag":"with_breadcrumb"}]}}}},{enabled:s});if(!s)return[i,[]];return[i,(null!==(a=null===(r=i.data)||void 0===r?void 0:r.results)&&void 0!==a?a:[]).map((s=>t.convertAssistantResultToRecentItem(s,e))).filter((e=>null!==e))]},e.useResultSuggestionsQueryBy=(e,s)=>{const o=_(e,s),n=p(o),u=l.useQuery({apiArg:n},{enabled:!!n.query},{perUseQueryFnWrapper:(e,s,o)=>r.__awaiter(void 0,void 0,void 0,(function*(){var s;try{const r=performance.now(),a=yield e(),i=performance.now()-r,n=a.matches.length,u=null!==(s=o.responseHeaders)&&void 0!==s?s:{},g=parseInt(u["x-server-response-time"],10),c=a.request_id?t.getRequestId(a.request_id):void 0,d=isNaN(g)?void 0:g,l=d?i-d:void 0;return t.logResultSuggestionsFetched(i,d,l,n,c),t.logResultSuggestionsLatencyToAmp(i,d,l),t.recordResultSuggestionLoadTime(i,"search_v2"),a}catch(e){const s=e.raw?new Error(e.raw.responseBody):e;throw a.reportException({err:s,tags:["js:search","search_bar","search_bar_result_suggestions","search_react_query"],severity:i.SEVERITY.NON_CRITICAL}),t.logResultSuggestionsFailed(),new Error(e)}}))});if(!u.data||!u.data.request_id)return[u,[],void 0];const g=t.getRequestId(u.data.request_id);return[u,t.extractSearchV2ResultsList(u.data.matches,e.start,g),g]},e.useTagsSuggestionsQueryBy=(e,s)=>{var o,n,u;const c=g.useQuery({apiArg:void 0},{enabled:!0},{perUseQueryFnWrapper:(s,o)=>r.__awaiter(void 0,void 0,void 0,(function*(){try{const r=yield s();return t.logTagSuggestionsFetched(e,r.tag_and_counts.length),r}catch(s){const r=s.raw?new Error(s.raw.responseBody):s;throw a.reportException({err:r,tags:["js:search","search_bar","search_bar_tags_suggestions","search_react_query"],severity:i.SEVERITY.NON_CRITICAL}),t.logTagSuggestionsFailed(e),new Error(s)}}))});if(!s)return[c,[]];const d=null!==(u=null===(n=null===(o=c.data)||void 0===o?void 0:o.tag_and_counts)||void 0===n?void 0:n.map((e=>e.typed_tag)).filter(t.isUserGeneratedTag))&&void 0!==u?u:[];return[c,t.getTagsSuggestions(e,d).slice(0,7)]},e.useZeroStatePeopleSuggestionQuery=(e,s)=>{const[r,a]=(e=>{var s;const t={num_items:5,return_team_members_if_empty:!0},r=c.useQuery({apiArg:t},{enabled:e});return e?[r,(null===(s=r.data)||void 0===s?void 0:s.people_suggestions)||[]]:[r,[]]})(e);return[r,a.slice(0,null!=s?s:5).map(t.convertSuggestedUserToContact)]},e.useZeroStateTagsSuggestions=e=>{var s,r,a;const i=g.useQuery({apiArg:void 0},{enabled:e});if(!e)return[i,[]];return[i,(null!==(a=null===(r=null===(s=i.data)||void 0===s?void 0:s.tag_and_counts)||void 0===r?void 0:r.map((e=>e.typed_tag)).filter(t.isUserGeneratedTag))&&void 0!==a?a:[]).slice(0,5)]}}));
//# sourceMappingURL=c_react_query_api_helpers_queries_result_suggestions.js-vflm7WQPY.map
