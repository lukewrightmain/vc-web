define(["exports","./e_edison","./e_ui_page_files_router","./c_ui-icon_line_team","./c_avatar_initials_avatar","./c_core_notify","./c_core_uri","./c_ui_title_bubble","./c_ui_tooltip","./c_core_i18n","./c_integrations_profile_card_popover","./c_ui_overlay"],(function(e,t,o,a,n,r,i,s,l,c,u,m){"use strict";class p extends t.React$1.Component{constructor(e){super(e),this.state={photoUrl:this.props.photoUrl}}componentDidMount(){r.require_css("/static/metaserver/static/css/scooter/scooter-scoped-vfl0EaHDR.css"),document.addEventListener("db:account_photo:photo_set",(e=>{const t=2*this.props.dimension,o=`${t}x${t}`,a=i.URI.parse(e.detail.saved_photo_url).updateQuery({size:o}).toString();this.setState({photoUrl:a})})),document.addEventListener("db:account_photo:photo_deleted",(()=>{this.setState({photoUrl:null})})),!this.hasPhotoAvatar()&&this.props.onLoad&&this.props.onLoad()}hasPhotoAvatar(){return null!=this.state.photoUrl}render(){return this.state.photoUrl?t.React$1.createElement(n.PhotoAvatar,{alt:this.props.alt,dimension:this.props.dimension,onClick:this.props.onPhotoClick,photo:this.state.photoUrl,optionalClass:this.props.optionalClass,onLoad:this.props.onLoad,onError:this.props.onError,shape:"CIRCLE"}):this.props.defaultAvatar}}p.displayName="ViewerAvatar";function d(e,t,o){return function(a){e&&e(t,o),a.stopPropagation()}}const f={avatarDimension:32,titleButtonDirection:"south"};function g(e){return Object.assign(Object.assign({},f),e)}function _(){const e=o.Viewer.get_viewer(),t=e.get_user_by_role("personal",!0);if(t)return t.id;const a=e.get_user_by_role("work",!0);return a?a.id:void 0}function v(e){if(null==e||!(e.length>0))return"";let t=e.split(" ").map((e=>e.charAt(0).toLowerCase()));return t.length>2&&(t=t.splice(0,2)),t.join("")}function h(e,t){const a="editor"===t?o.defineMessage({id:"f8EJmj",defaultMessage:"{team_group_name} can edit"}):o.defineMessage({id:"JDP9ok",defaultMessage:"{team_group_name} can view"});return c.intl.formatMessage(a,{team_group_name:o.Emstring.em_snippet(e,o.SNIPPET_SIZES.DISPLAY_NAME)})}function E(e,t,a){let n;return n="editor"===t?c.intl.formatMessage({id:"yrMoVL",defaultMessage:"{count, plural, one{{count} person in {group_name} can edit} other{{count} people in {group_name} can edit}}"},{count:a,group_name:o.Emstring.em_snippet(e,o.SNIPPET_SIZES.DISPLAY_NAME)}):c.intl.formatMessage({id:"vbMu7n",defaultMessage:"{count, plural, one{{count} person in {group_name} can view} other{{count} people in {group_name} can view}}"},{count:a,group_name:o.Emstring.em_snippet(e,o.SNIPPET_SIZES.DISPLAY_NAME)}),n}function M(e,t,a,n=!1){let r;const i={viewer:c.intl.formatMessage({id:"DqcjPT",defaultMessage:"You can view"}),editor:c.intl.formatMessage({id:"yTQyaR",defaultMessage:"You can edit"}),owner:c.intl.formatMessage({id:"kQgvhd",defaultMessage:"You’re the owner"}),team:c.intl.formatMessage({id:"TCJe4K",defaultMessage:"You’re a member of this team folder"}),default:c.intl.formatMessage({id:"kFyzJs",defaultMessage:"You"})};e=o.Emstring.em_snippet(e,o.SNIPPET_SIZES.DISPLAY_NAME);const s={viewer:c.intl.formatMessage({id:"cIjfEc",defaultMessage:"{name} can view"},{name:e}),editor:c.intl.formatMessage({id:"WXJfQ5",defaultMessage:"{name} can edit"},{name:e}),owner:c.intl.formatMessage({id:"MomaNB",defaultMessage:"{name} is the owner"},{name:e}),pending:c.intl.formatMessage({id:"vTHStn",defaultMessage:"{name} hasn’t added this to their Dropbox yet"},{name:e}),team:c.intl.formatMessage({id:"1F4EvZ",defaultMessage:"{name} is a member of this team folder"},{name:e}),default:e,"no access":c.intl.formatMessage({id:"Y73l91",defaultMessage:"No access"})},l={viewer:c.intl.formatMessage({id:"fDtB1J",defaultMessage:"You ({name}) can view"},{name:e}),editor:c.intl.formatMessage({id:"lcZCGf",defaultMessage:"You ({name}) can edit"},{name:e}),owner:c.intl.formatMessage({id:"D9l0jJ",defaultMessage:"You ({name}) are the owner"},{name:e})};return r=a?n&&null!=e?l:i:s,r.hasOwnProperty(t)?r[t]:""}function P(e,t){if(e.length>t){const o=e.slice(0,t-1),a=e.length-(t-1);return o.push(c.intl.formatMessage({id:"OlmKiV",defaultMessage:"{count, plural, one{and {count} more…} other{and {count} more…}}"},{count:a})),o}return e}function y(e){switch(e){case"north":return m.StickyPosition.TOP;default:return m.StickyPosition.BOTTOM;case"east":return m.StickyPosition.RIGHT;case"west":return m.StickyPosition.LEFT}}function w(){return document.body}e.arePairedUsersInSf=function(e){if(!e)return!1;const t=o.Viewer.get_viewer();if(t.is_paired){const o=t.get_user_ids(!0),a=e.map((e=>e.user_id));if(a.includes(o[0])&&a.includes(o[1]))return!0}return!1},e.buildGroupsAndMembersText=function(e,a,n,r=5,i){const s=e.length,u=a.length+n.length;let m,p;const d=e=>o.Emstring.em_snippet(e,17);if(u>0){const e=P([...a.map((e=>d(e.display_name))),...n.map((e=>d(e.email_or_fbname)))],r);m=t.React$1.createElement(l.Tooltip,{key:"members_text",position:l.TooltipPosition.BOTTOM,tooltip_contents:e.join("\n"),tooltip_classname:i},c.intl.formatMessage({id:"ECZFz/",defaultMessage:"{count, plural, one{{count} member} other{{count} members}}"},{count:u}))}if(s>0){const o=P(e.map((e=>d(e.name))),r);p=t.React$1.createElement(l.Tooltip,{key:"groups_text",position:l.TooltipPosition.BOTTOM,tooltip_contents:o.join("\n"),tooltip_classname:i},c.intl.formatMessage({id:"GPgj53",defaultMessage:"{count, plural, one{{count} group} other{{count} groups}}"},{count:s}))}return m&&!p?m:p&&!m?p:p&&m?t.React$1.createElement("div",null,p,", ",m):void 0},e.findOwnerAndMeInJoinedMembers=function(e,t){let o,a;for(const n of e)if("owner"===n.access_type&&(o=n),n.user_id===t.id&&(a=n),o&&a)break;return[o,a]},e.getDescriptionForSharedLink=function(){return c.intl.formatMessage({id:"elYR2d",defaultMessage:"Shared link is available"})},e.getInitials=v,e.getViewerId=_,e.groupAccessTypeString=E,e.individualAccessTypeString=M,e.renderGroup=function({group:e,avatarArgs:r={}},i){let l,c;const{avatarDimension:m,onAvatarClick:p,titleButtonDirection:f}=g(r),M=d(p,"group",e);if(e.is_automatic?(c=h(e.name,e.access_type),l=t.React$1.createElement("div",{"data-testid":"facepile-avatar-wrapper",onMouseEnter:()=>{o.TeamsWebActionsLogger.log("hover_on_shared_with_facepile")}},t.React$1.createElement(n.PhotoAvatar,{alt:c,dimension:m,photo:a.TeamLine,shape:"CIRCLE",onClick:i?void 0:M}))):(c=E(e.name,e.access_type,e.num_users),l=t.React$1.createElement("div",{"data-testid":"facepile-avatar-wrapper",onMouseEnter:()=>{o.TeamsWebActionsLogger.log("hover_on_shared_with_facepile")}},t.React$1.createElement(n.InitialsAvatarWithColorDerivedFromName,{alt:c,dimension:m,name:e.name,shape:"CIRCLE",initials:v(e.name),onClick:i?void 0:M}))),i){const a=_();if(a)return t.React$1.createElement(o.Provider,{store:i.integrationStore,key:`group:${e.gid}:${e.name}`},t.React$1.createElement(u.ProfileCardPopover,{popoverGroup:i.integrationPopoverGroup,integrationStore:i.integrationStore,entryPoint:i.entryPoint,viewerId:a,avatarInfo:{avatarType:"group",targetGroup:{gid:e.gid,groupName:e.name,message:c}},file:i.fileInfo,portalParentElement:w()},t.React$1.createElement(o.Button$1,{variant:"styleless"},l)))}return t.React$1.createElement(s.TitleBubble,{key:`group:${e.gid}:${e.name}`,content:c,position:y(f)},l)},e.renderInvitedPerson=function({invited_member:e,avatarArgs:a={}},r){const{avatarDimension:i,onAvatarClick:l,titleButtonDirection:c}=g(a),m=d(l,"invited",e),p=M(e.email_or_fbname,"pending",!1),f=t.React$1.createElement("div",{"data-testid":"facepile-avatar-wrapper",onMouseEnter:()=>{o.TeamsWebActionsLogger.log("hover_on_shared_with_facepile")}},t.React$1.createElement(n.InitialsAvatar,{alt:p,dimension:i,color:"#aaa",initials:v(e.email_or_fbname),shape:"CIRCLE",onClick:r?void 0:m}));if(r){const a=_();if(a)return t.React$1.createElement(o.Provider,{store:r.integrationStore,key:`invitation:${e.invitation_id}`},t.React$1.createElement(u.ProfileCardPopover,{popoverGroup:r.integrationPopoverGroup,integrationStore:r.integrationStore,entryPoint:r.entryPoint,viewerId:a,avatarInfo:{avatarType:"invited_person",targetUser:{accountId:e.invitation_id,displayName:e.email_or_fbname,familiarName:void 0,accessType:p}},file:r.fileInfo,portalParentElement:w()},t.React$1.createElement(o.Button$1,{variant:"styleless"},f)))}return t.React$1.createElement(s.TitleBubble,{key:`invitation:${e.invitation_id}`,content:p,position:y(c)},f)},e.renderJoinedMember=function({arePairedUsersInSF:e,member:a,avatarArgs:r={}},i){let l;const c=a.user_id,m=o.Viewer.get_viewer(),f=m.get_user_ids(!0).includes(c);let v="";if(f&&e){const e=a.user_id,t=m.get_user_by_role("personal",!0),o=m.get_user_by_role("work",!0);t&&e===t.id?v="Personal":o&&e===o.id&&null!=m.team_name&&(v=m.team_name)}else({display_name:v}=a);v=o.Emstring.em_snippet(v,o.SNIPPET_SIZES.DISPLAY_NAME);const h=M(v,a.access_type,f,e),{avatarDimension:E,onAvatarClick:P,titleButtonDirection:b}=g(r),I=d(P,"member",a),$={alt:h,dimension:E,onPhotoClick:i?void 0:I,photoUrl:a.photo_url,defaultAvatar:t.React$1.createElement(n.InitialsAvatarWithColorDerivedFromName,{alt:h,dimension:E,name:a.display_name,initials:a.initials.toUpperCase(),shape:"CIRCLE",onClick:i?void 0:I})};if(l=f?t.React$1.createElement("div",{"data-testid":"facepile-avatar-wrapper",onMouseEnter:()=>{o.TeamsWebActionsLogger.log("hover_on_shared_with_facepile")}},t.React$1.createElement(p,Object.assign({},$))):t.React$1.createElement("div",{"data-testid":"facepile-avatar-wrapper",onMouseEnter:()=>{o.TeamsWebActionsLogger.log("hover_on_shared_with_facepile")}},t.React$1.createElement(n.AvatarWithDefault,Object.assign({},$))),i){const e=_();if(e)return t.React$1.createElement(o.Provider,{store:i.integrationStore,key:`user:${a.user_id}:${a.photo_url}`},t.React$1.createElement(u.ProfileCardPopover,{popoverGroup:i.integrationPopoverGroup,integrationStore:i.integrationStore,entryPoint:i.entryPoint,viewerId:e,avatarInfo:{avatarType:"joined_member",targetUser:{accountId:a.account_id,displayName:v,familiarName:a.familiar_name,accessType:h,isViewer:f,email:a.email,photoUrl:a.photo_url}},file:i.fileInfo,isShowInitially:i.autoDisplayTooltip,portalParentElement:w()},t.React$1.createElement(o.Button$1,{variant:"styleless"},l)))}return t.React$1.createElement(s.TitleBubble,{key:`user:${a.user_id}:${a.photo_url}`,content:h,position:y(b)},l)},e.renderOverflowCount=function(e){return({overflowCount:a,avatarArgs:r={}})=>{const i=c.intl.formatMessage({id:"kOMHR0",defaultMessage:"{count, plural, one{{count} more member} other{{count} more members}}"},{count:a}),l=a>=99?"99+":`${a}`,{avatarDimension:m,onAvatarClick:p,titleButtonDirection:d}=g(r),f=t.React$1.createElement(n.InitialsAvatar,{alt:i,dimension:m,initials:l,color:"#7B8994",shape:"CIRCLE",onClick:e?void 0:p});if(e){const a=_();if(a)return t.React$1.createElement(o.Provider,{store:e.integrationStore,key:"overflow_count"},t.React$1.createElement(u.ProfileCardPopover,{popoverGroup:e.integrationPopoverGroup,integrationStore:e.integrationStore,entryPoint:e.entryPoint,viewerId:a,avatarInfo:{avatarType:"overflow",overflowInfo:{message:i}},file:e.fileInfo,onAvatarClick:p||void 0,portalParentElement:w()},t.React$1.createElement(o.Button$1,{variant:"styleless"},f)))}return t.React$1.createElement(s.TitleBubble,{key:"overflow_count",content:i,position:y(d)},f)}},e.teamAccessTypeString=h}));
//# sourceMappingURL=c_sharing_member_avatars.js-vflfLmQGz.map
