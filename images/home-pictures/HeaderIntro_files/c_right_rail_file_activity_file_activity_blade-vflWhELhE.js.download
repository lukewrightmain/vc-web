define(["require","exports","./e_edison","./e_ui_page_files_router","./c_core_notify","./c_icon_file_folder_icon","./c_core_i18n","./c_api_v2_redux_files","./c_tslib","./c_folder_dialog_folder_picker_dig","./c_info_blade_content_metadata_image_metadata","./c_truncate_index","./c_src_common_filepath","./c_flows_approval_approval_io_client","./c_breadcrumb_index","./c_data_action_creators_index","./c_comments_component_pane","./c_controls_index","./c_spectrum_tertiary_link_tertiary_list","./c_sharing_async_share_modal_util","./c_core_browser_detection","./e_core_exception","./c_lodash-es_lodash","./c_spectrum_avatar_avatar_initials","./c_spectrum_avatar_avatar_color_util","./c_spectrum_popover_popover_content","./c_flows_lib_api","./c_ui-icon_line_automation","./c_components_section_tags_section_preview","./c_flows_utils_async_modal_launchers","./c_flows_redux_selectors","./c_components_flows-icon-button_index","./c_workflow_builder_workflow_actions_action_ui_config","./c_flows_redux_reducer","./c_components_approval-forms_approval_request_modal","./c_components_approval-forms_approval_checkbox_in_share","./c_components_approval-forms_gating_utils","./c_flows_version_change_log_section","./c_comments_data_store","./c_file_activity_component_file_activity_blade","./c_file_activity_data_store"],(function(e,t,a,r,o,s,n,i,l,c,d,p,u,m,g,h,f,_,v,E,C,S,x,b,y,k,T,w,M,R,F,N,O,L,I,P,D,A,B,U,j){"use strict";const H=e=>{const t=e instanceof r.File&&!e.is_dir?e:null;return Boolean(t)},$=e=>{const t=e instanceof r.File&&e.is_dir?e:null;return Boolean(t)},V=e=>{const t=e instanceof r.FileSharedWithMe?e:null;return Boolean(t)},W=e=>e.every(H);const z=({selectedFiles:e,user:t,viewType:o,isSearchMode:s,showMostRecentFilesFirst:n})=>{if(0===e.count())return null;if(1===e.count()){const n=e.first();return a.React$1.createElement("div",{className:"selection-preview-pane__container"},t&&o&&n instanceof r.File&&!n.is_dir?a.React$1.createElement(K,{files:e,key:n.fq_path,user:t,viewType:o,isSearchMode:Boolean(s)}):a.React$1.createElement(q,{file:n,isSearchMode:Boolean(s)}))}if(2===e.count())return a.React$1.createElement("div",{className:"selection-preview-pane__container selection-preview-pane__container-double"},a.React$1.createElement(q,{file:e.get(1)}),a.React$1.createElement(q,{file:e.get(0)}));const i=n?e.slice(e.size-3).reverse():function(e){const t=e.slice(0,3).reverse();if(3===e.count())return t;const a=[];let o=0,s=0;for(let t=0;t<e.count();t++){const n=e.get(t);if(n instanceof r.File&&n.is_dir&&s<2?(s++,a.push(n)):(n instanceof r.FileSharedWithMe||!n.is_dir)&&o<2&&(o++,a.push(n)),3===a.length)break}return a.length<3?t:r.immutable.exports.List(a).reverse()}(e);return a.React$1.createElement("div",{className:"selection-preview-pane__container selection-preview-pane__container-multi"},i.map((e=>a.React$1.createElement(q,{file:e,key:e instanceof r.File?e.fq_path:e.filename}))))};z.displayName="SelectionPreviewIcon";const K=({files:t,user:i,viewType:l,isSearchMode:c})=>{const d=a.React$1.createRef(),p=a.React$1.createRef(),[u,m]=a.React$1.useState(!1),[g,h]=a.React$1.useState("top"),f=t.first(),_=f instanceof r.File?r.href_for_file(i,f):f.href,v={user:i,files:t,isSearchMode:c,viewType:l},E=()=>{m(!0)},C=()=>{m(!1)},S=(t,a,o)=>{if(0===t.button){const s=r.hasModifierKey(t);if(s)return void t.stopPropagation();if(t.preventDefault(),t.stopPropagation(),s)return void r.open_tab(a);new Promise((function(t,a){e(["./c_browse_file_actions_action_handlers"],t,a)})).then((function(e){return e.action_handlers_esnext})).then((({handlePreview:e})=>{e(o,r.ActionSourceValue.DETAILS_PANE_PREVIEW)}))}};return a.react.exports.useEffect((()=>{if(d.current){const e=d.current.children[0];if("svg"===(null==e?void 0:e.tagName)){e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),e.setAttribute("pointer-events","none");const t=e.querySelector("a"),s=t?t.innerHTML:e.innerHTML;if(""===s)return;a.reactDom.exports.render(a.React$1.createElement(r.Link,{xlinkHref:_,dangerouslySetInnerHTML:{__html:o.purify.sanitize(s)},style:{pointerEvents:"all"},ref:p,onMouseEnter:E,onMouseLeave:C,onClick:e=>{S(e,_,v)},tabIndex:-1}),e)}}}),[d,p,_,v]),a.React$1.createElement("div",{className:"selection-preview-pane__icon",ref:d},a.React$1.createElement(r.Tooltip.Control,{triggerRef:p,auto:!0,open:u,placement:g,onChangePlacement:h},n.intl.formatMessage({id:"VbRtEL",defaultMessage:"Preview"})),a.React$1.createElement(s.LargeFileOrFolderIcon,{file:f,iconSize:256,hideBadge:!0,iconDelay:1e3,onPreviewClick:e=>{S(e,_,v)},previewUrl:_}))};K.displayName="SelectionPreviewSingleIcon";const q=({file:e,isSearchMode:t})=>e?a.React$1.createElement("div",{className:"selection-preview-pane__icon"},a.React$1.createElement(s.LargeFileOrFolderIcon,{file:e,iconSize:256,hideBadge:!0,iconDelay:1e3})):a.React$1.createElement("div",{className:"selection-preview-pane__icon"});q.displayName="SelectionPreviewFileIcon";const G=n.intl.formatMessage({id:"+kc9n+",defaultMessage:"Show all"}),Y=n.intl.formatMessage({id:"5tvWhA",defaultMessage:"Hide"});r.injectInternalStyle("metaserver/static/js/right_rail/info_blade/info_blade.module.out.css",(e=>"._metadata-container_jx2v5_4:not(:empty){display:flex;flex-direction:column;margin-top:20px}._metadata-row_jx2v5_9{display:flex}._metadata-title_jx2v5_12{display:flex;width:92px}._metadata-data_jx2v5_16{flex:1 1 0;margin-left:var(--spacing__unit--2);min-width:0}._pathbar_jx2v5_23 a{color:var(--color__faint__text)}._section-header_jx2v5_26{margin-bottom:var(--spacing__unit--0_5)}._container_jx2v5_31{display:flex;flex-direction:column;height:100%}._container_jx2v5_31 .file-breadcrumb-link>span{color:var(--color__standard__text)}._icon-container_jx2v5_42{display:flex;justify-content:center}._icon-container_jx2v5_42 .file-icon__preview:focus:not([data-focus-visible-added]){box-shadow:none;margin:0;padding:0}._icon-container_jx2v5_42 .file-icon__preview:focus{box-shadow:inset 0 0 0 3px var(--color__utility__focusring);margin:0;padding:0}._icon-container_jx2v5_42 .selection-preview-pane__icon,._icon-container_jx2v5_42 .selection-preview-pane__icon>a{height:100%;width:100%}._icon-container_jx2v5_42 .selection-preview-pane__icon img,._icon-container_jx2v5_42 .selection-preview-pane__icon svg{padding:0}._icon-container_jx2v5_42 .selection-preview-pane__icon img{border:1px solid var(--color__standard__border);box-sizing:border-box;display:block;filter:none;height:auto;margin:auto;max-height:100%;max-width:100%;width:auto}._icon-container_jx2v5_42 .selection-preview-pane__icon svg{filter:drop-shadow(0 1px 1.5px rgba(23,23,23,.2)) drop-shadow(0 0 1px rgba(23,23,23,.1));height:100%;width:100%}._icon-container_jx2v5_42 .selection-preview-pane__icon svg.mc-icon-template-content--form-large,._icon-container_jx2v5_42 .selection-preview-pane__icon svg.mc-icon-template-content--form_result-large{height:62%;margin:14%;width:62%}._icon-container_jx2v5_42 .selection-preview-pane__container{height:168px;position:relative;width:100%}._icon-container_jx2v5_42 .selection-preview-pane__container .selection-preview-pane__icon{height:100%;width:100%}._icon-container_jx2v5_42 .selection-preview-pane__container-double .selection-preview-pane__icon{align-items:center;display:flex;float:left;height:70%;position:absolute;width:50%}._icon-container_jx2v5_42 .selection-preview-pane__container-double .selection-preview-pane__icon img{margin:unset}._icon-container_jx2v5_42 .selection-preview-pane__container-double .selection-preview-pane__icon svg{transform:scale(1.5);width:unset}._icon-container_jx2v5_42 .selection-preview-pane__container-double .selection-preview-pane__icon:first-child{transform:translate(var(--spacing__unit--2),var(--spacing__unit--2));z-index:2}._icon-container_jx2v5_42 .selection-preview-pane__container-double .selection-preview-pane__icon:nth-child(2){transform:translate(calc(var(--spacing__unit--2)*-1),calc(var(--spacing__unit--2)*-1));z-index:1}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon{height:53%;left:23.5%;position:absolute;top:23.5%;width:53%}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon:first-child{transform:none;z-index:3}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon:nth-child(2){transform:rotate(-22deg);z-index:2}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon:nth-child(3){transform:rotate(22deg);z-index:1}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon svg{height:150%;left:-25%;position:absolute;top:-25%;transform:none;width:150%}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon svg.mc-icon-template-content--form-large,._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon svg.mc-icon-template-content--form_result-large{height:93%;left:3.5%;top:3.5%;width:93%}._folder-overview_jx2v5_208{font-family:var(--type__body__small--fontfamily);font-size:var(--type__body__small--fontsize);line-height:var(--type__body__small--lineheight);margin-top:var(--spacing__unit--2)}._folder-overview_jx2v5_208 .folder-overview__border{border-radius:0}._folder-overview_jx2v5_208 .folder-overview__fixed-toolbar-container{margin-left:0;margin-top:0;padding:0;width:100%}._folder-overview_jx2v5_208 .folder-overview__fixed-toolbar-container .cb-last-edit__message-wrapper{color:var(--color__faint__text);font-family:var(--type__body__small--fontfamily);font-size:var(--type__body__small--fontsize);font-weight:var(--type__body__small--fontweight);line-height:var(--type__body__small--lineheight)}._folder-overview_jx2v5_208 .folder-overview__fixed-toolbar-container .cb-last-edit__message-wrapper svg{display:none}._folder-overview_jx2v5_208 .folder-overview__fixed-toolbar-container .cb-last-edit__message-wrapper .cb-last-edit__message{margin-left:0}._folder-overview_jx2v5_208 .folder-overview__fixed-toolbar-container .folder-overview__inline-readonly-icon{display:none}._folder-overview_jx2v5_208 .folder-overview__description--placeholder{color:var(--color__faint__text);font-family:var(--type__body__small--fontfamily);font-size:var(--type__body__small--fontsize);font-weight:var(--type__body__small--fontweight);line-height:var(--type__body__small--lineheight)}._folder-overview_jx2v5_208 .folder-overview__description--placeholder>span{border-radius:0;margin-right:0;padding:0}._folder-overview-tooltip-anchor_jx2v5_270{transform:translateY(9px)}._tooltip-button_jx2v5_274{align-items:flex-end;display:flex;flex-direction:column}"));const Z="_metadata-container_jx2v5_4",Q="_metadata-row_jx2v5_9",J="_metadata-title_jx2v5_12",X="_metadata-data_jx2v5_16",ee="_pathbar_jx2v5_23",te="_section-header_jx2v5_26",ae="_container_jx2v5_31",re="_icon-container_jx2v5_42",oe="_folder-overview_jx2v5_208",se=({title:e,data:t})=>a.react.exports.createElement("div",{className:Q},a.react.exports.createElement("div",{className:J},"string"==typeof e?a.react.exports.createElement(r.Text,{size:"small",variant:"paragraph",color:"faint"},e):e),a.react.exports.createElement("div",{className:X},t));se.displayName="InfoBladeMetadataRow";const ne=new r.HiveLogger,ie=({value:e})=>{const{onChangePlacement:t,placement:o}=u.useTooltipPlacement();return a.React$1.createElement(r.Text,{variant:"paragraph",size:"small"},a.React$1.createElement(p.Truncate,{tooltipControlProps:{placement:o,openDelay:500,onChangePlacement:t,maxWidth:210},lines:3},e))},le=r.requireCssWithComponent((({file:e,user:t})=>{const[o,s]=a.React$1.useState({}),[i,l]=a.React$1.useState(!1);if(a.React$1.useEffect((()=>{((e,t)=>new r.DefaultUserApiV2Client(e).ns("files").rpc("get_file_content_metadata",{file_path_or_id:t},{}).then((({metadata:e})=>e&&"image"===e[".tag"]?e:{})))(t,e.file_id).then((e=>s(e))).catch((()=>s({})))}),[e.file_id]),!o)return a.React$1.createElement(a.React$1.Fragment,null);const c=d.getImageSpecificDataFields(Object.assign(Object.assign({},o),{".tag":"image"}),n.intl).filter((e=>!!e.value)).map((e=>a.React$1.createElement(se,{key:e.name,title:e.name,data:a.React$1.createElement(ie,{value:e.value})}))),p=c.length>5,u=i?Y:G,m=i?c:c.slice(0,5);return a.React$1.createElement("div",{className:"rr-mi"},...m,p&&a.React$1.createElement(r.Button,{size:"small",className:"rr-mi-expand-button",variant:"transparent",onClick:()=>{i?(e=>{ne.log(new r.WebUserActionRow({user_id:e.id,event_name:r.WebUserActionLogEvent.MEDIA_FILTERS_HIDE_EXTRA_INFO,extra:{right_sidebar_state:"opened",entity_type:"file"}}))})(t):((e=>{ne.log(new r.WebUserActionRow({user_id:e.id,event_name:r.WebUserActionLogEvent.MEDIA_FILTERS_SHOW_ALL_INFO,extra:{right_sidebar_state:"opened",entity_type:"file"}}))})(t),r.UserSurvey.trackEvent("organized_search_click_show_all","right_rail")),l(!i)}},u))}),["/static/metaserver/static/css/media_filters/media_information-vflj211H8.css"]),ce="https://www.dropbox.com/backup/all?_source=breadcrumb";function de(e,t){return a=>{0===a.button&&(a.altKey||a.ctrlKey||a.metaKey||a.shiftKey)||(a.preventDefault(),t(e))}}const pe=a.react.exports.memo((e=>{var{basePath:t,path:o,size:s,user:n,useFullPath:i,isForCurrentPath:c,setUrl:d}=e,p=l.__rest(e,["basePath","path","size","user","useFullPath","isForCurrentPath","setUrl"]);const u=r.useSelector(r.backups);if(!t&&!(null!==u))return null;const m=t?r.normalize(r.parent_dir(t)):"",h=r.normalize(o).replace(m,""),f=r.parent_dirs(h).reverse().map((e=>m+e));return i&&""!==h&&f.push(m+h),a.react.exports.createElement(g.Breadcrumb,Object.assign({size:s,isRootOverflow:!0},p),a.react.exports.createElement(g.Breadcrumb.Link,{key:"breadcrumb-backup",href:ce,isCurrentPath:!1,onClick:de(ce,r.redirect),className:"file-breadcrumb-link"},a.react.exports.createElement(r.FormattedMessage,{id:"96Ymix",defaultMessage:"Backups"})),f.map(((e,t)=>{var o;const s=c&&t===f.length-1,i=s?void 0:r.browse_uri_for_fq_path(n,e).toString(),l=s?void 0:de(e,d),p=null==u?void 0:u.find((t=>t.fqPath===e)),m=0===t,h=r.isBackupBrowse()&&m?p?null!==(o=p.displayName)&&void 0!==o?o:null==p?void 0:p.name:"":r.getDisplayedFilename(r.filename(e));return a.react.exports.createElement(g.Breadcrumb.Link,{key:r.filename(e),href:i,isCurrentPath:s,onClick:l,className:"file-breadcrumb-link","data-testid":"file-breadcrumb-link"},h)})))}));pe.displayName="BackupBreadcrumb";const ue=()=>{const e=r.useIntl();return a.react.exports.createElement(se,{title:e.formatMessage({id:"Et1Afo",defaultMessage:"State"}),data:a.react.exports.createElement(r.Text,{variant:"paragraph",size:"small"},e.formatMessage({id:"9n8qGi",defaultMessage:"Deleted"}))})};ue.displayName="StatusDeletedRow";const me=({file:e,user:t,isSelection:o,isSearchMode:s,setUrl:n,showApproval:i,navigateToBlade:l,showHeader:d=!1,showMediaDetails:p=!1,isInsideBackup:g,backupFolderPath:h,lastBackupTime:f})=>{const _=r.useIntl();let v="";if(g&&$(e)&&(v=f?r.format_date_timezone_offset(new Date(.001*f),r.localized_datetime_format):"--"),$(e)&&"/"===e.fq_path)return null;const E=V(e)?null:{className:ee,size:"small",path:e.fq_path,user:t,useFullPath:!1,isForCurrentPath:!s&&o,setUrl:n,key:e.fq_path};return a.react.exports.createElement(a.react.exports.Fragment,null,d&&a.react.exports.createElement(r.Text,{variant:"paragraph",size:"small",isBold:!0,className:te},_.formatMessage({id:"sWbsHy",defaultMessage:"Properties"})),E&&a.react.exports.createElement(se,{title:g?_.formatMessage({id:"/7OiQL",defaultMessage:"Location"}):_.formatMessage({id:"vRjK3h",defaultMessage:"Saved in"}),data:g?a.react.exports.createElement(pe,Object.assign({},E,{basePath:h})):a.react.exports.createElement(c.FileBreadcrumb,Object.assign({},E))}),!V(e)&&e.isDeleted&&a.react.exports.createElement(ue,null),(e=>!(e.is_cloud_doc&&0===e.bytes)&&(V(e)||H(e)&&!e.isDeleted))(e)&&a.react.exports.createElement(se,{title:_.formatMessage({id:"7+ns4J",defaultMessage:"Size"}),data:a.react.exports.createElement(r.Text,{variant:"paragraph",size:"small"},e.size)}),a.react.exports.createElement(se,{title:g?_.formatMessage({id:"EjOYMM",defaultMessage:"Last backup"}):_.formatMessage({id:"R3SV35",defaultMessage:"Modified"}),data:a.react.exports.createElement(r.Text,{variant:"paragraph",size:"small"},""===v?e.ago:v)}),!$(e)&&a.react.exports.createElement(se,{title:_.formatMessage({id:"/m87Qb",defaultMessage:"Type"}),data:a.react.exports.createElement(r.Text,{variant:"paragraph",size:"small"},H(e)?r.File.getCategoryDescription(e,void 0,!0):r.FileSharedWithMe.getCategoryDescription(e))}),i&&l&&a.react.exports.createElement(u.ApprovalMetadata,{fileId:e.file_id,getApprovalStatus:e=>m.getFileApprovalStatus(t.id,e),onClick:()=>l("comments"),InfoBladeRowComponent:se,logger:a=>r.logApprovalActions({user_id:t.id,event_name:r.WebUserActionLogEvent.RIGHT_RAIL_APPROVAL_STATUS_CLICK,action_surface:r.ActionSurfaceLogValue.RIGHT_SIDEBAR,file_id:e.file_id,file_extension:e.ext,approval_status:a})}),p&&H(e)&&a.react.exports.createElement(le,{file:e,user:t}))};me.displayName="SingleFileMetadata";const ge=({files:e})=>e.every((e=>!V(e)&&e.isDeleted))?a.react.exports.createElement(ue,null):null;ge.displayName="MultiFileMetadata";const he=e=>{var{files:t}=e,r=l.__rest(e,["files"]);const o=1===t.size?a.react.exports.createElement(me,Object.assign({},r,{file:t.first()})):t.size>1&&a.react.exports.createElement(ge,{files:t});return o?a.react.exports.createElement("div",{className:Z},o):null};he.displayName="InfoBladeMetadata";class fe extends f.BaseLayer{constructor(e){super(),this.options=e}triggerInit(e){const t=e.status.folderOverview.editorState;e.innerProps.prevStatus.folderOverview.editorState!==t&&(e.triggers.draft.init(null),e.triggers.draft.change(t))}callOnContentChange(e){const t=e.innerProps.value;this.options.onEditorStateChange(t)}handleTabIndent(e){const{innerProps:{evt:t}}=e,a=e.innerProps.value;if(9===t.which&&e.status.accessibility.captureTab){const e=f.Draft.RichUtils.onTab(t,a,4);if(t.preventDefault(),e!==a)return e}}}l.__decorate([f.plug(f.intoFolderOverview.folderOverview)],fe.prototype,"triggerInit",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.change.update.editorState)],fe.prototype,"callOnContentChange",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.key.update.editorState)],fe.prototype,"handleTabIndent",null);class _e extends f.BaseLayer{constructor(e){super(),this.options=e}updateLinkPrompt(e){return e.innerProps.evt}maybeCreateLinkOnPaste(e){const t=e.innerProps.evt.trim();return f.isValidURL(t)?this.createLinkInEditorState(Object.assign(Object.assign({},e),{innerProps:Object.assign(Object.assign({},e.innerProps),{evt:t})})):e.status.draft.editorState}createLink(e){const t=e.innerProps.evt.trim();return this.createLinkInEditorState(Object.assign(Object.assign({},e),{innerProps:Object.assign(Object.assign({},e.innerProps),{evt:t})})),null}createLinkInEditorState(e){const t=e.innerProps.evt.trim(),a=e.status.draft.editorState;let r=a.getCurrentContent(),o=a.getSelection();o.isCollapsed()&&(r=f.Draft.Modifier.insertText(r,o,t),o=o.merge({focusOffset:o.getStartOffset()+t.length}));const s=r.createEntity("LINK","MUTABLE",{url:t}),n=s.getLastCreatedEntityKey(),i=f.Draft.EditorState.set(a,{currentContent:s});let l=f.Draft.RichUtils.toggleLink(i,o,n),c=l.getSelection();const d=c.getFocusOffset()<c.getAnchorOffset()?c.getAnchorOffset():c.getFocusOffset();return c=c.merge({anchorOffset:d,focusOffset:d}),l=f.Draft.EditorState.forceSelection(l,c),e.triggers.draft.change(l),l}openLink(e){this.options.onOpenLink(e.innerProps.evt)}addDecoratorsOnChange(e){const{value:t}=e.innerProps;return[...t,{strategy:function(e,t,a){e.findEntityRanges((function(e){const t=e.getEntity();return null!==t&&"LINK"===a.getEntity(t).getType()}),t)},props:{readOnly:e.status.draft.readOnly,onOpenLink:e.triggers.hyperlink.openLink},component:f.LinkSpanComponent}]}handleKeyCommand(e){const{evt:t}=e.innerProps;"create-link"===t&&e.triggers.hyperlink.updateLinkPromptProps({top:0,left:0})}}l.__decorate([f.plug(f.intoFolderOverview.hyperlink.on.updateLinkPromptProps.update.linkPromptProps)],_e.prototype,"updateLinkPrompt",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.pasteText.update.editorState)],_e.prototype,"maybeCreateLinkOnPaste",null),l.__decorate([f.plug(f.intoFolderOverview.hyperlink.on.createLink.update.linkPromptProps)],_e.prototype,"createLink",null),l.__decorate([f.plug(f.intoFolderOverview.hyperlink.on.openLink)],_e.prototype,"openLink",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.init.update.decorators)],_e.prototype,"addDecoratorsOnChange",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.keyCommand)],_e.prototype,"handleKeyCommand",null);class ve extends f.BaseLayer{hidePlaceholderWhenContentEmpty(e){const t=e.innerProps.evt.getCurrentContent(),a=!t.hasText()&&"unstyled"===t.getBlockMap().first().getType();e.triggers.globalStyle.setClassName({className:"empty-content",value:a})}updateClassNames(e){const t=e.status.globalStyle.classNames,{className:a,value:r}=e.innerProps.evt;return t[a]=r,t}}l.__decorate([f.plug(f.intoFolderOverview.draft.on.change)],ve.prototype,"hidePlaceholderWhenContentEmpty",null),l.__decorate([f.plug(f.intoFolderOverview.globalStyle.on.setClassName.update.classNames)],ve.prototype,"updateClassNames",null);const Ee=(e,t)=>f.Draft.Modifier.setBlockType(e,f.Draft.SelectionState.createEmpty(t),"unordered-list-item"),Ce=(e,t)=>f.Draft.Modifier.setBlockType(e,f.Draft.SelectionState.createEmpty(t),"ordered-list-item"),Se=(e,t,a)=>{const r=f.Draft.Modifier.setBlockType(e,f.Draft.SelectionState.createEmpty(t),"task-block");return f.Draft.Modifier.setBlockData(r,f.Draft.SelectionState.createEmpty(t),{checked:a})},xe={"-":Ee,"—":Ee,"--":Ee,"*":Ee,"1.":Ce,"1)":Ce,"1.)":Ce,"[]":(e,t)=>Se(e,t,!1),"[ ]":(e,t)=>Se(e,t,!1),"[x]":(e,t)=>Se(e,t,!0)};class be extends f.BaseLayer{constructor(e=xe){super(),this.prefixFormatMap=e}handleSpaceAndTriggerFormat(e){const{innerProps:{evt:t,value:a}}=e,r=a.getSelection(),o=a.getCurrentContent(),s=o.getBlockMap().get(r.getStartKey());if(s&&32===t.which){const e=s.getText().slice(0,r.getStartOffset());if(e in this.prefixFormatMap){const r=s.getKey(),n=this.prefixFormatMap[e],i=f.Draft.SelectionState.createEmpty(r).merge({anchorOffset:0,focusOffset:e.length}),l=n(f.Draft.Modifier.removeRange(o,i,"backward"),r);t.preventDefault();const c=f.Draft.EditorState.push(a,l,"change-block-type");return f.Draft.EditorState.forceSelection(c,f.Draft.SelectionState.createEmpty(r))}}}}l.__decorate([f.plug(f.intoFolderOverview.draft.on.key.update.editorState)],be.prototype,"handleSpaceAndTriggerFormat",null);const ye=(e,{container:t})=>{const{block:o,offsetKey:s,blockProps:n,blockProps:{onToggleChecked:i}}=e,l=t.getStatus().draft.readOnly,c=r.useIntl(),d=a.react.exports.useCallback((e=>{l||(e.stopPropagation(),e.preventDefault())}),[l]),p=a.react.exports.useCallback((e=>{l||(i(),e.stopPropagation(),e.preventDefault())}),[l,i]),u=a.react.exports.useCallback((e=>{l||(e.stopPropagation(),e.preventDefault())}),[l]),m=0===o.getLength(),g=r.classnames(f.classes.taskBlock,{[f.classes.checked]:n.checked,[f.classes.readonly]:l,[f.classes.emptyBlock]:m});return a.react.exports.createElement("div",{className:g,"data-offset-key":s,"data-key":o.getKey()},a.react.exports.createElement("div",{suppressContentEditableWarning:!0,contentEditable:!1},a.react.exports.createElement("div",{className:f.classes.taskBlockClickableDiv,onMouseUp:p,onClick:u,onMouseDown:d}),a.react.exports.createElement(_.Checkbox,{className:f.classes.taskBlockCheckbox,checked:n.checked}),m?a.react.exports.createElement("div",{className:r.classnames(f.classes$1.scCommentEditorPlaceholder,f.classes.taskPlaceholder)},c.formatMessage({id:"NPxYv8",defaultMessage:"Create a to-do and assign it @someone"})):null),a.react.exports.createElement("div",{className:"checkable-list-item-block__text"},a.react.exports.createElement(f.Draft.EditorBlock,Object.assign({},e))))};ye.displayName="TaskComponent",ye.contextTypes={container:r.PropTypes.object};class ke extends f.BaseLayer{constructor(e){super(),this.taskOptions=e}toggleTaskBlock(e){const{editorState:t}=e.status.draft,a=t.getCurrentContent(),r=f.getSelectedBlocksList(t),o={};r.forEach((e=>{if(e){const t=e.getKey(),a=e.removeIn(["data","checked"]),r="task-block"!==e.get("type")?"task-block":"unstyled";o[t]=a.set("type",r)}}));const s=a.getBlockMap().merge(o),n=f.Draft.EditorState.push(t,a.merge({blockMap:s}),"change-block-type");e.triggers.draft.change(n)}setTaskState(e){const{key:t,checked:a}=e.innerProps.evt,r=e.status.draft.editorState;e.triggers.draft.change(f.mergeBlockDataByKey(r,t,{checked:a},!1)),this.taskOptions.onTaskChecked(t,a)}addBlockFn(e){const{value:t}=e.innerProps;return Object.assign(Object.assign({},t),{"task-block":t=>{const a=t.getData().get("checked");return{component:ye,props:{onToggleChecked:()=>{e.triggers.task.setTaskState({checked:!a,key:t.getKey()})},checked:a}}}})}}l.__decorate([f.plug(f.intoFolderOverview.task.on.toggleTaskBlock)],ke.prototype,"toggleTaskBlock",null),l.__decorate([f.plug(f.intoFolderOverview.task.on.setTaskState)],ke.prototype,"setTaskState",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.init.update.blockRenderers)],ke.prototype,"addBlockFn",null);class Te extends f.BaseLayer{setCaptureTabIndent(e){return e.innerProps.evt}handleTabIndent(e){const{innerProps:{evt:t}}=e;"Escape"===t.key?e.triggers.accessibility.setCaptureTab(!1):9!==t.which&&(e.status.accessibility.captureTab||e.triggers.accessibility.setCaptureTab(!0))}}function we(e){return(!!e.hyperlink.linkPromptProps||e.draft.isFocused||!!e.mentionShareFlow.popupProps)&&!e.draft.readOnly}l.__decorate([f.plug(f.intoFolderOverview.accessibility.on.setCaptureTab.update.captureTab)],Te.prototype,"setCaptureTabIndent",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.key)],Te.prototype,"handleTabIndent",null);class Me extends f.BaseLayer{onDraftChange(e){const t=e.innerProps.evt,a=f.getSelectionInlineStyle(t),r=f.getSelectionBlockTypes(t),o={bold:a.BOLD,strikethrough:a.STRIKETHROUGH,italic:a.ITALIC,task:"task-block"===r,orderedList:"ordered-list-item"===r,unorderedList:"unordered-list-item"===r};e.triggers.fixedToolbar.updateActiveFormatting(o)}onDraftFocus(e){this.updateToolbarVisibility(e.status,e.triggers)}onDraftBlur(e){this.updateToolbarVisibility(e.status,e.triggers)}updateToolbarVisibility(e,t){t.globalStyle.setClassName({className:"fixed-toolbar-visible",value:we(e)})}updateActiveFormatting(e){return e.innerProps.evt}handleKeyCommand(e){const{evt:t,value:a}=e.innerProps;return"strikethrough"===t?f.Draft.RichUtils.toggleInlineStyle(a,"STRIKETHROUGH"):void 0}}l.__decorate([f.plug(f.intoFolderOverview.draft.on.change)],Me.prototype,"onDraftChange",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.focus)],Me.prototype,"onDraftFocus",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.blur)],Me.prototype,"onDraftBlur",null),l.__decorate([f.plug(f.intoFolderOverview.fixedToolbar.on.updateActiveFormatting.update.activeFormatting)],Me.prototype,"updateActiveFormatting",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.keyCommand.update.editorState)],Me.prototype,"handleKeyCommand",null);const Re={draft:f.DraftNames,folderOverview:f.FolderOverviewNames,macro:f.MacroNames,mentionSuggestions:f.MentionSuggestionNames,suggestion:f.SuggestionSelectionNames,fixedToolbar:f.FixedToolbarNames,hyperlink:f.HyperlinkNames,globalStyle:f.GlobalStyleNames,task:f.TaskNames,mentionShareFlow:f.MentionShareFlowNames,accessibility:f.AccessibilityNames},Fe=()=>{};class Ne extends f.EditorContainer{get scopeNames(){return Re}getLayerProps(e){const{mentionShareFlowHandlers:t=f.DefaultMentionShareFlowHandlers,onOpenLink:a=Fe,onEditorStateChange:r=Fe,onMentionsQueryUpdated:o=Fe,onTaskChecked:s=Fe,hideAllToolbars:n=!1,onToolbarDone:i=Fe}=e;return{mentionShareFlowHandlers:t,onOpenLink:a,onEditorStateChange:r,onMentionsQueryUpdated:o,onTaskChecked:s,hideAllToolbars:n,onToolbarDone:i}}mapPropsToLayers(e){const{mentionShareFlowHandlers:t,onOpenLink:a,onEditorStateChange:r,onMentionsQueryUpdated:o,onTaskChecked:s,hideAllToolbars:n}=this.getLayerProps(e);return[new f.InteractionLayer,new f.TextLayer,new f.StyleLayer,new ve,new _e({onOpenLink:a}),new f.MentionsEntityLayer,new f.MentionsMacroLayer({onMentionsQueryUpdated:o}),new ke({onTaskChecked:s}),new be,!n&&new Me,new f.SuggestionLayer,new f.MentionShareFlowLayer(t),new fe({onEditorStateChange:r}),new f.UpdateLayer,new Te].filter((e=>!!e))}createDefaultStatus(){const e=f.createDefaultStatus(this.scopeNames);return Object.assign(Object.assign({},e),{draft:Object.assign(Object.assign({},e.draft),{readOnly:!!this.props.readOnly}),accessibility:{captureTab:!1}})}mapPropsToUpdates(e,t){let a={};const r=!!e.readOnly||!!t.mentionShareFlow.popupProps;return e.editorState!==t.folderOverview.editorState&&(a=Object.assign(Object.assign({},a),{folderOverview:Object.assign(Object.assign({},t.folderOverview),{editorState:e.editorState})})),r!==t.draft.readOnly&&(a=Object.assign(Object.assign({},a),{draft:Object.assign(Object.assign({},t.draft),{editorState:e.editorState?e.editorState:t.draft.editorState,readOnly:r})})),e.mentionsMatches!==t.mentionSuggestions.userMap&&(a=Object.assign(Object.assign({},a),{mentionSuggestions:Object.assign(Object.assign({},t.mentionSuggestions),{userMap:e.mentionsMatches||{}})})),a}}const Oe=({className:e,children:t},{container:o})=>{const s=o.getStatus().globalStyle.classNames,n=r.classnames(e,s);return a.react.exports.createElement("div",{className:n},t)};Oe.displayName="GlobalStyleComponent",Oe.contextTypes={container:r.PropTypes.object};class Le extends a.react.exports.Component{constructor(){super(...arguments),this.popoverContainerRef=null,this.cachedPosition=null,this.setPopoverContainerRef=e=>{this.popoverContainerRef=e}}getPosition(){const{scrollClassName:e}=this.props;if(!this.popoverContainerRef)return null;const t=f.getOffsetParent(this.popoverContainerRef,e);if(!t)return null;const a=this.props.computeTargetPosition(t);if(!this.popoverContainerRef||!a)return null;const r=t.getBoundingClientRect(),o=Math.round(a.left+a.width/2-r.left),s=10+this.props.popoverWidth/2,n=Math.min(Math.max(o,s),r.width-s),i={top:a.top-r.top,left:this.props.limitedWidth?0:n};return this.cachedPosition=i,i}getCachedPosition(){return this.cachedPosition}render(){const e=this.getPosition(),t=r.classnames(f.classes.scPopover,this.props.className),o=this.props.isVisible&&e?a.react.exports.createElement("div",{className:t,style:e},this.props.children):null;return a.react.exports.createElement("div",{className:"sc-popover-container",ref:this.setPopoverContainerRef},a.react.exports.createElement(Ie,{transitionName:"popover"},o))}}Le.displayName="PopoverComponent";class Ie extends a.react.exports.Component{constructor(e){super(e),this.state={leave:!1,enter:!1,children:null}}cloneChildrenWithClass(e,t){return a.react.exports.cloneElement(e,Object.assign(Object.assign({},e.props),{className:r.classnames(e.props.className,t)}))}UNSAFE_componentWillReceiveProps(e){this.props.children&&!e.children?this.setState({leave:!0,enter:!1,children:this.props.children}):e.children&&!this.props.children&&this.setState({leave:!1,enter:!0})}render(){let e="",t=this.props.children;return this.state.leave&&(e=`${this.props.transitionName}-leave`,this.delayedResetTransitionState(),t=this.state.children),this.state.enter&&(e=`${this.props.transitionName}-enter`,this.delayedResetTransitionState()),t?this.cloneChildrenWithClass(t,e):null}delayedResetTransitionState(){this.resetTransitionStateTimeout&&clearTimeout(this.resetTransitionStateTimeout),this.resetTransitionStateTimeout=setTimeout((()=>{this.setState({leave:!1,enter:!1})}),200)}}Ie.displayName="TransitionGroup";const Pe=({getCustomTitle:e,getCustomMessage:t,shareableResourceName:o,scrollClassName:s,limitedWidth:n},{container:i,scope:l})=>{const c=r.useIntl(),d=a.react.exports.useCallback((e=>{const t=i.getStatus().mentionShareFlow.popupProps,a=t&&t.mentionKey;if(!a)return null;const r=e.querySelectorAll(`[data-entity-key="${a}"]`)[0];return r?r.getBoundingClientRect():null}),[i]),p=a.react.exports.useCallback((()=>{i.getTriggers(l).mentionShareFlow.updatePopupProps(null)}),[i,l]),u=a.react.exports.useCallback((()=>{p();const e=i.getStatus().draft.editorState,t=f.Draft.EditorState.forceSelection(e,e.getSelection());i.getTriggers(l).draft.change(t)}),[p,i,l]),m=a.react.exports.useCallback((()=>{const e=i.getStatus().mentionShareFlow.popupProps;e&&i.getTriggers(l).mentionShareFlow.onShare(e),p()}),[p,i,l]),{popupProps:g}=i.getStatus().mentionShareFlow,h=(_=g)&&_.user?_.user.name.public||_.user.email:_&&"email"===_.mentionData.type?_.mentionData.identifier:"";var _;const v=e?e(c,h,o):c.formatMessage({id:"PPnGE0",defaultMessage:"Share folder with {user_name}?"},{user_name:h}),E=t?t(c,h):c.formatMessage({id:"d8Nac1",defaultMessage:"{user_name} is not yet a member of “{folder_name}”. If you don’t share this folder, they won’t be able to view its content"},{user_name:h,folder_name:o}),C=!!g;return a.react.exports.createElement(Le,{popoverWidth:300,className:f.classes.scMentionSharePopover,scrollClassName:s,limitedWidth:n,computeTargetPosition:d,isVisible:C},a.react.exports.createElement("div",{className:f.classes.popupTitle},v),a.react.exports.createElement("div",{className:f.classes.popupMessage},E),a.react.exports.createElement("div",{className:f.classes.buttonContainer},a.react.exports.createElement(r.Button$1,{className:f.classes.cancelButton,variant:"secondary",onClick:u},c.formatMessage({id:"pv7yxv",defaultMessage:"Cancel"})),a.react.exports.createElement(r.Button$1,{variant:"primary",onClick:m},c.formatMessage({id:"BZwQbv",defaultMessage:"Continue"}))))};var De;Pe.displayName="MentionSharePopover",Pe.contextTypes={container:r.PropTypes.object,scope:r.PropTypes.object},function(e){e.BOLD="BOLD",e.ITALIC="ITALIC",e.STRIKE_THROUGH="STRIKE_THROUGH",e.UNORDERED_LIST="UNORDERED_LIST",e.ORDERED_LIST="ORDERED_LIST",e.LINK="LINK",e.MENTION="MENTION",e.TASK="TASK",e.ONBOARDING="ONBOARDING"}(De||(De={}));const Ae={[De.BOLD]:a.react.exports.createElement("svg",{viewBox:"0 0 20 20"},a.react.exports.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},a.react.exports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.515 5.875H7.875V17.6H12.17C13.3345 17.6 14.425 17.4117 15.2276 16.8818C16.0395 16.3458 16.54 15.4715 16.54 14.145C16.54 12.8378 15.6664 11.7421 14.3952 11.3592C14.8878 11.1875 15.2948 10.9225 15.5958 10.5634C15.9778 10.1079 16.18 9.51165 16.18 8.79C16.18 7.81243 15.767 7.07728 15.0952 6.59064C14.4281 6.10747 13.5147 5.875 12.515 5.875ZM9.52 10.705V7.25H12.44C13.0619 7.25 13.5709 7.38573 13.9217 7.657C14.2673 7.92431 14.475 8.33528 14.475 8.925C14.475 9.62281 14.2109 10.0582 13.8157 10.3252C13.4122 10.5976 12.8562 10.705 12.26 10.705H9.52ZM9.52 16.225V12.11H12.065C12.9643 12.11 13.6581 12.2484 14.1242 12.5562C14.5802 12.8573 14.835 13.3319 14.835 14.055C14.835 14.8889 14.5721 15.4202 14.1281 15.7489C13.6764 16.0833 13.0152 16.225 12.185 16.225H9.52Z"}))),[De.ITALIC]:a.react.exports.createElement("svg",{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},a.react.exports.createElement("path",{d:"M10.75 17.75H9L12.5 5.75H14.25L10.75 17.75Z"})),[De.STRIKE_THROUGH]:a.react.exports.createElement("svg",{viewBox:"0 0 20 20"},a.react.exports.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},a.react.exports.createElement("path",{d:"M10.1060324,10 L8.51882081,10 C8.46159424,9.74866009 8.435,9.48434783 8.435,9.21 C8.435,7.35 9.965,6 12.32,6 C14.75,6 16.01,7.29 16.115,9.24 L14.69,9.24 C14.555,8.115 13.91,7.11 12.305,7.11 C10.745,7.11 9.905,7.995 9.905,9.09 C9.905,9.44281227 9.9693552,9.74481781 10.1060324,10 Z M16.361,13.5 C16.4288,13.7826 16.46,14.088 16.46,14.415 C16.46,16.515 15.035,17.865 12.29,17.865 C9.635,17.865 8.12,16.44 8,14.415 L9.455,14.415 C9.62,15.645 10.475,16.74 12.32,16.74 C14.36,16.74 15.035,15.75 15.035,14.535 C15.035,14.1387272 14.9484809,13.7905206 14.7542791,13.5 L16.361,13.5 Z",id:"S-2"}),a.react.exports.createElement("polygon",{id:"Line-2",fillRule:"nonzero",points:"5 12.5 5 11 20 11 20 12.5"}))),[De.UNORDERED_LIST]:a.react.exports.createElement("svg",{viewBox:"0 0 20 20"},a.react.exports.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},a.react.exports.createElement("path",{d:"M9,17 L9,15.5 L19.5,15.5 L19.5,17 L9,17 Z M9,12.5 L9,11 L19.5,11 L19.5,12.5 L9,12.5 Z M9,8 L9,6.5 L19.5,6.5 L19.5,8 L9,8 Z",id:"Icon-Fill",fillRule:"nonzero"}),a.react.exports.createElement("circle",{id:"Oval-2",cx:"5.5",cy:"7.25",r:"1.5"}),a.react.exports.createElement("circle",{id:"Oval-2",cx:"5.5",cy:"11.75",r:"1.5"}),a.react.exports.createElement("circle",{id:"Oval-2",cx:"5.5",cy:"16.25",r:"1.5"}))),[De.ORDERED_LIST]:a.react.exports.createElement("svg",{viewBox:"0 0 20 20"},a.react.exports.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},a.react.exports.createElement("path",{d:"M9,17 L9,15.5 L19.5,15.5 L19.5,17 L9,17 Z M9,12.5 L9,11 L19.5,11 L19.5,12.5 L9,12.5 Z M9,8 L9,6.5 L19.5,6.5 L19.5,8 L9,8 Z",id:"Icon-Fill",fillRule:"nonzero"}),a.react.exports.createElement("circle",{id:"Oval-2",cx:"5.75",cy:"11.75",r:"1"}),a.react.exports.createElement("text",{id:"1",fontFamily:"AtlasGrotesk-Black, Atlas Grotesk",fontSize:"5px",fontWeight:"700"},a.react.exports.createElement("tspan",{x:"4.42",y:"9"},"1")),a.react.exports.createElement("text",{id:"3",fontFamily:"AtlasGrotesk-Black, Atlas Grotesk",fontSize:"5px",fontWeight:"700"},a.react.exports.createElement("tspan",{x:"3.845",y:"18.25"},"3")))),[De.LINK]:a.react.exports.createElement("svg",{viewBox:"0 0 20 20"},a.react.exports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.5858 13.636L7.93936 13.2825L6.87869 12.2218L6.52514 12.5754C5.15831 13.9422 5.15831 16.1583 6.52514 17.5251C7.89198 18.892 10.1081 18.892 11.4749 17.5251L13.5962 15.4038C14.963 14.037 14.963 11.8209 13.5962 10.4541L12.5355 11.5147C13.3166 12.2958 13.3166 13.5621 12.5355 14.3431L10.4142 16.4645C9.63318 17.2455 8.36685 17.2455 7.5858 16.4645C6.80475 15.6834 6.80475 14.4171 7.5858 13.636ZM16.0711 7.97918C15.29 7.19814 14.0237 7.19814 13.2427 7.97918L11.1213 10.1005C10.3403 10.8816 10.3403 12.1479 11.1213 12.9289L10.0607 13.9896C8.69384 12.6228 8.69384 10.4067 10.0607 9.03985L12.182 6.91852C13.5488 5.55169 15.7649 5.55169 17.1317 6.91852C18.4986 8.28536 18.4986 10.5014 17.1317 11.8683L16.7782 12.2218L15.7175 11.1612L16.0711 10.8076C16.8521 10.0266 16.8521 8.76023 16.0711 7.97918Z"})),[De.MENTION]:a.react.exports.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},a.react.exports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.2598 4.875C10.0768 4.875 8.22867 5.63069 6.92609 6.9456C5.6236 8.26042 4.875 10.1259 4.875 12.3301C4.875 14.6028 5.60277 16.4717 6.91594 17.7725C8.22898 19.0732 10.1151 19.7939 12.4092 19.7939C13.5268 19.7939 14.6046 19.6345 15.4118 19.3565L15.4961 19.3274V17.9357L15.3188 18.0173C15.0586 18.1371 14.6379 18.2405 14.1252 18.3136C13.6152 18.3863 13.0234 18.4277 12.4268 18.4277C10.5731 18.4277 9.06 17.8328 8.01062 16.7866C6.96128 15.7405 6.36426 14.2318 6.36426 12.3828C6.36426 8.78842 8.78499 6.23242 12.1455 6.23242C13.8778 6.23242 15.3272 6.76702 16.3421 7.6823C17.3559 8.59665 17.9443 9.89817 17.9443 11.4512C17.9443 12.5209 17.7678 13.3891 17.4636 13.9849C17.1602 14.5791 16.7408 14.8857 16.25 14.8857C15.957 14.8857 15.7437 14.8027 15.6039 14.6647C15.4643 14.5269 15.3818 14.3185 15.3818 14.0352V8.75098H13.8047V9.70451C13.4001 9.00402 12.6193 8.58398 11.7324 8.58398C10.7944 8.58398 9.99484 8.97403 9.43186 9.6425C8.87017 10.3094 8.54883 11.2471 8.54883 12.3389C8.54883 13.4771 8.86255 14.441 9.42086 15.1229C9.9809 15.8069 10.7811 16.1992 11.7324 16.1992C12.7503 16.1992 13.5568 15.7259 13.9781 14.8715C14.1751 15.7126 14.9989 16.2783 16.0039 16.2783C17.0573 16.2783 17.9207 15.8021 18.5165 14.9576C19.1093 14.1171 19.4336 12.9181 19.4336 11.4688C19.4336 9.52831 18.6973 7.8771 17.4277 6.71186C16.1588 5.54736 14.365 4.875 12.2598 4.875ZM10.2051 12.374C10.2051 11.6217 10.3751 11.0388 10.6739 10.647C10.9693 10.2595 11.3993 10.0469 11.9521 10.0469C12.5136 10.0469 12.967 10.2682 13.2828 10.6625C13.6009 11.0596 13.7871 11.6424 13.7871 12.374C13.7871 13.1053 13.5989 13.6903 13.2775 14.0897C12.9583 14.4864 12.5004 14.71 11.9346 14.71C11.3966 14.71 10.9705 14.4943 10.6754 14.1027C10.3771 13.7071 10.2051 13.1214 10.2051 12.374Z"})),[De.TASK]:a.react.exports.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},a.react.exports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.8 6.5H14.2C15.0648 6.5 15.6232 6.50117 16.0482 6.53589C16.4557 6.56918 16.6068 6.6257 16.681 6.66349C16.9632 6.8073 17.1927 7.03677 17.3365 7.31901C17.3743 7.39318 17.4308 7.54426 17.4641 7.95175C17.4988 8.37676 17.5 8.93517 17.5 9.8V14.2C17.5 15.0648 17.4988 15.6232 17.4641 16.0482C17.4308 16.4557 17.3743 16.6068 17.3365 16.681C17.1927 16.9632 16.9632 17.1927 16.681 17.3365C16.6068 17.3743 16.4557 17.4308 16.0482 17.4641C15.6232 17.4988 15.0648 17.5 14.2 17.5H9.8C8.93517 17.5 8.37676 17.4988 7.95175 17.4641C7.54426 17.4308 7.39318 17.3743 7.31901 17.3365C7.03677 17.1927 6.8073 16.9632 6.66349 16.681C6.6257 16.6068 6.56918 16.4557 6.53589 16.0482C6.50117 15.6232 6.5 15.0648 6.5 14.2V9.8C6.5 8.93517 6.50117 8.37676 6.53589 7.95175C6.56918 7.54426 6.6257 7.39318 6.66349 7.31901C6.8073 7.03677 7.03677 6.8073 7.31901 6.66349C7.39318 6.6257 7.54426 6.56918 7.95175 6.53589C8.37676 6.50117 8.93517 6.5 9.8 6.5ZM5 9.8C5 8.11984 5 7.27976 5.32698 6.63803C5.6146 6.07354 6.07354 5.6146 6.63803 5.32698C7.27976 5 8.11984 5 9.8 5H14.2C15.8802 5 16.7202 5 17.362 5.32698C17.9265 5.6146 18.3854 6.07354 18.673 6.63803C19 7.27976 19 8.11984 19 9.8V14.2C19 15.8802 19 16.7202 18.673 17.362C18.3854 17.9265 17.9265 18.3854 17.362 18.673C16.7202 19 15.8802 19 14.2 19H9.8C8.11984 19 7.27976 19 6.63803 18.673C6.07354 18.3854 5.6146 17.9265 5.32698 17.362C5 16.7202 5 15.8802 5 14.2V9.8ZM11.8047 15.2569L16.2201 9.04361L14.7936 8.02989L10.9883 13.3847L9.27059 11.6089L8.01273 12.8256L10.4626 15.3583C10.6434 15.5453 10.8981 15.6421 11.1575 15.6225C11.4169 15.6029 11.6541 15.4689 11.8047 15.2569Z"})),[De.ONBOARDING]:a.react.exports.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},a.react.exports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.5 9.3951C8.5 7.45942 10.1803 6 12 6C13.8197 6 15.5 7.45942 15.5 9.3951C15.5 10.1162 15.3858 10.5218 15.2719 10.7766C15.154 11.0406 14.9943 11.2449 14.7109 11.567C14.6867 11.5944 14.6611 11.6232 14.6344 11.6534C14.368 11.9536 13.9833 12.3871 13.6745 12.9559C13.4312 13.404 13.2459 13.9082 13.1317 14.5H10.8692C10.7557 13.9057 10.5718 13.3985 10.3317 12.9472C10.0215 12.3642 9.63604 11.9208 9.36525 11.6093L9.36525 11.6093L9.29819 11.532C9.00841 11.1967 8.84514 10.9872 8.72526 10.7222C8.61177 10.4714 8.5 10.0814 8.5 9.3951ZM12 4.5C9.45933 4.5 7 6.52747 7 9.3951C7 11.1702 7.60617 11.8698 8.22154 12.5801C8.79806 13.2455 9.38265 13.9202 9.48444 15.4973C9.50222 15.7729 9.72386 16 10 16H14C14.2761 16 14.4977 15.7728 14.5156 15.4972C14.6167 13.9388 15.192 13.2877 15.7636 12.641C16.3841 11.9389 17 11.242 17 9.3951C17 6.52747 14.5407 4.5 12 4.5ZM9.5 18V17.5H14.5V18C14.5 19 13.108 19.5 12 19.5C10.892 19.5 9.5 19 9.5 18Z",fill:"black"}))},Be=({key:e,intl:t,addAlt:a=!1,isMac:r})=>r?a?t.formatMessage({id:"pZ5e/J",defaultMessage:"⌘ + opt + {key}"},{key:e}):t.formatMessage({id:"3lp5F0",defaultMessage:"⌘ + {key}"},{key:e}):a?t.formatMessage({id:"4OVYKA",defaultMessage:"ctrl + alt + {key}"},{key:e}):t.formatMessage({id:"yi7qcS",defaultMessage:"ctrl + {key}"},{key:e}),Ue=({icon:e})=>Ae[e];Ue.displayName="ToolbarIcon";const je=({message:e,shortcut:t})=>a.react.exports.createElement("div",{className:f.classes.scToolbarButtonTooltipContent},a.react.exports.createElement("div",{className:f.classes.scToolbarButtonTooltipContentMessage},e),t&&a.react.exports.createElement("div",{className:f.classes.scToolbarButtonTooltipContentShortcut},t));je.displayName="TooltipContent";const He=({shortcut:e})=>a.react.exports.createElement("div",null,e);He.displayName="AccelShortcut";const $e=({macro:e})=>{const t=r.useIntl();return a.react.exports.createElement("div",null,a.react.exports.createElement("span",null,e),a.react.exports.createElement("span",null," "),a.react.exports.createElement("span",null,t.formatMessage({id:"u28O+d",defaultMessage:"space"})))};$e.displayName="MacroShortcut";const Ve=()=>a.react.exports.createElement("div",{className:f.classes.toolbarDivider});Ve.displayName="ToolbarDivider";const We=()=>a.react.exports.createElement("div",{className:f.classes.toolbarSpacer});function ze(e,t=""){return r.classnames(f.classes.toolbarButton,{[f.classes.toolbarButtonActive]:e,[t]:!!t})}We.displayName="ToolbarSpacer";const Ke=({triggers:e,isMac:t,active:o})=>{const s=r.useIntl(),n=a.react.exports.useRef(null),[i,l]=a.react.exports.useState(!1),c=a.react.exports.useCallback((t=>{t.stopPropagation(),e.draft.keyCommand("bold")}),[e]),d=a.react.exports.createElement(He,{shortcut:Be({key:"B",intl:s,isMac:t})}),p=a.react.exports.createElement(je,{message:s.formatMessage({id:"fJCjRe",defaultMessage:"Bold"}),shortcut:d});return a.react.exports.createElement("div",{className:ze(o,"toolbar-button-bold"),key:"bold",onClick:c,"aria-label":s.formatMessage({id:"fJCjRe",defaultMessage:"Bold"}),role:"button"},a.react.exports.createElement("div",{onMouseOver:()=>l(!0),onMouseLeave:()=>l(!1),ref:n},a.react.exports.createElement(Ue,{icon:De.BOLD})),a.react.exports.createElement(r.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:i,triggerRef:n},p))};Ke.displayName="ToolbarBoldButton";const qe=({triggers:e,isMac:t,active:o})=>{const s=r.useIntl(),n=a.react.exports.useRef(null),[i,l]=a.react.exports.useState(!1),c=a.react.exports.useCallback((t=>{t.stopPropagation(),e.draft.keyCommand("italic")}),[e]),d=a.react.exports.createElement(He,{shortcut:Be({key:"I",intl:s,isMac:t})}),p=a.react.exports.createElement(je,{message:s.formatMessage({id:"vlkaFK",defaultMessage:"Italic"}),shortcut:d});return a.react.exports.createElement("div",{role:"button","aria-label":s.formatMessage({id:"vlkaFK",defaultMessage:"Italic"}),className:ze(o,"toolbar-button-italic"),key:"italic",onClick:c},a.react.exports.createElement("div",{onMouseOver:()=>l(!0),onMouseLeave:()=>l(!1),ref:n},a.react.exports.createElement(Ue,{icon:De.ITALIC})),a.react.exports.createElement(r.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:i,triggerRef:n},p))};qe.displayName="ToolbarItalicButton";const Ge=({triggers:e,shortcutEnabled:t,isMac:o,active:s,state:n})=>{const i=r.useIntl(),l=a.react.exports.useRef(null),[c,d]=a.react.exports.useState(!1),p=a.react.exports.useCallback((t=>{t.stopPropagation(),e.draft.change(f.Draft.RichUtils.toggleInlineStyle(n,"STRIKETHROUGH"))}),[n,e]),u=t?a.react.exports.createElement(He,{shortcut:Be({key:"S",addAlt:!0,intl:i,isMac:o})}):null,m=a.react.exports.createElement(je,{message:i.formatMessage({id:"UgH/WV",defaultMessage:"Strikethrough"}),shortcut:u});return a.react.exports.createElement("div",{role:"button","aria-label":i.formatMessage({id:"UgH/WV",defaultMessage:"Strikethrough"}),className:ze(s,"toolbar-button-strike-through"),key:"strikethrough",onClick:p},a.react.exports.createElement("div",{onMouseOver:()=>d(!0),onMouseLeave:()=>d(!1),ref:l},a.react.exports.createElement(Ue,{icon:De.STRIKE_THROUGH})),a.react.exports.createElement(r.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:c,triggerRef:l},m))};Ge.displayName="ToolbarStrikeThroughButton";const Ye=({state:e,active:t,triggers:o})=>{const s=r.useIntl(),n=a.react.exports.useRef(null),[i,l]=a.react.exports.useState(!1),c=a.react.exports.useCallback((t=>{t.stopPropagation(),o.draft.change(f.Draft.RichUtils.toggleBlockType(e,"unordered-list-item"))}),[e,o]),d=a.react.exports.createElement(je,{message:s.formatMessage({id:"QVI2zd",defaultMessage:"Start bulleted list"}),shortcut:a.react.exports.createElement($e,{macro:"-"})});return a.react.exports.createElement("div",{role:"button","aria-label":s.formatMessage({id:"QVI2zd",defaultMessage:"Start bulleted list"}),className:ze(t,"toolbar-button-unordered-list"),key:"ul",onClick:c},a.react.exports.createElement("div",{onMouseOver:()=>l(!0),onMouseLeave:()=>l(!1),ref:n},a.react.exports.createElement(Ue,{icon:De.UNORDERED_LIST})),a.react.exports.createElement(r.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:i,triggerRef:n},d))};Ye.displayName="ToolbarUnorderedListButton";const Ze=({state:e,triggers:t,active:o})=>{const s=r.useIntl(),n=a.react.exports.useRef(null),[i,l]=a.react.exports.useState(!1),c=a.react.exports.useCallback((a=>{a.stopPropagation(),t.draft.change(f.Draft.RichUtils.toggleBlockType(e,"ordered-list-item"))}),[e,t]),d=a.react.exports.createElement(je,{message:s.formatMessage({id:"qBpbaD",defaultMessage:"Start numbered list"}),shortcut:a.react.exports.createElement($e,{macro:"1."})});return a.react.exports.createElement("div",{role:"button","aria-label":s.formatMessage({id:"qBpbaD",defaultMessage:"Start numbered list"}),className:ze(o,"toolbar-button-ordered-list"),key:"ol",onClick:c},a.react.exports.createElement("div",{onMouseOver:()=>l(!0),onMouseLeave:()=>l(!1),ref:n},a.react.exports.createElement(Ue,{icon:De.UNORDERED_LIST})),a.react.exports.createElement(r.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:i,triggerRef:n},d))};Ze.displayName="ToolbarOrderedListButton";const Qe=({triggers:e,active:t})=>{const o=r.useIntl(),s=a.react.exports.useRef(null),[n,i]=a.react.exports.useState(!1),l=a.react.exports.useCallback((t=>{t.stopPropagation(),e.draft.insertMacro("@")}),[e]),c=a.react.exports.createElement(je,{message:o.formatMessage({id:"6elmWe",defaultMessage:"Mention someone"}),shortcut:o.formatMessage({id:"fN3cwA",defaultMessage:"@someone"})});return a.react.exports.createElement("div",{role:"button","aria-label":o.formatMessage({id:"6elmWe",defaultMessage:"Mention someone"}),className:ze(t,"toolbar-button-mention"),key:"mention",onClick:l},a.react.exports.createElement("div",{onMouseOver:()=>i(!0),onMouseLeave:()=>i(!1),ref:s},a.react.exports.createElement(Ue,{icon:De.MENTION})),a.react.exports.createElement(r.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:n,triggerRef:s},c))};Qe.displayName="ToolbarMentionButton";const Je=({onDone:e,active:t})=>{const o=r.useIntl();return a.react.exports.createElement("div",{role:"button","aria-label":o.formatMessage({id:"HGK/k8",defaultMessage:"Done"}),className:ze(t,f.classes.toolbarButtonDone),key:"done",onClick:e},o.formatMessage({id:"HGK/k8",defaultMessage:"Done"}))};Je.displayName="ToolbarDoneButton";const Xe=({active:e,triggers:t})=>{const o=r.useIntl(),s=a.react.exports.useRef(null),[n,i]=a.react.exports.useState(!1),l=a.react.exports.useCallback((e=>{t.task.toggleTaskBlock(null),e.stopPropagation()}),[t]),c=a.react.exports.createElement(je,{message:o.formatMessage({id:"ALfhls",defaultMessage:"Create to-do"}),shortcut:a.react.exports.createElement($e,{macro:"[]"})});return a.react.exports.createElement("div",{role:"button","aria-label":o.formatMessage({id:"ALfhls",defaultMessage:"Create to-do"}),className:ze(e,"toolbar-button-task"),key:"task",onClick:l},a.react.exports.createElement("div",{onMouseOver:()=>i(!0),onMouseLeave:()=>i(!1),ref:s},a.react.exports.createElement(Ue,{icon:De.TASK})),a.react.exports.createElement(r.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:n,triggerRef:s},c))};Xe.displayName="ToolbarTaskButton";const et=({active:e,onClick:t,shortcutEnabled:o,isMac:s})=>{const n=r.useIntl(),i=a.react.exports.useRef(null),[l,c]=a.react.exports.useState(!1),d=o?a.react.exports.createElement(He,{shortcut:Be({key:"K",intl:n,isMac:s})}):null,p=a.react.exports.createElement(je,{message:n.formatMessage({id:"WMGEFi",defaultMessage:"Create link"}),shortcut:d});return a.react.exports.createElement("div",{role:"button","aria-label":n.formatMessage({id:"WMGEFi",defaultMessage:"Create link"}),className:ze(e,"toolbar-button-link"),key:"link",onClick:t},a.react.exports.createElement("div",{onMouseOver:()=>c(!0),onMouseLeave:()=>c(!1),ref:i},a.react.exports.createElement(Ue,{icon:De.LINK})),a.react.exports.createElement(r.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:l,triggerRef:i},p))};et.displayName="ToolbarOpenLinkButton";const tt=({children:e})=>{const t=r.useIntl(),o=a.react.exports.useCallback((e=>{e.stopPropagation(),e.preventDefault()}),[]);return a.react.exports.createElement("div",{className:f.classes.scToolbarComponent,role:"group","aria-label":t.formatMessage({id:"El6O0Q",defaultMessage:"toolbar"}),onMouseDown:o,key:"toolbar"},e)};tt.displayName="ToolbarComponent";const at=({focusEditor:e},{container:t,scope:r})=>{const o=a.react.exports.useRef(),s=a.react.exports.useCallback((e=>{var a;(null===(a=o.current)||void 0===a?void 0:a.contains(null==e?void 0:e.target))||t.getTriggers(r).hyperlink.updateLinkPromptProps(null)}),[t,r]);a.react.exports.useEffect((()=>(document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s))),[s]);const n=a.react.exports.useCallback((a=>{e(),t.getTriggers(r).hyperlink.createLink(a)}),[t,r,e]),i=a.react.exports.useCallback((e=>{o.current=e}),[]),l=t.getStatus().hyperlink.linkPromptProps;return a.react.exports.createElement(rt,{onSubmit:n,linkProps:l,containerRef:i})};at.displayName="LinkPromptComponent",at.contextTypes={container:r.PropTypes.object,scope:r.PropTypes.object};class rt extends a.react.exports.Component{constructor(e){super(e),this.inputRef=null,this.onEnterKey=e=>{13===(e.which||e.keyCode)&&this.canSubmit()&&(e.stopPropagation(),e.preventDefault(),this.props.onSubmit(this.state.inputValue))},this.onInputChange=e=>{this.setState({inputValue:e.currentTarget.value})},this.onCreateButtonClick=e=>{this.canSubmit()&&(this.props.onSubmit(this.state.inputValue),e.stopPropagation())},this.canSubmit=()=>!!this.state.inputValue,this.setInputRef=e=>{this.inputRef=e},this.state={inputValue:""}}UNSAFE_componentWillUpdate(e){const t=!!this.props.linkProps,a=!!e.linkProps;!t&&a&&this.componentWillShow()}componentDidUpdate(e){const t=!!this.props.linkProps,a=!!e.linkProps;t&&!a&&this.componentDidShow()}componentWillShow(){this.setState({inputValue:""})}componentDidShow(){this.inputRef&&this.inputRef.focus()}render(){if(!this.props.linkProps)return null;const{top:e,left:t}=this.props.linkProps,o={top:e,left:t};return a.react.exports.createElement("div",{className:f.classes.scLinkPrompt,style:o,ref:this.props.containerRef,key:"linkprompt"},a.react.exports.createElement("input",{className:f.classes.linkPromptInput,ref:this.setInputRef,onKeyPress:this.onEnterKey,placeholder:"Enter link URL",value:this.state.inputValue,onChange:this.onInputChange}),a.react.exports.createElement(r.Button,{className:f.classes.submitButton,variant:"opacity",size:"small",disabled:!this.canSubmit(),onClick:this.onCreateButtonClick},"Create"))}}rt.displayName="LinkPromptInput";const ot=({isVisible:e,getScrollContainerEl:t,toolbarHeightWithMargin:o,toolbarTopMargin:s,getEditorContainerEl:n,triggers:i,activeFormatting:l,editorState:c,isMac:d,limitedWidth:p,onDone:u,focusEditor:m})=>{var g;const h=a.react.exports.useRef(),[_,v]=a.react.exports.useState({toolbarScrollState:"scroll",top:0,left:0,width:0}),E=a.react.exports.useCallback((()=>{var e;return"HTML"===(null===(e=h.current)||void 0===e?void 0:e.nodeName)}),[]),C=a.react.exports.useCallback((()=>{const e=n();if(!e)return;const t=e.getBoundingClientRect(),a=E()||!h.current?0:h.current.getBoundingClientRect().top,r=((e,t,a,r,o)=>{let s="scroll";const n=a-r;return n>o-e?s="hide":n+t>0&&(s="dock"),s})(o,s,a,t.top,t.height);v({toolbarScrollState:r,top:a+s,left:t.left,width:t.width})}),[n,E,s,o]),S=a.react.exports.useCallback((()=>{e&&h.current&&C()}),[e,C]);a.react.exports.useEffect((()=>(e&&x(),()=>{h.current&&h.current.removeEventListener("scroll",S)})),[e]);const x=a.react.exports.useCallback((()=>{h.current=null==t?void 0:t(),E()?(document.removeEventListener("scroll",S),document.addEventListener("scroll",S)):h.current&&(h.current.removeEventListener("scroll",S),h.current.addEventListener("scroll",S)),C()}),[C,S,E,t]),b=a.react.exports.useCallback((e=>{i.hyperlink.updateLinkPromptProps({top:0,left:0}),e.preventDefault(),e.stopPropagation()}),[i]),y="dock"===_.toolbarScrollState,k=e&&"hide"!==_.toolbarScrollState,T=y?{top:_.top,left:_.left,position:"fixed",width:_.width}:{},w=r.classnames(f.classes.scFolderOverviewFixedToolbar,{[f.classes.docked]:y,"limited-width":p}),M=a.react.exports.createElement("div",{className:w,style:T},a.react.exports.createElement(tt,null,a.react.exports.createElement(Ke,{active:l.bold,triggers:{draft:i.draft},isMac:d}),a.react.exports.createElement(qe,{active:l.italic,triggers:{draft:i.draft},isMac:d}),a.react.exports.createElement(Ge,{active:l.strikethrough,shortcutEnabled:!0,state:c,triggers:{draft:i.draft},isMac:d}),a.react.exports.createElement(et,{shortcutEnabled:!0,onClick:b,isMac:d}),!p&&a.react.exports.createElement(Ve,{key:"-1"}),a.react.exports.createElement(Xe,{active:l.task,triggers:{draft:i.draft,task:i.task}}),a.react.exports.createElement(Ye,{active:l.unorderedList,state:c,triggers:{draft:i.draft}}),a.react.exports.createElement(Ze,{active:l.orderedList,state:c,triggers:{draft:i.draft}}),a.react.exports.createElement(Qe,{triggers:{draft:i.draft}}),!p&&a.react.exports.createElement(a.react.exports.Fragment,null,a.react.exports.createElement(We,{key:"-"}),",",a.react.exports.createElement(Ve,{key:"-2"}),",",a.react.exports.createElement(Je,{onDone:u}),","),a.react.exports.createElement(at,{focusEditor:m}))),R=h&&(null===(g=h.current)||void 0===g?void 0:g.offsetParent)?h.current.offsetParent:document.body,F=y&&h&&R?a.reactDom.exports.createPortal(M,R):M;return k?a.react.exports.createElement("span",null,F):null};ot.displayName="FixedToolbarElement";const st=(e,{container:t,scope:r})=>{const o=t.getStatus(),{fixedToolbar:{activeFormatting:s},draft:{editorState:n}}=o,i=we(o);return a.react.exports.createElement(ot,Object.assign({activeFormatting:s,editorState:n,isVisible:i,triggers:t.getTriggers(r)},e))};st.displayName="FixedToolbarComponent",st.contextTypes={container:r.PropTypes.object,scope:r.PropTypes.object};const nt={id:"FOLDER_OVERVIEW_MENTION_MATCHES_PLACEHOLDER",defaultMessage:"@mention someone to share this Space with them.",description:"Placeholder message in suggestions dropdown when user starts mention in Space overview editor"},it=(e,t,a)=>e.formatMessage({id:"FOLDER_OR_FILE_OVERVIEW_MENTION_POPOVER_TITLE",defaultMessage:"Share “{shareable_resource_name}” with {user_name}?"},{shareable_resource_name:a,user_name:t}),lt=(e,t)=>e.formatMessage({id:"FOLDER_OVERVIEW_MENTION_POPOVER_MESSAGE",defaultMessage:"Share this folder with {user_name} so they can view its overview."},{user_name:t}),ct=(e,t)=>e.formatMessage({id:"FILE_OVERVIEW_MENTION_POPOVER_MESSAGE",defaultMessage:"Share this file with {user_name} so they can view its overview."},{user_name:t});class dt extends a.react.exports.Component{constructor(){super(...arguments),this.editorContainerRef=a.react.exports.createRef(),this.awaitingMouseUp=!1,this.getEditorContainerRef=()=>this.editorContainerRef.current,this.setEditorRef=e=>{var t,a;null===(a=(t=this.props).setEditorRef)||void 0===a||a.call(t,e),this.editorRef=e},this.blurEditor=()=>{var e;null===(e=this.editorRef)||void 0===e||e.blur()},this.focusEditor=()=>{var e;null===(e=this.editorRef)||void 0===e||e.focus()},this.dismissToolbar=()=>{this.focusEditor(),this.blurEditor(),this.props.onToolbarDone&&this.props.onToolbarDone()},this.handleFocus=e=>{if("mousedown"===e.type)return this.awaitingMouseUp=!0,!1;if("mouseup"===e.type)this.awaitingMouseUp=!1;else if("focus"===e.type)return!this.awaitingMouseUp;return!0},this.customKeyBinding=e=>{const{isMac:t}=this.props,a=t&&e.metaKey||!t&&e.ctrlKey;switch(e.keyCode){case 83:return a&&e.altKey?"strikethrough":null;case 75:return a&&!e.altKey?"create-link":null;default:return f.Draft.getDefaultKeyBinding(e)}}}renderDraftEditor(){const{annotation:e,intl:t,placeholder:r}=this.props,o=Object.assign({spellCheck:!0,a11yEditorLabel:t.formatMessage({id:"Nv8qgA",defaultMessage:"Type notes, list, to-dos, and links here"}),annotation:e,shouldFocus:this.props.shouldFocus,customKeyBinding:this.customKeyBinding,handleFocus:this.handleFocus,placeholder:r,className:f.classes.scFolderOverviewDraft},f.DraftComponent.defaultProps);return a.react.exports.createElement(f.DraftComponent,Object.assign({},o,{setRef:this.setEditorRef}))}render(){const{className:e,readOnly:t,shareableResourceName:o,limitedWidth:s,getToolbarScrollContainerEl:i,hideAllToolbars:l,isFileOverview:c,isMac:d,intl:p}=this.props,u="number"==typeof this.props.toolbarHeightWithMargin?this.props.toolbarHeightWithMargin:48,m=f.classes.scFolderOverviewInteractionContainer,g=r.classnames(e,f.classes.scFolderOverviewEditor,{[f.classes.folderOverviewLimitedWidth]:!!s});return a.react.exports.createElement(n.Provider,{value:p},a.react.exports.createElement("div",{className:g,ref:this.editorContainerRef},a.react.exports.createElement(Ne,Object.assign({},this.props),a.react.exports.createElement(Oe,{className:"sc-folder-overview-inner"},a.react.exports.createElement("div",{className:m},!l&&a.react.exports.createElement(st,{limitedWidth:!!s,toolbarHeightWithMargin:u,toolbarTopMargin:this.props.toolbarTopMargin||0,onDone:this.dismissToolbar,focusEditor:this.focusEditor,getEditorContainerEl:this.getEditorContainerRef,getScrollContainerEl:i,isMac:d}),this.renderDraftEditor(),!t&&a.react.exports.createElement("div",null,a.react.exports.createElement(f.ActiveMacroChromeComponent,{scrollClassName:m,placeholderMessage:c?void 0:nt}),o&&a.react.exports.createElement(Pe,{scrollClassName:m,limitedWidth:s,shareableResourceName:o,getCustomTitle:it,getCustomMessage:c?ct:lt})))))))}}dt.displayName="FolderOverviewEditor";const pt=()=>a.React$1.createElement("div",{className:"folder-overview__description--placeholder"},a.React$1.createElement("span",null,h.DESCRIPTION_PLACEHOLDER_RIGHT_RAIL)),ut={addLoadedComponent:h.addLoadedComponent,updateFolderData:h.updateFolderDataCache,saveDescriptionDraft:h.saveDescriptionDraft,setDescriptionHasFocus:h.setDescriptionHasFocus};class mt extends a.React$1.PureComponent{constructor(e){super(e),this.linkPromptHasFocus=()=>!(!document.activeElement||"link-prompt-input"!==document.activeElement.className),this.immediatelySaveDescriptionDraft=()=>{this.delayedSaveDescriptionDraft.cancel(),this.throttledUpdateDescription.cancel(),this.handleDescriptionUpdated(),this.saveDescriptionDraft()},this.saveDescriptionDraft=()=>{const{hasUnsavedDraft:e,saveDescriptionDraft:t,folderFileId:a,componentNamespace:o,user:s}=this.props;e&&(t({folderFileId:a,componentNamespace:o}),h.logFolderOverviewAction(r.WebUserActionLogEvent.FOLDER_OVERVIEW_DESCRIPTION_SAVE,s.id,null,{action_surface:this.loggingActionSurface,retrieval_source:this.loggingRetrievalSource}))},this.handleBeforeUnload=e=>{this.immediatelySaveDescriptionDraft(),this.props.hasUnsavedDraft&&(e.preventDefault(),e.returnValue="")},this.handleDescriptionMention=e=>"email"===e.type&&e.identifier===this.props.user.email||"id"===e.type&&e.identifier===this.props.user.id.toString()?Promise.resolve({mentionedUserHasAccess:!0,shouldShowSharePopup:!1}):this.props.user.cdm_tmf_path&&r.paths_are_equal(this.props.user.cdm_tmf_path,this.props.path)?(r.Snackbar.fail(h.ERROR_SHARE_MEMBER_FOLDER,"folder-overview-mention"),Promise.resolve({mentionedUserHasAccess:!1,shouldShowSharePopup:!1})):h.getFolderAccess({userId:this.props.user.id,sharedFolderId:this.props.sharedFolderId,accountEmail:"email"===e.type?e.identifier:void 0,accountId:"id"===e.type?e.identifier:void 0}).then((e=>({mentionedUserHasAccess:e.has_access,shouldShowSharePopup:!e.has_access}))).catch((e=>{const t=this.props.canShareFolder;return t||r.Snackbar.fail(h.ERROR_SHARE_NO_PERMISSION,"folder-overview-mention"),{mentionedUserHasAccess:!1,shouldShowSharePopup:t}})),this.handleDescriptionShare=(e,t,a,o)=>{E.asyncShowPrefilledShareModal({user:this.props.user,sharePrefillEmails:[e.identifier],content:{fqPath:this.props.sharedFolderPath,isFolder:!0},extras:{onSuccessSharing:()=>{this.handleDescriptionMention(e).then((({mentionedUserHasAccess:e})=>e&&o()))},recipientMessage:this.generateShareMessage(t),origin:r.SHARE_ACTION_ORIGIN_TYPE.GRANT_ACCESS}})},this.generateShareMessage=e=>this.props.sharedFolderPath&&!r.paths_are_equal(this.props.sharedFolderPath,this.props.path)?e&&e.length?n.intl.formatMessage(h.SHARING_MODAL_MESSAGE_PARENT_FOLDER,{user_name:e,folder_name:r.pathFromSharingFolder(this.props.sharedFolderPath,this.props.path)}):n.intl.formatMessage(h.SHARING_MODAL_MESSAGE_PARENT_FOLDER_NO_NAME,{folder_name:r.pathFromSharingFolder(this.props.sharedFolderPath,this.props.path)}):e&&e.length?n.intl.formatMessage(h.SHARING_MODAL_MESSAGE_SAME_FOLDER,{user_name:e}):h.SHARING_MODAL_MESSAGE_SAME_FOLDER_NO_NAME,this.stateFromProps=e=>{try{return{editorState:e.content?f.Draft.EditorState.createWithContent(f.Draft.convertFromRaw(e.content)):f.Draft.EditorState.createEmpty()}}catch(t){return S.reportException({err:t,tags:["folder-overview","browse"],severity:"user-error",exc_extra:{description:e.content}}),{editorState:f.Draft.EditorState.createEmpty()}}},this.handleDescriptionUpdated=()=>{let e;const t=f.Draft.convertToRaw(this.state.editorState.getCurrentContent()),a=r.isEmptyDescription(t);!this.props.content&&a||(e=t),this.props.updateFolderData({fileId:this.props.folderFileId,folderData:{descriptionDraft:e&&!a?JSON.stringify(e):""}}),this.delayedSaveDescriptionDraft()},this.handleEditorStateChange=e=>{if(this.props.isReadOnly)return;const t=e.getSelection().getHasFocus()||this.linkPromptHasFocus(),a=this.props.descriptionHasFocus,r=this.state.editorState.getCurrentContent()!==e.getCurrentContent();this.props.setDescriptionHasFocus({componentNamespace:this.props.componentNamespace,descriptionHasFocus:t,folderFileId:this.props.folderFileId}),this.setState({editorState:e}),!t&&a?this.immediatelySaveDescriptionDraft():r&&this.throttledUpdateDescription()},this.handleOpenLink=e=>{r.safe_open_tab_and_redirect(e)},this.handleMentionsQueryUpdated=e=>{this.mentionsApi&&(e.trim().length?this.mentionsApi.query(e,(e=>{this.setState({mentionsQueryCache:this.fixNamesForMentionsQueryCache(e)})})):this.setState({mentionsQueryCache:this.fixNamesForMentionsQueryCache(this.mentionsApi.getMatchesWithStarterSuggestions())}))},this.fixNamesForMentionsQueryCache=e=>{const t={};return Object.keys(e).forEach((a=>{t[a]=e[a].map((e=>Object.assign(Object.assign({},e),{name:Object.assign(Object.assign({},e.name),{public:e.name.display||e.name.public})})))})),t},this.handleShare=(e,t,a)=>{const r=e.identifier;this.handleDescriptionShare(e,this.getNameFromMentionsCache(r),t,a)},this.getNameFromMentionsCache=e=>{const t=Object.keys(this.state.mentionsQueryCache);for(const a of t)for(const t of this.state.mentionsQueryCache[a])if(t.email===e)return t.name.display;return""},this.shouldShowPlaceholder=()=>{if(this.props.shouldHidePlaceholder)return!1;const{editorState:e}=this.state,t=e.getCurrentContent();return!t.hasText()&&"unstyled"===t.getFirstBlock().getType()&&!e.getSelection().getHasFocus()},this.setEditorRef=e=>{this.editorRef=e},this.handlePlaceholderContainerClick=e=>{var t;e.preventDefault(),e.stopPropagation(),null===(t=this.editorRef)||void 0===t||t.focus()},this.getToolbarScrollContainerEl=()=>null,this.handleTaskChecked=(e,t)=>{this.props.setDescriptionHasFocus({componentNamespace:this.props.componentNamespace,descriptionHasFocus:!0,folderFileId:this.props.folderFileId}),t&&h.logFolderOverviewAction(r.WebUserActionLogEvent.FOLDER_OVERVIEW_TASK_COMPLETED,this.props.user.id,null,h.makeOverviewResourceExtras({folderFileId:this.props.folderFileId,retrievalSource:this.loggingRetrievalSource,action_surface:this.loggingActionSurface,loggingFileId:this.props.loggingFileId})),this.immediatelySaveDescriptionDraft()},this.state=this.stateFromProps(e),this.delayedSaveDescriptionDraft=x.debounce(this.saveDescriptionDraft,h.DESCRIPTION_SAVE_DELAY_MS),this.throttledUpdateDescription=x.throttle(this.handleDescriptionUpdated,100),e.isReadOnly||(this.mentionsApi=u.mentionsApi(e.user,!0))}componentDidMount(){this.props.addLoadedComponent({componentNamespace:this.props.componentNamespace,component:"draftjs"}),window.addEventListener("beforeunload",this.handleBeforeUnload)}UNSAFE_componentWillReceiveProps(e){(!r.paths_are_equal(e.path,this.props.path)&&(e.folderFileId||e.folderNsId)||!this.props.folderNsId&&!this.props.folderFileId&&e.folderNsId)&&this.immediatelySaveDescriptionDraft(),e.descriptionKey===this.props.descriptionKey||this.state.editorState.getSelection().getHasFocus()||this.linkPromptHasFocus()||this.setState(this.stateFromProps(e)),this.mentionsApi||e.isReadOnly||(this.mentionsApi=u.mentionsApi(this.props.user))}componentWillUnmount(){window.removeEventListener("beforeunload",this.handleBeforeUnload),this.props.hasUnsavedDraft&&this.immediatelySaveDescriptionDraft()}get loggingRetrievalSource(){return"search-sidebar"===this.props.componentNamespace?r.RetrievalSourceValue.SEARCH:r.RetrievalSourceValue.BROWSE}get loggingActionSurface(){return"BROWSE"===this.props.componentNamespace?r.ActionSurfaceLogValue.CENTER_PANE:r.ActionSurfaceLogValue.RIGHT_SIDEBAR}render(){const{isReadOnly:e,author:t}=this.props,{editorState:o}=this.state,s=this.shouldShowPlaceholder();return a.React$1.createElement("div",{className:"folder-overview__description-container"},e&&a.React$1.createElement(v.IconAction,{name:"permissions",className:"folder-overview__inline-readonly-icon"}),a.React$1.createElement("div",{className:r.classnames("folder-overview__fixed-toolbar",{"folder-overview__description":!0,"folder-overview__placeholder":s}),onClick:s?this.handlePlaceholderContainerClick:x.noop},s&&!e&&a.React$1.createElement(pt,null),a.React$1.createElement(dt,{author:t,intl:n.intl,editorState:o,readOnly:e,onEditorStateChange:this.handleEditorStateChange,onOpenLink:this.handleOpenLink,onMentionsQueryUpdated:this.handleMentionsQueryUpdated,mentionShareFlowHandlers:{onMention:this.handleDescriptionMention,onShare:this.handleShare},mentionsMatches:this.state.mentionsQueryCache,shareableResourceName:this.props.sharedFolderName,setEditorRef:this.setEditorRef,getToolbarScrollContainerEl:this.getToolbarScrollContainerEl,limitedWidth:!0,toolbarHeightWithMargin:0,toolbarTopMargin:this.props.toolbarTopMargin,isMac:C.mac,hideAllToolbars:C.iOS||this.props.hideAllToolbars,onTaskChecked:this.handleTaskChecked})))}}mt.displayName="FolderOverviewDescriptionComponent";const gt=r.connect((()=>{const e=h.makeSharedFolderPathSelector(),t=h.makeFolderFileIdSelector(),a=h.makeFolderNsIdSelector(),r=h.makeSharedFolderIdSelector(),o=h.makeDescriptionContentSelector(),s=h.makeLoggingFileIdSelector(),n=h.makeDescriptionHasFocusSelector(),i=h.makeSharedFolderNameSelector(),l=h.makeHasUnsavedDescriptionDraftSelector();return(c,d)=>({user:h.user(c),author:h.descriptionAuthorSelector(c),folderFileId:t(c,d),folderNsId:a(c,d),sharedFolderId:r(c,d),sharedFolderPath:e(c,d),content:o(c,d),sharedFolderName:i(c,d),hasUnsavedDraft:l(c,d),descriptionHasFocus:n(c,d),loggingFileId:s(c,d)})}),ut)(mt);function ht(){return a.React$1.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.React$1.createElement("g",{clipPath:"url(#clip0)"},a.React$1.createElement("circle",{cx:"8",cy:"7.5",r:"6.25",stroke:"#A5A9AF",strokeWidth:"1.5"}),a.React$1.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.5 4H7V7V7.5V8.5H11V7H8.5V4Z",fill:"#A5A9AF"})),a.React$1.createElement("defs",null,a.React$1.createElement("clipPath",{id:"clip0"},a.React$1.createElement("rect",{width:"16",height:"16",fill:"white"}))))}function ft(){return a.React$1.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.React$1.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20 12C20 16.4183 16.4183 20 12 20C7.58172 20 4 16.4183 4 12C4 7.58172 7.58172 4 12 4C16.4183 4 20 7.58172 20 12ZM11.25 12.75L11 8.2501L13 8.25L12.75 12.75H11.25ZM11.0001 14.75C11.0001 14.1977 11.4478 13.75 12.0001 13.75C12.5524 13.75 13.0001 14.1977 13.0001 14.75C13.0001 15.3023 12.5524 15.75 12.0001 15.75C11.4478 15.75 11.0001 15.3023 11.0001 14.75Z",fill:"#FF8E21"}))}class _t extends a.React$1.PureComponent{constructor(e){super(e),this.renderAvatar=(e,t)=>{const r=e.toUpperCase(),o=t?a.React$1.createElement(b.Avatar,{size:40,src:t,variant:"normal"}):a.React$1.createElement(b.AvatarInitials,{avatarSize:40,backgroundColor:y.avatarColorForUserIdentifier(r),variant:"normal"},r);return a.React$1.createElement("div",{className:"cb-last-edit__avatar-wrapper"},a.React$1.createElement("div",{className:"cb-last-edit__avatar-clipping-circle"}),a.React$1.createElement(ft,null),o)}}renderConflictPopover(){const{conflictPopup:e}=this.props;if(!e)return null;const{title:t,message:o,dismissButtonLabel:s,userInitials:n,userPhotoUrl:i,onDismissHandler:l,position:c,popoverContentRef:d}=e;return a.React$1.createElement(k.Popover,{className:"cb-conflict-popover"},a.React$1.createElement(k.PopoverContent,{className:"cb-conflict-popover-content",position:c,isRevealed:!0},a.React$1.createElement(a.React$1.Fragment,null,a.React$1.createElement("div",{className:"cb-conflict-popover-content__inner-wrapper",ref:d,tabIndex:-1},this.renderAvatar(n,i),a.React$1.createElement("div",{className:"cb-conflict-popover__text-wrapper"},a.React$1.createElement("div",{className:"cb-conflict-popover__title"},t),a.React$1.createElement("div",{className:"cb-conflict-popover__message"},o))),a.React$1.createElement(r.Button$1,{className:"cb-conflict-popover__dismiss-button",variant:"secondary",onClick:l},s))))}render(){const{lastEditMessage:e,userEditingMessage:t,isEditorFocused:r}=this.props,o=!!t&&r;return a.React$1.createElement("div",{className:"cb-last-edit"},a.React$1.createElement("div",{className:"cb-last-edit__message-wrapper"},!o&&a.React$1.createElement(ht,null),a.React$1.createElement("div",{className:"cb-last-edit__message"},o?t:e)),this.renderConflictPopover())}}_t.displayName="LastEditComponent";const vt={reloadDescription:h.reloadDescription};class Et extends a.React$1.PureComponent{constructor(e){super(e),this.stateFromProps=(e=this.props)=>({message:this.createMessage(e),conflictPopup:this.createConflictPopup(e)}),this.onTimeout=()=>{this.setState(this.stateFromProps()),this.updateTimer=setTimeout(this.onTimeout,3e4)},this.createMessage=e=>{if(!e.lastModifiedTime||e.isFolderOverviewEmpty)return"";const t=r.ago(1e3*e.lastModifiedTime,!1);return e.isFolderOverviewEmpty?e.lastModifiedUserId===e.user.account_id?n.intl.formatMessage(h.DESCRIPTION_LAST_EDIT_EMPTY_YOU,{time_ago:t}):e.lastModifiedUser?n.intl.formatMessage(h.DESCRIPTION_LAST_EDIT_EMPTY,{time_ago:t,name:e.lastModifiedUser.name.display_name}):"":e.lastModifiedUserId===e.user.account_id?n.intl.formatMessage(h.DESCRIPTION_LAST_EDIT_YOU,{time_ago:t}):e.lastModifiedUser?n.intl.formatMessage(h.DESCRIPTION_LAST_EDIT,{time_ago:t,name:e.lastModifiedUser.name.display_name}):""},this.handleLastEditDismiss=()=>{this.props.reloadDescription({folderFileId:this.props.folderFileId,componentNamespace:this.props.componentNamespace})},this.createConflictPopup=e=>{if(e.descriptionSaveState===r.DescriptionSaveState.CONFLICT){if(e.lastModifiedUserId===e.user.account_id)return{title:h.CONFLICT_POPUP_TITLE_YOU,message:h.CONFLICT_POPUP_CONTENT_YOU,dismissButtonLabel:h.CONFLICT_POPUP_BUTTON,onDismissHandler:this.handleLastEditDismiss,userInitials:r.userInitials(e.user),userPhotoUrl:e.user.photo_url};if(e.lastModifiedUser)return{title:n.intl.formatMessage(h.CONFLICT_POPUP_TITLE,{user:e.lastModifiedUser.name.display_name}),message:h.CONFLICT_POPUP_CONTENT,dismissButtonLabel:h.CONFLICT_POPUP_BUTTON,onDismissHandler:this.handleLastEditDismiss,userInitials:r.userInitials(e.lastModifiedUser),userPhotoUrl:e.lastModifiedUser.profile_photo_url}}},this.state=this.stateFromProps(e)}componentDidMount(){this.updateTimer=setTimeout(this.onTimeout,3e4)}componentWillUnmount(){clearTimeout(this.updateTimer)}UNSAFE_componentWillReceiveProps(e){this.setState(this.stateFromProps(e))}render(){return!this.state.message||this.props.descriptionHasFocus?null:a.React$1.createElement(_t,{lastEditMessage:this.state.message,conflictPopup:this.state.conflictPopup,isEditorFocused:this.props.descriptionHasFocus,userEditingMessage:h.FOLDER_OVERVIEW_EDITOR_EDITING})}}Et.displayName="FolderOverviewLastEditComponent";const Ct=r.connect((()=>{const e=h.makeFolderFileIdSelector(),t=h.makeLastModifiedTimeSelector(),a=h.makeLastModifiedUserSelector(),r=h.makeLastModifiedUserIdSelector(),o=h.makeDescriptionSaveStateSelector(),s=h.makeIsFolderOverviewEmptySelector(),n=h.makeDescriptionHasFocusSelector();return(i,l)=>({user:h.user(i),folderFileId:e(i,l),lastModifiedTime:t(i,l),lastModifiedUser:a(i,l),lastModifiedUserId:r(i,l),descriptionSaveState:o(i,l),isFolderOverviewEmpty:s(i,l),descriptionHasFocus:n(i,l)})}),vt)(r.requireCssWithComponent(Et,["/static/typescript/component_libraries/spaces-components/src/index-vflqS-4WW.css"])),St={fetchDataForFolder:h.fetchDataForFolder,reloadDescription:h.reloadDescription};class xt extends a.React$1.PureComponent{constructor(){super(...arguments),this.handleLiveUpdate=({type:e})=>{"description"===e&&this.props.reloadDescription({folderFileId:this.props.folderFileId,componentNamespace:this.props.componentNamespace})}}componentDidMount(){this.props.fetchDataForFolder({path:this.props.path,nsId:this.props.nsId,componentNamespace:this.props.componentNamespace,fetchContentReferences:!0}),h.folderOverviewLiveUpdateManager.addListener("update",this.handleLiveUpdate)}componentWillUnmount(){h.folderOverviewLiveUpdateManager.removeListener("update",this.handleLiveUpdate),h.folderOverviewLiveUpdateManager.stop()}render(){return a.React$1.createElement("div",{className:r.classnames({"folder-overview":!0,"folder-overview--loading":!this.props.haveAllComponentsLoaded||this.props.hasFailedToLoad,"folder-overview__fixed-toolbar-container":!0,"folder-overview__border":this.props.descriptionHasFocus})},a.React$1.createElement(gt,{path:this.props.path,componentNamespace:this.props.componentNamespace,isReadOnly:this.props.isReadOnly||!this.props.descriptionFormatValid,descriptionKey:[this.props.folderFileId,this.props.descriptionBaseRevision].join("-"),canShareFolder:this.props.canShareFolder}),a.React$1.createElement(Ct,{path:this.props.path,componentNamespace:this.props.componentNamespace}))}}xt.displayName="SidebarFolderOverviewController";const bt=r.connect((()=>{const e=h.makeHaveAllComponentsLoadedSelector(),t=h.makeHasFailedToLoadSelector(),a=h.makeFolderFileIdSelector(),r=h.makeDescriptionBaseRevisionSelector(),o=h.makeDescriptionHasFocusSelector(),s=h.makeDescriptionFormatValidSelector(),n=h.makeDoesFolderOverviewExistSelector();return(i,l)=>({user:h.user(i),haveAllComponentsLoaded:e(i,l),hasFailedToLoad:t(i,l),folderFileId:a(i,l),descriptionBaseRevision:r(i,l),descriptionFormatValid:s(i,l),descriptionHasFocus:o(i,l),doesFolderOverviewExist:n(i,l)})}),St)(xt),yt=r.requireCssWithComponent(bt,["/static/metaserver/static/css/browse/folder_overview-vfldbusgW.css","/static/typescript/libraries/comments2/src/index-vfljiK9YC.css"]),kt="auto-tagging-awareness-snackbar-id",Tt=t=>{const{files:o,tag:s,isBulkTagging:i,numFilesTagged:l,user:c,onAutoTag:d,actionSurface:p}=t,u=i?"bulk_tagging":"single_file",m=o[0],g=i?n.intl.formatMessage({id:"5Na01D",defaultMessage:"{numFilesTagged} files tagged. Want to auto-tag future files in this folder <b>#{tag}</b>, too?"},{tag:s,numFilesTagged:l,b:e=>a.React$1.createElement(r.Text,{isBold:!0,color:"inherit"},e)}):n.intl.formatMessage({id:"80mH7x",defaultMessage:"Tagged {folderName}. Want to auto-tag current and future files in this folder <b>#{tag}</b>, too?"},{tag:s,folderName:r.getFilename(m),b:e=>a.React$1.createElement(r.Text,{isBold:!0,color:"inherit"},e)}),h={actions:[{icon:w.AutomationLine,name:"create_auto_tag",text:n.intl.formatMessage({id:"zz4WkW",defaultMessage:"Auto-tag #{tag}"},{tag:s}),onClick:()=>{new Promise((function(t,a){e(["./c_flows_redux_reducer"],t,a)})).then((function(e){return e.api_helpers_esnext})).then((e=>{const t=i&&m.is_dir?r.parent_dir(m.fq_path):m.fq_path,a=e.updateFolderRule({fqPath:t,actions:[{actionType:"tag",data:{tags:[s]}}],enabled:!0,trigger:e.DEFAULT_CLIENT_FOLDER_TRIGGER});return r.logAutoTagSnackbarAction(c.id,m,s,"auto_tag_folder",u,p),r.Snackbar.close(kt),a.then((()=>{!i&&m.is_dir&&d(),r.Snackbar.complete(n.intl.formatMessage({id:"Nazzhm",defaultMessage:"Automation added to folder."}))}),(e=>{r.Snackbar.fail(n.intl.formatMessage({id:"0cONZO",defaultMessage:"Couldn't add automation to folder"}))}))}))}},{name:"show_me_how",text:n.intl.formatMessage({id:"S+oEom",defaultMessage:"Show me how"}),onClick:()=>{r.logAutoTagSnackbarAction(c.id,m,s,"open_help_center",u,p),r.open_tab("//help.dropbox.com/files-folders/sort-preview/dropbox-tags")}},{name:"do_this_later",text:n.intl.formatMessage({id:"4yWOzK",defaultMessage:"Do this later"}),onClick:()=>{r.logAutoTagSnackbarAction(c.id,m,s,"close",u,p),r.Snackbar.close(kt)}}],helperText:g,clickHandlerArgs:{userId:c.id,filePath:m.fq_path}};return r.Snackbar.show(a.React$1.createElement(r.Snackbar,{title:"",variant:"complete",id:kt,richSnackbarProps:h}))};const wt=t=>{const{user:a,files:o,selectedTag:s,isSearchMode:i,isAutoTaggingEnabled:c,autoTaggingAwarenessVariant:d,autoTagFolderContents:p,allFilesSelected:u,hasMoreFiles:m,actionSurface:g,dispatch:f}=t,_=r.trimHashtags(s).toLowerCase(),v=()=>wt({user:a,files:o,selectedTag:_,isSearchMode:i,isAutoTaggingEnabled:c,autoTaggingAwarenessVariant:d,autoTagFolderContents:!0,allFilesSelected:u,hasMoreFiles:m,actionSurface:g,dispatch:f});!function(e){if(1===e.length){const t=r.File.getCategoryDescription(e[0]);if("Image"===t)return void r.UserSurvey.trackEvent("add_tag_to_image","right_rail");if("Document"===t)return void r.UserSurvey.trackEvent("add_tag_to_document","right_rail")}r.UserSurvey.trackEvent("add_tag","right_rail")}(o),f(r.addTagToFiles({user:a,files:o,tag:_,onPartialError:e=>{const t=r.createSelection(e.map((e=>e.fq_path)));f(i?r.setSelection({selection:t,skipLogging:!0}):h.setSelection({selection:t,skipLogging:!0}))},onSuccess:(t,i,p)=>{const h=o[0],f=t&&h.is_dir?r.parent_dir(h.fq_path):h.fq_path,E=()=>l.__awaiter(void 0,void 0,void 0,(function*(){if(p)return!0;const e=yield T.getFolderRules(f);return!!(null==e?void 0:e.get_rule_result)&&"folder_rule_set"===e.get_rule_result[".tag"]}));d&&"OFF"!==d&&new Promise((function(t,a){e(["./c_stormcrow_stormcrow_exposure_logger"],t,a)})).then((({StormcrowExposureLogger:e})=>{(new e).logExposure("auto_tag_awareness",d)})),t||p?l.__awaiter(void 0,void 0,void 0,(function*(){c&&u&&!m&&f.length>1&&!(yield E())?Tt({files:o,tag:_,isBulkTagging:t,numFilesTagged:i,user:a,onAutoTag:v,actionSurface:g}):r.Snackbar.complete(n.intl.formatMessage({id:"GxQj59",defaultMessage:"Tagged {numOfSuccesses} files or folders #{selectedTag}."},{numOfSuccesses:i,selectedTag:s}),"add-tag-bulk")})):l.__awaiter(void 0,void 0,void 0,(function*(){1===o.length&&c&&h.is_dir&&h.fq_path.length>1&&((yield E())||Tt({files:o,tag:_,isBulkTagging:t,numFilesTagged:1,user:a,onAutoTag:v,actionSurface:g}))}))},autoTagFolderContents:p||!1,actionSurface:g}))},Mt=({files:e,user:t,isSearchMode:o,isAutoTaggingEnabled:s,autoTaggingAwarenessVariant:n,actionSurface:i,userSurveyEventSurface:l})=>{const c=r.useDispatch(),d=r.useSelector((e=>o?r.allFilesSelected(e):r.allFilesSelected$1(e))),p=r.useSelector((e=>o?!!r.hasMoreResults(e):r.browseLoadingState(e)===r.LoadingState.LOADED)),u={onSelection:a=>{wt({user:t,files:e,selectedTag:a,isSearchMode:o,isAutoTaggingEnabled:s,autoTaggingAwarenessVariant:n,autoTagFolderContents:!1,allFilesSelected:d,hasMoreFiles:p,actionSurface:i,dispatch:c})},onTagDelete:a=>{c(r.removeTagFromFiles({user:t,files:e,tag:a,actionSurface:i}))},fetchAllTagsSuggestions:({user:e})=>{c(r.fetchAllTagsSuggestions({user:e}))},allTagsSuggestions:r.useSelector(r.selectAllTagsSuggestions)};return a.react.exports.createElement(M.TagsContext.Provider,{value:u},a.react.exports.createElement("div",{className:M.classes.reduxContainer},a.react.exports.createElement(M.TagsSection,{user:t,files:e,actionSurface:i,userSurveyEventSurface:l})))};Mt.displayName="TagsSectionRedux";r.injectInternalStyle("metaserver/static/js/right_rail/flows/automations_section.module.out.css",(e=>"._automations-section__container_1dhq2_1{display:flex;flex-direction:column;margin-top:20px}._automations-section__header_1dhq2_7{display:flex;flex-direction:row;justify-content:space-between}._automations-section__scheduled-trigger_1dhq2_13:hover{text-decoration:underline}"));const Rt="_automations-section__container_1dhq2_1",Ft="_automations-section__header_1dhq2_7",Nt="_automations-section__scheduled-trigger_1dhq2_13",Ot=({onEdit:e,inherited:t})=>{const{header:o,settings:s,inheritedSettings:n}=Bt(),i=t?n:s;return a.React$1.createElement("div",{className:Ft},a.React$1.createElement(r.Text,{variant:"paragraph",size:"small",isBold:!0},o),a.React$1.createElement(N.FlowsIconButton,{className:"automations-section__edit-button",icon:w.AutomationLine,onClick:e,size:"small",tooltip:{title:i,id:"tooltip-settings"},ariaLabel:i}))};Ot.displayName="AutomationsSectionHeader";const Lt=({folder:e,user:t,setUrl:o})=>{const s=Bt(),n=r.useSelector(F.getUserAutomationWithInheritance(e.fq_path));if(!n)return null;const i=[];if(n.actions.forEach((e=>{const t=O.loadWorkflowActionUi(e.actionType);t&&i.push(t)})),n.actions.length!==i.length)return null;const l=n.trigger,c="scheduled"===l.triggerType?a.React$1.createElement(Pt,{trigger:l}):a.React$1.createElement(Dt,{trigger:l}),d=L.isInherited(n)?n.inheritedFromFqPath:e.fq_path;return a.React$1.createElement("div",{className:Rt},a.React$1.createElement(Ot,{inherited:L.isInherited(n),onEdit:()=>R.asyncLaunchWorkflowBuilder({operation:"edit",folderFqPath:d,surface:"browse"})}),L.isInherited(n)&&a.React$1.createElement(se,{title:s.source,data:a.React$1.createElement(It,{automation:n,user:t,setUrl:o})}),a.React$1.createElement(se,{title:s.trigger,data:c}),a.React$1.createElement(se,{title:s.action,data:a.React$1.createElement(At,{actionUiConfigs:i})}))};function It({automation:e,user:t,setUrl:r}){return a.React$1.createElement(c.FileBreadcrumb,{size:"small",path:e.inheritedFromFqPath,user:t,useFullPath:!0,isForCurrentPath:!1,setUrl:r})}function Pt({trigger:e}){const t=Bt(),o=N.getFullRRuleStringForTooltip(e),s=a.React$1.createElement("span",{className:r.classnames({[Nt]:!!o})},N.getFrequencyString(e));return a.React$1.createElement(r.Text,{variant:"paragraph",size:"small"},o?a.React$1.createElement(r.Tooltip,{placement:"top-start",title:o},s):s,a.React$1.createElement("span",null,", ",t.triggerScheduled))}function Dt({trigger:e}){const t=Bt();return a.React$1.createElement(r.Text,{variant:"paragraph",size:"small"},t.triggerFileAdd)}function At({actionUiConfigs:e}){const{fewActionsLabel:t,manyActionsLabel:o}=Bt(),s=e.map((e=>e.rightRailTitle));return a.React$1.createElement(r.Text,{variant:"paragraph",size:"small"},s.length>3?o(s):t(s))}function Bt(){return{header:n.intl.formatMessage({id:"lVqDZn",defaultMessage:"Automations"}),trigger:n.intl.formatMessage({id:"L02EQa",defaultMessage:"When"}),triggerFileAdd:n.intl.formatMessage({id:"TEHGSR",defaultMessage:"Files are added to this folder"}),triggerScheduled:n.intl.formatMessage({id:"QmXlPG",defaultMessage:"files in this folder"}),action:n.intl.formatMessage({id:"RI/Q2m",defaultMessage:"Then"}),source:n.intl.formatMessage({id:"dD1r+k",defaultMessage:"Source"}),settings:n.intl.formatMessage({id:"RI/XND",defaultMessage:"Automation settings"}),inheritedSettings:n.intl.formatMessage({id:"JYuuqg",defaultMessage:"View automation settings of the source folder"}),fewActionsLabel:e=>n.intl.formatList(e),manyActionsLabel:e=>n.intl.formatMessage({id:"nsyNyU",defaultMessage:"{action1}, {action2}, {action3}, and +{count}"},{action1:e[0],action2:e[1],action3:e[2],count:e.length-3})}}Lt.displayName="AutomationsSection";const Ut=a.react.exports.memo((({files:e,user:t,viewType:o,isSearchMode:s,isSelection:n,id:l,setUrl:c,manualTaggingVariant:d,flowsAutomatedFolderUiVariant:p,flowsAutoTagUiVariant:m,autoTaggingAwarenessVariant:g,flowsApprovalVariant:h,isInsideBackup:f,backupFolderPath:_,navigateToBlade:v,flowsVersionControlVariant:E,lastBackupTime:C})=>{const S=r.useIntl(),x=e.get(0),b=e.toArray().filter((e=>(H(e)||$(e))&&!e.isDeleted)),y=b.length>0&&!f&&(r.isBulkTaggingEnabled(d)||r.isTaggingEnabled(d)&&1===b.length),k=1===e.size&&x&&(H(T=x)&&r.File.getCategoryDescription(T)===r.FileTypeCategoryTranslations.IMAGE);var T;return a.react.exports.createElement(i.RightRail.Blade,{withTitle:S.formatMessage({id:"AP9nbK",defaultMessage:"Info"}),withIcon:a.react.exports.createElement(r.UIIcon,{src:r.InfoLine}),id:l},a.react.exports.createElement("div",{className:ae},a.react.exports.createElement("div",{className:re},a.react.exports.createElement(z,{selectedFiles:e,user:t,viewType:o,isSearchMode:s,showMostRecentFilesFirst:!0})),y&&a.react.exports.createElement(Mt,{files:b,user:t,isSearchMode:s,isAutoTaggingEnabled:r.isAutoTaggingEnabled(d,p,m,g),autoTaggingAwarenessVariant:g,actionSurface:"right_pane",userSurveyEventSurface:"right_rail"}),a.react.exports.createElement(he,{files:e,user:t,isSelection:n,isSearchMode:s,setUrl:c,showHeader:y,showMediaDetails:k,showApproval:D.isApprovalEnabled(h),isInsideBackup:f,backupFolderPath:_,navigateToBlade:v,lastBackupTime:C}),1===e.size&&x&&$(x)&&!r.File.isNoAccessSharedFolder(x)&&a.react.exports.createElement(a.react.exports.Fragment,null,p&&a.react.exports.createElement(Lt,{folder:x,user:t,setUrl:c}),a.react.exports.createElement("div",{className:oe},a.react.exports.createElement(yt,{key:x.fq_path,path:x.fq_path,componentNamespace:"SIDEBAR",isReadOnly:!r.canEditOverviewForFile(x),canShareFolder:!r.File.isNoAccessSharedFolder(x)}))),u.isVersioningMVPEnabled(E)&&x&&1===e.size&&a.react.exports.createElement(A.ChangeLogSection,{fileId:x.file_id,user:t})))}));Ut.displayName="InfoBlade";const jt=a.react.exports.memo((({id:e})=>{const t=r.useIntl();return a.react.exports.createElement(i.RightRail.CollapsedBladeIcon,{id:e,withIcon:a.react.exports.createElement(r.UIIcon,{src:r.InfoLine,"aria-label":t.formatMessage({id:"pbG2K9",defaultMessage:"Open information panel"})}),tooltip:t.formatMessage({id:"+PrmmG",defaultMessage:"Info"})})}));jt.displayName="CollapsedInfoBladeButton";const Ht={Blade:e=>a.react.exports.createElement(Ut,Object.assign({},e)),CollapsedButton:e=>a.react.exports.createElement(jt,Object.assign({},e)),isBladeSupported:e=>!0},$t=a.React$1.createContext(void 0);const Vt=a.React$1.memo((e=>a.React$1.createElement(f.Comment,Object.assign({},e))));function Wt({fileId:e}){const t=r.useDispatch();a.react.exports.useEffect((()=>{t(B.listCommentsAction({arg:{include_permissions:!0,stream:{identifier:{".tag":"file_path_or_id",file_path_or_id:e},type:{".tag":"file"}}}}))}),[e,t])}function zt({fileId:e}){const t=r.useDispatch(),{commentBladeId:o}=function(){const e=a.react.exports.useContext($t);if(!e)throw new Error("BasicCommentsBladeContext should be provided");return e}();a.react.exports.useEffect((()=>{t(B.deactivateAllThreads({fileViewerId:o})),t(B.focusThread(o,null))}),[e,t,o])}Vt.displayName="BaseComment";const Kt={showApproval:!1,approvalIOClient:void 0},qt=a.React$1.memo((({fileId:e,id:t,intl:o,onClickAnnotation:s,approvalIOClient:n,user:i})=>{const l=function({fileId:e}){switch(r.useSelector((t=>B.getAnnotationType(t,e)))){case"audio":case"video":return e=>a.React$1.createElement(f.TimeCodedComment,Object.assign({},e));case"document":return e=>a.React$1.createElement(f.NumberedComment,Object.assign({},e));default:return e=>a.React$1.createElement(Vt,Object.assign({},e))}}({fileId:e});return Wt({fileId:e}),zt({fileId:e}),function(){const e=r.useDispatch();a.react.exports.useEffect((()=>{e(B.getStickersAction({arg:void 0}))}),[])}(),a.React$1.createElement(B.CommentsBlade,{id:t,intl:o,fileId:e,approvalIOClient:n},a.React$1.createElement(f.CommentsBladePane,{commentsBladeId:t,intl:o,commentFactory:l,config:Object.assign(Object.assign({},Kt),{approvalIOClient:n,showApproval:Boolean(null==n?void 0:n.getUserExperiments().flows_approval_flow_enabled)}),fileId:e,user:i,className:B.classes.baseCommentsPaneBlade,onClickAnnotation:s,approvalIOClient:n}))}));qt.displayName="BasicCommentsBladePaneWrapper";const Gt=a.React$1.memo((({fileId:e,id:t,intl:r})=>(Wt({fileId:e}),a.React$1.createElement(B.CollapsedCommentsBladeButton,{id:t,intl:r,fileId:e}))));Gt.displayName="CollapsedBladeButton";const Yt=r.defaultMemoize(((e,t)=>{const o=u.makeComments2Client(e),s=new r.DefaultUserApiV2Client(e);return((e,t,o)=>{const s=B.makeStore(e);return{Blade:a.React$1.memo((n=>{const{id:i}=n,l=a.react.exports.useMemo((()=>({apiV2Client:e.apiv2ClientBase,commentBladeId:i})),[i]);return a.React$1.createElement(r.Provider,{store:s},a.React$1.createElement($t.Provider,{value:l},a.React$1.createElement(qt,Object.assign({},n,{user:t,approvalIOClient:o}))))})),CollapsedButton:a.React$1.memo((t=>{const{id:o,intl:n,fileId:i}=t,l=a.react.exports.useMemo((()=>({apiV2Client:e.apiv2ClientBase,commentBladeId:o})),[o]);return a.React$1.createElement(r.Provider,{store:s},a.React$1.createElement($t.Provider,{value:l},a.React$1.createElement(Gt,{id:o,intl:n,fileId:i})))}))}})(Object.assign(Object.assign({},o),{apiv2ClientBase:s,logger:e=>{t({eventName:r.WebUserActionLogEvent.BROWSE_COMMENT_ACTION,extra:{action:e.event}})}}),u.dbxUserToIUser(e),o.approvalIOClient)})),Zt=e=>{return 1===e.files.size&&(t=e.files.first(),H(t)&&!t.isDeleted&&!(null===(a=t.per_node_metadata)||void 0===a?void 0:a.link_node)||V(e.files.first()))&&!!e.files.first().file_id&&!e.files.first().is_cloud_doc;var t,a},Qt=a.react.exports.memo((e=>{const{id:t,user:o,files:s,onClickAnnotation:n,onLogEvent:i}=e,l=r.useIntl();if(!Zt(e))return null;const{Blade:c}=Yt(o,i);return a.react.exports.createElement(c,{id:t,intl:l,fileId:s.first().file_id,onClickAnnotation:n})}));Qt.displayName="Blade";const Jt=a.react.exports.memo((e=>{const{id:t,files:o,user:s,onLogEvent:n}=e,i=r.useIntl();if(!Zt(e))return null;const{CollapsedButton:l}=Yt(s,n);return a.react.exports.createElement(l,{id:t,intl:i,fileId:o.first().file_id})}));Jt.displayName="CollapsedButton";const Xt={CollapsedButton:Jt,Blade:Qt,isBladeSupported:Zt},ea=j.makeStore({apiV2Client:new r.UserApiV2Client}),ta={[U.FilterUserEvent.SELECT_ALL_HISTORY_TYPE]:r.WebUserActionLogEvent.SELECT_ALL_HISTORY_TYPE,[U.FilterUserEvent.CLEAR_SELECT_HISTORY_TYPE]:r.WebUserActionLogEvent.CLEAR_SELECT_HISTORY_TYPE,[U.FilterUserEvent.SELECT_HISTORY_TYPE]:r.WebUserActionLogEvent.SELECT_HISTORY_TYPE,[U.FilterUserEvent.UNSELECT_HISTORY_TYPE]:r.WebUserActionLogEvent.UNSELECT_HISTORY_TYPE},aa=e=>1===e.files.size&&W(e.files)&&!e.files.first().isDeleted&&!!e.files.first().file_id&&!e.files.first().is_in_vault_folder,ra=({files:e,id:t,user:o,handleVersionHistory:s,onLogEvent:n})=>{const i=r.useIntl(),l=a.react.exports.useCallback((e=>{n({eventName:ta[e]})}),[n]),c=a.react.exports.useCallback((()=>s(o,e)),[s,o,e]),d=!((p=e.first()).isDeleted||p.is_unmounted||p.is_cloud_doc&&r.isPointerByExtension(p.ns_path)||(null===(u=p.per_node_metadata)||void 0===u?void 0:u.link_node));var p,u;const m=a.react.exports.useMemo((()=>d?{enabled:!0,onVersionHistoryClicked:c}:{enabled:!1}),[d,c]);return a.react.exports.createElement(U.FileActivityBlade,{id:t,fileId:e.first().file_id,user:o,versionHistory:m,rootNamespaceName:r.Viewer.get_root_name(o),logFilterChange:l,intl:i})};ra.displayName="BladeWithoutStore";const oa=e=>{const{id:t}=e,o=r.useIntl();return aa(e)?a.react.exports.createElement(U.CollapsedFileActivityBladeButton,{id:t,intl:o}):null};oa.displayName="CollapsedButton";const sa=e=>{const{files:t}=e;return aa(e)&&W(t)?a.react.exports.createElement(r.Provider,{store:ea},a.react.exports.createElement(ra,Object.assign({},e,{files:t}))):null};sa.displayName="Blade";const na={Blade:sa,CollapsedButton:oa,isBladeSupported:aa};t.BackupBreadcrumb=pe,t.CommentsBladeUI=Xt,t.FileActivityBladeUI=na,t.InfoBladeUI=Ht,t.enhanceBladeUI=function(e,t){return{Blade:r=>{const o=t(r),{Blade:s}=e;return a.react.exports.createElement(s,Object.assign({},r,o))},CollapsedButton:r=>{const o=t(r),{CollapsedButton:s}=e;return a.react.exports.createElement(s,Object.assign({},r,o))},isBladeSupported:t=>e.isBladeSupported(t)}},t.isBladeDirectory=$,t.isListBladeDirectory=e=>e.every((e=>$(e)))}));
//# sourceMappingURL=c_right_rail_file_activity_file_activity_blade.js-vfl4KoGUw.map
