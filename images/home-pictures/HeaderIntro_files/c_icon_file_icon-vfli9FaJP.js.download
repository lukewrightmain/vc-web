define(["exports","./c_tslib","./e_edison","./e_ui_page_files_router","./c_ui_title_bubble","./c_core_i18n","./c_ui_overlay"],(function(e,t,i,a,l,r,o){"use strict";class n extends i.React$1.PureComponent{render(){const e=function(e){const t={is_locked:!1,is_lockholder:!1,lockholder_name:""};return e?(e.lock_info?(t.is_locked=!0,t.lockholder_name=e.lock_info.lockholder_name,t.is_lockholder=e.lock_info.is_lockholder):("is_locked"in e&&(t.is_locked=e.is_locked||!1),"is_lockholder"in e&&(t.is_lockholder=e.is_lockholder||!1),"lockholder_name"in e&&(t.lockholder_name=e.lockholder_name||"")),t):t}(this.props.file),{is_locked:t,is_lockholder:a}=e;if(!t)return this.props.children;const n=i.React$1.createElement("div",null,function(e){const{is_lockholder:t,lockholder_name:i}=e;return t?r.intl.formatMessage({id:"TsSIGV",defaultMessage:"Locked by You"}):r.intl.formatMessage({id:"x3AX+F",defaultMessage:"Locked by {name}"},{name:i})}(e)),s="file-icon__lock-badge-"+(this.props.variant||"small")+"-"+(a?"right":"left");return i.React$1.createElement(l.TitleBubble,{content:n,position:o.StickyPosition.TOP},i.React$1.createElement("div",{className:"titleBubble-positioningTarget file-icon__lock-badge-container"},this.props.children,i.React$1.createElement("div",{className:s},i.React$1.createElement("svg",{viewBox:"0 0 10 10",version:"1.1"},i.React$1.createElement("g",{id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},i.React$1.createElement("g",{id:"Artboard"},i.React$1.createElement("g",{id:"Group-11-Copy-2"},i.React$1.createElement("g",{id:"Group-10-Copy-7"},i.React$1.createElement("g",{id:"Group-4"},i.React$1.createElement("circle",{id:"Oval-Copy-47",fill:"#FFFFFF",cx:"5",cy:"5",r:"5"}),i.React$1.createElement("circle",{id:"Combined-Shape-Copy-8",fill:"#DDDFE1",cx:"5",cy:"5",r:"3.95833333"}))),i.React$1.createElement("rect",{id:"Rectangle-Copy-7",fill:"#707781",x:"3.17385288",y:"4.58333333",width:"3.75",height:"2.5"}),i.React$1.createElement("path",{d:"M5.04885288,2.5 C5.73889678,2.5 6.29828788,3.0593911 6.29828788,3.749435 L6.29828788,5.83333333 L3.79941788,5.83333333 L3.79941788,3.749435 C3.79941788,3.0593911 4.35880899,2.5 5.04885288,2.5 Z M5.04861271,3.1251631 C4.70356115,3.1251631 4.4238416,3.40488266 4.4238416,3.74993422 L4.4238416,5.20817023 L5.67338383,5.20817023 L5.67338383,3.74993422 C5.67338383,3.40488266 5.39366428,3.1251631 5.04861271,3.1251631 Z",id:"Combined-Shape-Copy",fill:"#707781"}))))))))}}var s;n.displayName="LockBadge",function(e){e[e.SHOW_ICON=0]="SHOW_ICON",e[e.PREVIEW_LOADED=1]="PREVIEW_LOADED",e[e.PREVIEW_DEBOUNCING=2]="PREVIEW_DEBOUNCING"}(s||(s={}));class c extends i.React$1.Component{constructor(e){super(e),this.prefetchImage=null,this.handleImageLoad=()=>{this.setState({previewState:s.PREVIEW_LOADED})},this.handleImageError=()=>{this.setState({previewState:s.SHOW_ICON})},this.state={previewState:e.showPreview&&e.iconDelay&&e.file.thumbnail_url_tmpl?s.PREVIEW_DEBOUNCING:s.SHOW_ICON}}componentDidMount(){this.props.showPreview&&this.props.file.thumbnail_url_tmpl&&(this.preloadImage(),this.props.iconDelay&&(this.setState({previewState:s.PREVIEW_DEBOUNCING}),this.timeoutId=window.setTimeout((()=>{this.state.previewState===s.PREVIEW_DEBOUNCING&&this.setState({previewState:s.SHOW_ICON})}),this.props.iconDelay)))}componentDidUpdate(e){this.props.showPreview&&this.props.file.thumbnail_url_tmpl!==e.file.thumbnail_url_tmpl&&(this.preloadImage(),this.setState({previewState:s.SHOW_ICON}))}componentWillUnmount(){this.timeoutId&&window.clearTimeout(this.timeoutId),this.prefetchImage&&(this.prefetchImage.onload=null,this.prefetchImage=null)}preloadImage(){const{thumbnail_url_tmpl:e}=this.props.file;e&&(this.prefetchImage=new Image,this.prefetchImage.onload=this.handleImageLoad,this.prefetchImage.onerror=this.handleImageError,this.prefetchImage.src=e)}addBadge(e,t){const{hideBadge:a,variant:l,file:r}=this.props;return a?t:e?i.React$1.createElement(n,{file:r,variant:"large"===l?"preview-large":"preview-small"},t):i.React$1.createElement(n,{file:r,variant:l},t)}render(){const e=this.props,{file:l,variant:o,showPreview:n,iconDelay:c,hideBadge:d,previewUrl:h,onPreviewClick:m}=e,p=t.__rest(e,["file","variant","showPreview","iconDelay","hideBadge","previewUrl","onPreviewClick"]),{fq_path:_,thumbnail_url_tmpl:u,isDeleted:g,is_symlink:E,filename:f}=l,{previewState:I}=this.state,v=_||f||"";if(I===s.PREVIEW_DEBOUNCING)return null;if(n&&u&&I===s.PREVIEW_LOADED){const e=i.React$1.createElement("img",Object.assign({src:u,alt:l.fq_path,draggable:!1,onError:this.handleImageError},p));return this.addBadge(!0,h?i.React$1.createElement(a.Tooltip,{title:r.intl.formatMessage({id:"VbRtEL",defaultMessage:"Preview"})},i.React$1.createElement(a.Link,{onClick:m,href:h,className:"file-icon__preview"},e)):e)}const k=a.getDigIcon(l.icon,o);if(k)return this.addBadge(!1,k);if(E){const e="symlink-"+(o||"small");return i.React$1.createElement(a.IconContent,Object.assign({name:e,disabled:g},p))}return this.addBadge(!1,i.React$1.createElement(a.FileIcon,Object.assign({path:v,variant:o,disabled:g},p)))}}c.defaultProps={showPreview:!0,variant:"small"},c.displayName="FileIcon",e.FileIcon=c,e.LockBadge=n}));
//# sourceMappingURL=c_icon_file_icon.js-vflNmXRYP.map
