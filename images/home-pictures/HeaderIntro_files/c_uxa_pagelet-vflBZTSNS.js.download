define(["require","exports","./e_ui_page_files_router","./e_core_exception","./c_tslib","./c_ux_analytics_ux_variants","./c_ux_analytics_dispatch_custom_event","./c_core_exception_info","./e_edison","./c_core_uri","./c_lodash-es_lodash","./c_apex-metrics_src_types","metaserver/static/js/modules/constants/files_spa","./c_core_notify","./c_core_i18n","./c_src_sink_index","./c_core_browser_detection","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/core/langpack","metaserver/static/js/modules/constants/env","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/viewer","metaserver/static/js/modules/constants/auth","./c_api_v2_noauth_client","metaserver/static/js/modules/constants/request","./c_browser_cookies","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/ajax_strings","./c_csrf","./c_core_xhr","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/webtiming","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/trademark","metaserver/static/js/modules/constants/campaigns_orchestration","metaserver/static/js/modules/constants/maestro_nav_strings","metaserver/static/js/modules/constants/search","metaserver/static/js/modules/constants/undo_strings","metaserver/static/js/modules/constants/contacts","metaserver/static/js/modules/constants/login_and_register"],(function(e,t,n,i,s,a,r,o,l,c,d,u,h,g,m,_,v,f,E,p,y,k,T,w,S,I,b,x,L,M,O,P,V,N,C,A,D,R,U,G){"use strict";const q="SPAHistoryStateChange",j=e=>{const t={detail:{eventSource:e}};n.runAfterUxaListening((()=>{r.dispatchCustomEvent(q,t)}))},B=history.pushState,W=history.replaceState,H=e=>{j("popState")},F={oldReplaceState:W,oldPushState:B,resetHistoryListenersInstalled:()=>{self._DBX_UXA_historyListenersInstalled=!1},getHistoryListenersInstalled:()=>self._DBX_UXA_historyListenersInstalled,installPushStateMonkeyPatch:()=>{Object.defineProperty(history,"pushState",{value:(e,t,n)=>{const i=location.pathname+location.hash;F.oldPushState.call(history,e,t,n);i!==location.pathname+location.hash&&j("pushState")},writable:!0})},installReplaceStateMonkeyPatch:()=>{Object.defineProperty(history,"replaceState",{value:(e,t,n)=>{const i=location.pathname+location.hash;F.oldReplaceState.call(history,e,t,n);i!==location.pathname+location.hash&&j("replaceState")},writable:!0})}},X="data-uxa-log",$="data-uxa-interactions",z="element_interaction_event";var K,Y;function J(e=document.body,t="[data-uxa-interactions]"){const n=new Set;let i=null,s=r();const a=new MutationObserver((function(){if(null!==i)return;i=requestAnimationFrame((()=>{const e=r(),t=c(e,s);l(c(s,e)),function(e){n.forEach((t=>{t.addElements(e)}))}(t),s=e,i=null}))}));function r(){return Array.from(e.querySelectorAll(t)).filter((e=>e instanceof HTMLElement)).map((e=>e)).filter((e=>o(e)))}function o(e){var t;if(!e.hasAttribute(X)||!e.hasAttribute($))return!1;const n=null===(t=e.getAttribute($))||void 0===t?void 0:t.trim().split(/\s+/);return!(n&&n.indexOf("shown")<0)}function l(e){n.forEach((t=>{t.removeElements(e)}))}function c(e,t){return e.filter((e=>t.indexOf(e)<0))}function d(){a.observe(e,{childList:!0,subtree:!0})}return d(),{registerElementMutationListener:function(e){n.has(e)||(e.addElements(s),n.add(e))},unregisterElementMutationListener:function(e){n.has(e)&&(e.removeElements(s),n.delete(e))},purgeEventListeners:function(){l(s),n.clear()},pause:function(){a.disconnect()},resume:d,getElementsLength:function(){return s.length},testOnlyObserver:a,testOnlyIsEligibleForTracking:o,testOnlyDiffElements:c,testOnlyGetAnimationFrameRequest:function(){return i}}}function Q(e=.5){const t=new Map,n=new IntersectionObserver((function(t){t.forEach((t=>{const n=t.target;t.intersectionRatio>=e&&i(n,Y.VIEWING),t.intersectionRatio<e&&i(n,Y.VIEWED)}))}),{threshold:e});function i(e,n){const i=e.getAttribute(X),s=t.get(i);if(s)switch(n){case Y.VIEWING:s.status===Y.VIEWED&&(s.status=Y.VIEWING,s.lastViewStarted=performance.now(),r.dispatchCustomEvent(z,{detail:{eventType:K.ELEMENT_SHOWN,extra:{element_id:i}}}));break;case Y.VIEWED:if(s.status===Y.VIEWING){const n=Math.round(performance.now()-s.lastViewStarted);window.requestAnimationFrame((()=>{var a;const o=e.getAttribute(X),l=null===(a=t.get(o))||void 0===a?void 0:a.element;s.status!==Y.VIEWING||null!==l&&l!==e||(s.status=Y.VIEWED,r.dispatchCustomEvent(z,{detail:{eventType:K.ELEMENT_HIDE,extra:{element_id:i,element_shown_duration_ms:n}}}))}))}}}return{addElements:function(e){e.forEach((e=>function(e){const i=e.getAttribute(X),s=t.get(i);s?s.element=e:t.set(i,{status:Y.VIEWED,element:e,lastViewStarted:0});n.observe(e)}(e)))},removeElements:function(e){e.forEach((e=>function(e){const s=e.getAttribute(X),a=t.get(s);a&&(a.element=null,i(e,Y.VIEWED),n.unobserve(e))}(e)))},pause:function(){n.disconnect()},resume:function(){for(const[e,i]of t)(null==i?void 0:i.element)&&n.observe(i.element)},testOnlyTryUpdateElementStatus:i,testOnlyGetElementStatus:function(e){const n=t.get(e);return n?[n.element,n.status]:[null,null]}}}!function(e){e.ELEMENT_HIDE="elementHide",e.ELEMENT_SHOWN="elementShown"}(K||(K={})),function(e){e.VIEWING="VIEWING",e.VIEWED="VIEWED"}(Y||(Y={}));function Z(){return(new Date).getTime()}const ee={idGeneratingNow:Z};function te(){const e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)}function ne(e=window){return e.location.href}function ie(){const e={},t=function(e=window){return e.location.search}();if(t.length){const n=t.substring(1).replace(/&amp;/g,"&").split("&");for(const t of n){let[n,i]=t.split("=");n&&i&&(n=n.trim(),i=i.trim(),n.length&&i.length&&(e[n]=decodeURIComponent(i.replace(/\+/g," "))))}}return e}function se(e){return e&&e.hasAttribute("data-uxa-log")}function ae(e){return e&&"A"===e.nodeName}function re(e){return e&&e.getAttribute("data-trackingid")}function oe(e){return e&&"BODY"===e.nodeName}function le(){return Math.random().toString().slice(2)}const ce=(()=>{let e=null;const t="uxa.onedoesnotsimplyusesessionstorage";try{e=window.sessionStorage,e&&(e.setItem(t,t),e.removeItem(t))}catch(t){e=null}return e})(),de=(()=>{let e=null;const t=window;return e=t.hasOwnProperty("JSON")?t.JSON:null,e})();var ue;!function(e){function t(e){return`uxa.${e}`}const n=ce,i=de;function s(e){return n?(n.removeItem(t(e)),null):null}e.isEnabled=function(){return!!n},e.get=function(e){if(!n||!i)return null;try{const s=n.getItem(t(e));return null===s?null:i.parse(s)}catch(e){return null}},e.set=function(e,a){if(!n||!i)return null;try{return null===a?s(e):(n.setItem(t(e),i.stringify(a)),null)}catch(e){return null}},e.remove=s,e.clear=function(e){return n?(n.clear(),null):null}}(ue||(ue={}));const he=new Set(Object.keys(n.LOG_EVENTS).map((e=>n.LOG_EVENTS[e]))),ge="clicked_link",me="tracking_params",_e="visit_id",ve="previous_url",fe="last_active_time",Ee="event_log",pe="event_log_timestamp",ye=/\/account|\/share|\/buy|\/pro\/try/;const ke=["element_id","link_id","uxa_v","instance_event_count","instance_init_ts","event_ts","client_event_id"];function Te(e,t){return t[e]?(t[e]+"_"+e).toLowerCase().replace(/[^a-z0-9$\[\].]+/g,"_"):e}class we{constructor(e,t,i=!0){var s,r,o;if(this.currentModalId=null,this.lastScrollOffset=0,this.scrollTimer=null,this.trackingParams=null,this.startHeartbeat=()=>{for(const e of[2,5,10,15,30])setTimeout(this.logOnPage.bind(this,n.LOG_EVENTS.heartbeat),1e3*e);for(const e of[1,2,4,9])setTimeout(this.logOnPage.bind(this,n.LOG_EVENTS.heartbeat),60*e*1e3)},this.delayedInit=()=>{this.saveTrackingParams(),this.setupListeners(),this.logPageView(),this.logDelayedClickEvent(),this.uxaElementShownByPathEnabled&&function(){const e=J(),t=Q();e.registerElementMutationListener(t)}()},this.getListeners=()=>[[window,"scroll",this.handleScroll],[window,"pageshow",this.handlePageShow],[window,this.uxaRemoveUnloadByPathEnabled?"pagehide":"unload",this.handlePageClose],[document.body,"mousedown",this.handleMousedown],[document.body,"keydown",this.handleKeyboardEnter],[document,"modalOpened",this.trackModalShow],[document,"modalClosed",this.trackModalHide],[document,"freeze",this.handlePageFreeze],[document,"resume",this.handlePageResume],[window,"historyChange",this.onDBHistoryChange],[document,"viewUpdate",e=>this.logViewUpdate(e)],[window,q,this.handleHistoryStateChange],[window,"delayed_page_view_with_late_meta_tag",this.handleDelayedPageViewEventWithLateMetaTags],[window,"privacy_consent_custom_event",this.handlePrivacyConsentCustomEvent],[window,"marketing_tracker_ready_for_uxa",this.handleMarketTrackerReadyEvent],[document,"dialog_custom_event",this.handleDialogCustomEvent],[document,"document_custom_event",this.handleDocumentCustomEvent],[window,z,this.handleInteractionCustomEvent]],this.trackScrolling=()=>{this.scrollTimer&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(this.onScroll,500)},this.handleScroll=function(e,t,n={}){let i=null,s=0;return function(){const a=Z();s||!1!==n.leading||(s=a);const r=t-(a.valueOf()-s.valueOf());let o=arguments;if(r<=0||r>t)i&&(clearTimeout(i),i=null),s=a,e.apply(null,o),o=null;else if(!i&&!1!==n.trailing){const t=()=>{s=!1===n.leading?0:Z(),i=null,e.apply(null,o),o=null};i=setTimeout(t,r)}}}(this.trackScrolling,2e3,{leading:!0}),this.onScroll=()=>{const e=te();this.lastScrollOffset!==e&&(this.lastScrollOffset=e,this.logOnPage(n.LOG_EVENTS.scroll,{vertical_offset:e}))},this.handlePageShow=e=>{if(this.navigationType=n.getNavigationType(),this.bfcacheEligible=e.persisted,e.persisted){this.cleanSessionStorage();const e=ue.get(ve);ue.set(ve,ne()),this.previousUrl=e,this.visitId=ue.get(_e),setTimeout(this.delayedInit,200)}},this.handlePageClose=e=>{const t={};t.vertical_offset=t.vertical_offset||te(),t.time_on_page=t.time_on_page||this.getTimeOnPage(),this.logEvent(this.createEvent(n.LOG_EVENTS.finalHeartbeat,t))},this.handleElementClick=e=>{const t=function(e){let t=e;for(let e=0;e<6&&!se(t)&&!oe(t);e++){const e=t.parentNode;if(!(e instanceof HTMLElement))break;t=e}return t}(e.target);if(!se(t))return;const i=t.getBoundingClientRect(),s=this.createEvent(n.LOG_EVENTS.elementClick,{left:Math.round(i.left),element_id:t.getAttribute("data-uxa-log"),element_rank:this.getElementRank(t),time_on_page:this.getTimeOnPage(),top:Math.round(i.top),vertical_offset:te(),tag_name:t.tagName.toLowerCase()});this.logEvent(s)},this.handleLinkClick=e=>{const t=function(e){let t=e;for(let e=0;e<6&&!ae(t)&&!re(t)&&!oe(t);e++){const e=t.parentNode;if(!(e instanceof HTMLElement))break;t=e}return t}(e.target);if(!ae(t)&&!re(t))return;const i=t.getBoundingClientRect(),s=this.createEvent(n.LOG_EVENTS.linkClick,{left:Math.round(i.left),link_id:t.getAttribute("data-trackingid"),link_rank:this.getLinkRank(t),origin_href:t.getAttribute("href"),time_on_page:this.getTimeOnPage(),top:Math.round(i.top),vertical_offset:te(),tag_name:t.tagName.toLowerCase()});this.delayedLinkClickLogging&&ae(t)?this.storeDelayedLinkClick(s):this.logEvent(s)},this.onDBHistoryChange=e=>{var t;t=e.detail.url,ye.test(t)&&(ue.set(ve,ne()),this.previousUrl=e.detail.previousUrl,++this.requestSeq,this.logPageView())},this.handleHistoryStateChange=e=>{const t=ue.get(ve);ue.set(ve,ne()),this.previousUrl=t,++this.requestSeq,this.logSpaPageView(e.detail.eventSource)},this.handleDelayedPageViewEventWithLateMetaTags=e=>{a.addConfigsFromDOM(!0),this.logEvent(this.createEvent(n.LOG_EVENTS.delayedPageViewWithLateMetaTag))},this.handlePrivacyConsentCustomEvent=e=>{this.logEvent(this.createEvent(n.LOG_EVENTS[e.detail.eventType],e.detail.extra))},this.handleDialogCustomEvent=e=>{this.logEvent(this.createEvent(n.LOG_EVENTS[e.detail.eventType],e.detail.extra))},this.handleDocumentCustomEvent=e=>{this.logEvent(this.createEvent(n.LOG_EVENTS[e.detail.eventType],e.detail.extra))},this.handleMousedown=e=>{this.handleLinkClick(e),this.handleElementClick(e)},this.handleKeyboardEnter=e=>{13===e.keyCode&&(this.handleLinkClick(e),this.handleElementClick(e))},this.handleMarketTrackerReadyEvent=e=>{this.logEvent(this.createEvent(n.LOG_EVENTS[e.detail.eventType],e.detail.extra))},this.handlePageFreeze=()=>{this.logEvent(this.createEvent(n.LOG_EVENTS.pageFreeze))},this.handlePageResume=()=>{this.logEvent(this.createEvent(n.LOG_EVENTS.pageResume))},this.handleInteractionCustomEvent=e=>{this.logEvent(this.createEvent(n.LOG_EVENTS[e.detail.eventType],e.detail.extra))},this._modalIdSanitizer=e=>{const t="db-modal-custom-";if("upsell-home-modal"===e.id){const n=Array.from(e.classList).find((e=>e.indexOf(t)>-1));if(n)return n.replace(t,"")}return e.id},this.trackModalShow=()=>{const e=document.querySelectorAll(this.modalClass),t=Array.from(e).find((e=>"none"!==window.getComputedStyle(e).display||e.classList.contains("clean-react-modal")||e.classList.contains("uxa-modal-tracking-span")));t&&(this.currentModalId=this._modalIdSanitizer(t)||"n/a -- file bug to cgi-team",this.logModal(n.LOG_EVENTS.modalOpen,this.currentModalId))},this.trackModalHide=()=>{this.currentModalId&&(this.logModal(n.LOG_EVENTS.modalClose,this.currentModalId),this.currentModalId=null)},"PITHOS"!=t.inclusionMethod&&"dropbox.com"!=location.hostname.split(".").slice(-2).join("."))throw new Error(`UXAnalytics.log: trying to log at non-entitled site (${location.hostname})`);self._DBX_UXA_historyListenersInstalled||(F.installPushStateMonkeyPatch(),F.installReplaceStateMonkeyPatch(),window.addEventListener("popstate",H),self._DBX_UXA_historyListenersInstalled=!0),this.cleanSessionStorage();const l=ue.get(ve)||t.previousUrl;ue.set(ve,ne()),this.instance_event_count=0,this.instance_init_ts=ee.idGeneratingNow(),this.requestId=t.requestId,this.orgReferrer=t.orgReferrer,this.httpReferrer=t.httpReferrer,this.previousUrl=l,this.visitId=ue.get(_e),this.requestSeq=0,this.event_names=t.event_names,this.logger=e,this.cmsPageUuid=document.body.getAttribute("data-article-uuid"),this.bfcacheEligible=!1,void 0!==t.delayed_link_click_logging?this.delayedLinkClickLogging=t.delayed_link_click_logging:this.delayedLinkClickLogging=!0,void 0!==t.modal_class?this.modalClass=t.modal_class:this.modalClass=".uxa-modal",void 0!==t.shouldBeSentToMarketingTrackerVariables?this.shouldBeSentToMarketingTrackerVariables=t.shouldBeSentToMarketingTrackerVariables:this.shouldBeSentToMarketingTrackerVariables=ke,this.marketingTrackerExtraEnabled=!!t.marketingTrackerExtraEnabled,this.marketingTrackerIntegrationEnabled=!!t.marketingTrackerIntegrationEnabled,this.isInternalIp=!!t.isInternalIp,this.isUserDropboxAdmin=!!t.isUserDropboxAdmin,this.uxaRemoveUnloadByPathEnabled=!!t.uxaRemoveUnloadByPathEnabled,this.uxaElementShownByPathEnabled=!!t.uxaElementShownByPathEnabled,this.useBeaconForAllEvents=!!t.useBeaconForAllEvents,this.expEventsToExpIdMap=null!==(s=t.expEventsToExpIdMap)&&void 0!==s?s:{},this.expDataFieldsToExpIdMap=null!==(r=t.expDataFieldsToExpIdMap)&&void 0!==r?r:{},this.inclusionMethod=null!==(o=t.inclusionMethod)&&void 0!==o?o:"need_to_define",this.configTime=Number(t.configTime)||0,this.initTime=Z(),this.startHeartbeat(),i?setTimeout(this.delayedInit,200):this.delayedInit()}static initialize(e,t,n=null,i=!0){if(null===we.singleton)we.singleton=new we(e,t,i);else if(n){[["requestId",t.requestId,we.singleton.requestId],["orgReferrer",t.orgReferrer,we.singleton.orgReferrer],["httpReferrer",t.httpReferrer,we.singleton.httpReferrer],["configs.delayed_link_click_logging",t.delayed_link_click_logging,we.singleton.delayedLinkClickLogging],["configs.event_names",t.event_names,we.singleton.event_names],["configs.modal_class",t.modal_class,we.singleton.modalClass],["configs.shouldBeSentToMarketingTrackerVariables",t.shouldBeSentToMarketingTrackerVariables,we.singleton.shouldBeSentToMarketingTrackerVariables],["configs.marketingTrackerIntegrationEnabled",t.marketingTrackerIntegrationEnabled,we.singleton.marketingTrackerIntegrationEnabled],["configs.marketingTrackerExtraEnabled",t.marketingTrackerExtraEnabled,we.singleton.marketingTrackerExtraEnabled],["configs.isInternalIp",t.isInternalIp,we.singleton.isInternalIp],["configs.isUserDropboxAdmin",t.isUserDropboxAdmin,we.singleton.isUserDropboxAdmin],["configs.expEventsToExpIdMap",t.expEventsToExpIdMap,we.singleton.expEventsToExpIdMap],["configs.expDataFieldsToExpIdMap",t.expDataFieldsToExpIdMap,we.singleton.expEventsToExpIdMap]].forEach((([e,t,i])=>{void 0!==t&&t!==i&&n(new Error(`UX Analytics initialize overload attempt; ${e} '${t}' !== '${i}'`))}))}return we.singleton}canUseDevTools(){return(this.isInternalIp||this.isUserDropboxAdmin)&&"PITHOS"!==this.inclusionMethod}setupListeners(){this.getListeners().forEach((([e,t,n])=>{e.addEventListener(t,n)})),n.uxaIsListening()}cleanupListeners(){this.getListeners().forEach((([e,t,n])=>{e.removeEventListener(t,n)}))}cleanSessionStorage(){const e=Z(),t=ue.get(_e),n=ue.get(fe);null===t?ue.set(_e,le()):null!==n&&e-n>=18e5&&(ue.remove(ve),ue.set(_e,le())),ue.set(fe,e)}logPageView(){const e={page_view_latency:-100,bfcache_eligible:this.bfcacheEligible,navigation_type:this.navigationType};if(this.configTime>0){const t=Math.round((this.instance_init_ts-this.configTime)/1e3);e.page_view_latency=t<=10?t:11,this.configTime=-1}else 0===this.configTime&&(e.page_view_latency=-10,this.configTime=-1);this.logEvent(this.createEvent(n.LOG_EVENTS.pageView,e))}logSpaPageView(e){this.logEvent(this.createEvent(n.LOG_EVENTS.spaPageView,{spa_source:e}))}logModal(e,t){const n={modal:t};this.logOnPage(e,n,!0)}logViewUpdate(e){const{viewId:t,viewStep:n}=e.detail,i={view:t,view_step:n};this.logOnPage("view_update",i,!0)}logDelayedClickEvent(){if(!ue.isEnabled())return null;const e=ue.get(ge);if(e)try{e.destination_url=ne();const t={eventName:n.LOG_EVENTS.linkClick,extra:e};this.logEvent(t),ue.remove(ge)}catch(e){}return null}logOnPage(e,t={},n=!1){const i=this.getTimeOnPage();t.vertical_offset=t.vertical_offset||te(),t.time_on_page=t.time_on_page||i,(i<600||n)&&this.logEvent(this.createEvent(e,t))}logEvent(t){var i;return s.__awaiter(this,void 0,void 0,(function*(){try{if(s=t.eventName,!he.has(s))throw new Error(`UXAnalytics.log: trying to log an invalid event (${t.eventName})`);a.addMatchedVariantsToEvent(t);const r=ee.idGeneratingNow();"loading"===document.readyState&&(yield new Promise((function(e){if("interactive"===document.readyState||"complete"===document.readyState)e();else{function t(){document.removeEventListener("DOMContentLoaded",t),e()}document.addEventListener("DOMContentLoaded",t)}}))),t.extra.instance_event_count=++this.instance_event_count,t.extra.instance_init_ts=this.instance_init_ts,t.extra.event_ts=r,t.extra.client_event_id=`${this.instance_init_ts}-${this.instance_event_count}-${r}`,this.getWARPInfo()&&(t.extra.warp_variants=this.getWARPInfo());let o={};if(this.marketingTrackerExtraEnabled&&(o=function(e,t,n){const i={};for(const[s,a]of Object.entries(e))t.includes(s)&&(i["uxa_"+Te(s,n)]=a);return i}(t.extra,this.shouldBeSentToMarketingTrackerVariables,this.expDataFieldsToExpIdMap)),this.marketingTrackerIntegrationEnabled){const e=Te(t.eventName,this.expEventsToExpIdMap);n.pushToMarketingTrackerLoggingQueue(e,o)}if(t.eventName===n.LOG_EVENTS.finalHeartbeat||t.eventName===n.LOG_EVENTS.pageFreeze?this.logger.log(t.eventName,t.extra,!0,this.event_names):this.logger.log(t.eventName,t.extra,this.useBeaconForAllEvents,this.event_names),this.canUseDevTools()){const n=parseFloat(String(ue.get(pe)));if(n<=Date.now()){const e=1e3,s=(Array.isArray(ue.get(Ee))&&null!==(i=ue.get(Ee))&&void 0!==i?i:[]).filter((e=>{var t;return parseFloat(String(null===(t=null==e?void 0:e.extra)||void 0===t?void 0:t.event_ts))>=n})).concat(t).slice(-e);ue.set(Ee,s)}else Array.isArray(ue.get(Ee))&&ue.remove(Ee);try{yield new Promise((function(t,n){e(["./c_ux_analytics_styles_devtools"],t,n)}))}catch(e){throw new Error("UXAnalytics.log: failed to load devtools.module.css")}}}catch(e){throw e}var s}))}createEvent(e,t={}){if(this.orgReferrer&&(t.org_referrer=this.orgReferrer),this.visitId&&(t.visit_id=this.visitId),t.request_seq=this.requestSeq,this.httpReferrer&&(t.http_referrer=this.httpReferrer),this.previousUrl&&(t.previous_url=this.previousUrl),this.cmsPageUuid&&(t.cms_page_uuid=this.cmsPageUuid),t.request_id=t.request_id||this.requestId,t.url=t.url||ne(),location.hash&&(t.hash_fragment=location.hash),t.uxa_v=2.2,t.uxa_inclusion_method=this.inclusionMethod,this.trackingParams)for(const e of Object.keys(this.trackingParams)){const n=e.replace(/^_/,""),i=this.trackingParams[e];t[`param_${n}`]=i}return{eventName:e,extra:t}}storeDelayedLinkClick(e){if(!ue.isEnabled())return this.logOnPage(n.LOG_EVENTS.linkNoSessionStorage),!1;try{ue.set(ge,e.extra)}catch(e){return!1}return!0}saveTrackingParams(){const e=this.getTrackingParams();Object.keys(e).length?(ue.set(me,e),this.trackingParams=e):this.trackingParams=null}getTrackingParams(){const e=ue.get(me)||{},t=ie();for(const i of n.UXA_TRACKING_PARAM_KEYS)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}getWARPInfo(){return this.warpInfo=this.warpInfo||n.getWARPInfoFromDOM(),this.warpInfo||null}getTimeOnPage(){return Math.round((Z()-this.initTime)/1e3)}getElementRank(e){const t=e.nodeName.toLowerCase(),n=e.getAttribute("data-uxa-log"),i=document.querySelectorAll(`${t}[data-uxa-log="${n}"]`);if(1===i.length)return 1;for(let t=0;t<i.length;t++)if(i[t]===e)return t+1;return-1}getLinkRank(e){const t=e.getAttribute("href"),n=document.querySelectorAll(`a[href="${t}"]`);if(1===n.length)return 1;for(let t=0;t<n.length;t++)if(n[t]===e)return t+1;return-1}}we.singleton=null,t.initialize_module=function({UXAConfigs:e}){we.initialize(n.UXAnalyticsLogger,e,(function(e){i.reportException({err:e,severity:o.SEVERITY.CRITICAL,tags:["ux_analytics"]})})),n.updateConfigs({requestId:e.requestId})}}));
//# sourceMappingURL=c_uxa_pagelet.js-vflkOO2uh.map
