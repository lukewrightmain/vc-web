define(["exports","./e_edison","./c_core_notify","./e_ui_page_files_router","./c_campaigns_action_defs_api","./c_campaigns_hooks_logging","./c_core_i18n","./c_lodash-es_lodash","./c_tslib","./c_core_uri","./c_apex-metrics_src_types","metaserver/static/js/modules/constants/files_spa","./e_core_exception","./c_core_exception_info","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/constants/request","metaserver/static/js/modules/constants/env","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/viewer","metaserver/static/js/modules/constants/auth","./c_api_v2_noauth_client","./c_browser_cookies","./c_src_sink_index","./c_core_browser_detection","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/ajax_strings","./c_csrf","./c_core_xhr","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/webtiming","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/trademark","metaserver/static/js/modules/constants/campaigns_orchestration","metaserver/static/js/modules/constants/maestro_nav_strings","metaserver/static/js/modules/constants/search","metaserver/static/js/modules/constants/undo_strings","metaserver/static/js/modules/constants/contacts","metaserver/static/js/modules/constants/login_and_register","metaserver/static/js/modules/core/langpack","./c_auth_login_or_register_types"],(function(e,t,n,s,a,r,i,o,c,l,m,u,_,d,p,v,g,f,x,h,b,C,E,k,y,R,j,$,w,L,I,D,T,P,F,H,S,W,z,A){"use strict";const B=s.styled(s.Button)`
  margin-left: var(--spacing__unit--2);
`,M=s.styled(s.Label)`
  display: inline-block;
  padding-top: var(--spacing__unit--0.5);
`,N=s.styled.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  min-width: 220px;
`,q=s.styled.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  margin-left: auto;
`,O=s.styled(s.Image$1)`
  display: block;
  margin-bottom: var(--spacing__unit--2);
`,U=s.styled(s.IconButton)`
  position: absolute;
  top: 6px;
  right: 6px;
`;const G=e=>{const n=e.activeCampaignContent,i=t.React$1.useRef(null),[c,l]=t.react.exports.useState(!1),[m,u]=t.react.exports.useState(null),{onConfirmCallback:_,onDismissCallback:d,onLogImpressionCallback:p,onLogClientDispatchedCallback:v,state:g}=r.useCampaignActions(e),{hasConfirmed:f,hasDismissed:x}=g,h=t.react.exports.useCallback(o.once(((e,t)=>{var s,r,i;"cta_button"===e&&(null==t||t.preventDefault(),null==t||t.nativeEvent.stopImmediatePropagation());const o=n.primary_cta;if("cta_button"===e&&"dismiss"===(null===(s=null==o?void 0:o.on_cta_button_click)||void 0===s?void 0:s[".tag"]))return void d();if(_(void 0,"primary_cta",{source:e}),!o)return;const c=a.getActionDefFromCtaHandler(o.on_cta_button_click),l=a.getCallbackFunctionForActionDef(c);if(l){if("anchor_element"===e&&"click_element_from_css_selector"===(null===(r=o.on_cta_button_click)||void 0===r?void 0:r[".tag"])&&(null===(i=c.args)||void 0===i?void 0:i[0])===n.element_selector)return;l()}})),[]),b=t.react.exports.useCallback((e=>{h("cta_button",e)}),[]),C=t.react.exports.useCallback((()=>{h("anchor_element")}),[]);return t.react.exports.useEffect((()=>{v()}),[]),t.react.exports.useEffect((()=>{const e=()=>{var e;null===(e=null==i?void 0:i.current)||void 0===e||e.update();const t=(e=>{if(e&&"string"==typeof e)try{return document.querySelector(e)}catch(e){return null}return null})(n.element_selector),s=function(e){if(!e||e.hidden)return!1;const t=e.getBoundingClientRect();return!(!t||!t.width&&!t.height)&&t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}(t);m===t||f||x||(m&&m.removeEventListener("click",C),t&&t.addEventListener("click",C),u(null)),(f||x)&&(null==m||m.removeEventListener("click",C),null==t||t.removeEventListener("click",C)),u(t),l(s)},t=setInterval((()=>e()),200);return()=>{clearInterval(t)}}),[c,m,f,x,C]),t.react.exports.useEffect((()=>()=>{null==m||m.removeEventListener("click",C)}),[m]),m&&c?f||x||"tooltip_campaign_format"!==(null==n?void 0:n[".tag"])?null:t.React$1.createElement(s.LayerContext.Provider,{value:{zIndex:500}},t.React$1.createElement(J,{campaignContent:n,targetElement:m,ref:i,isOpen:!f||!x,onDismiss:()=>{d()},onConfirm:b,onLogImpression:()=>{p()}})):null};G.displayName="CampaignTooltip";const J=t.React$1.forwardRef((({campaignContent:e,isPreview:a,targetElement:r,targetElementRef:o,isOpen:c,onConfirm:l,onDismiss:m,onLogImpression:u},_)=>{var d,p;const v=t.react.exports.useRef(r),g=null!=o?o:v,f=i.intl.formatMessage({id:"L6eP+4",defaultMessage:"Tooltip image."}),x=!e.inverse;return t.React$1.createElement(s.Tooltip.Control,{variant:"rich",open:c,triggerRef:g,placement:e.placement,shouldReturnFocus:!0,ref:_,isPortaled:!a,onDisplayed:u,inverse:x,maxWidth:272},e.has_close_button&&t.React$1.createElement(U,{variant:"transparent",onClick:m,inverse:x,"aria-label":"Close button"},t.React$1.createElement(s.UIIcon,{src:s.CloseLine})),t.React$1.createElement("div",{style:{minWidth:"220px",paddingRight:e.has_close_button?"20px":"0px"}},e.title_text&&t.React$1.createElement(s.Title,{size:"standard",inverse:x},e.title_text),t.React$1.createElement(s.Text,{tagName:"p",color:"standard",inverse:x},t.React$1.createElement("span",{dangerouslySetInnerHTML:{__html:n.purify.sanitize(e.message_text||"")}})),e.image_url&&t.React$1.createElement(O,{src:e.image_url,alt:e.image_alt_text||f}),!e.has_close_button&&t.React$1.createElement(N,null,t.React$1.createElement(M,{color:"faint"},e.footer_text),t.React$1.createElement(q,null,e.dismiss_cta_label&&t.React$1.createElement(B,{variant:"transparent",inverse:x,onClick:m},e.dismiss_cta_label),t.React$1.createElement(B,{variant:"outline",id:null===(d=e.primary_cta)||void 0===d?void 0:d.cta_id,onClick:l,inverse:x},null===(p=e.primary_cta)||void 0===p?void 0:p.cta_text)))))}));J.displayName="CampaignTooltipRenderer",e.CampaignTooltip=G,e.CampaignTooltipRenderer=J}));
//# sourceMappingURL=c_campaign_formats_tooltip_campaign_tooltip.js-vflvqtCot.map
