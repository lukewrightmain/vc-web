define(["require","exports","./c_tslib","./e_edison","./c_file_viewer_data_store","./c_previews_data_actions","./c_file_viewer_sdk_file_viewer_experiments","./c_file_viewer_utils","./e_ui_page_files_router","./c_file_store_utils","./c_core_logging_constants","./c_core_uri","./c_lodash-es_lodash","./c_apex-metrics_src_types","./c_api_v2_noauth_client","./e_core_exception","./c_core_exception_info","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/constants/request","./c_browser_cookies","metaserver/static/js/modules/constants/file_viewer_configuration","metaserver/static/js/modules/constants/file_viewer_feature_experiments","metaserver/static/js/modules/constants/file_viewer_flows_experiments","./c_core_i18n","./c_src_sink_index","./c_core_browser_detection","metaserver/static/js/modules/core/langpack","metaserver/static/js/modules/constants/files_spa","./c_core_notify","metaserver/static/js/modules/constants/env","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/viewer","metaserver/static/js/modules/constants/auth","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/ajax_strings","./c_csrf","./c_core_xhr","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/webtiming","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/trademark","metaserver/static/js/modules/constants/campaigns_orchestration","metaserver/static/js/modules/constants/maestro_nav_strings","metaserver/static/js/modules/constants/search","metaserver/static/js/modules/constants/undo_strings","metaserver/static/js/modules/constants/contacts","metaserver/static/js/modules/constants/login_and_register"],(function(e,t,s,i,n,o,r,c,a,l,u,m,_,d,v,f,w,g,p,j,h,b,S,x,F,O,P,k,y,C,E,I,V,A,R,z,B,D,$,L,T,q,M,N,G,H,J){"use strict";function K(e,t,s){n.hydrateFileStore(e,t),function(e,t,s){e.dispatch(o.fetchPreviewData(t,s,void 0,r.fileViewerFeatureExperiments.imgSizeOptimization))}(e,t,s)}let Q,U="";function W(e,t,s=!1){!function(e,t,s,i){e.dispatch(o.fetchPreviewData(t,s,i,r.fileViewerFeatureExperiments.imgSizeOptimization))}(n.getStoreForFileViewer(),e,t,s)}const X="data-preview-created-container";function Y(e,t,s=!1){Q&&(!function(e){const t=n.getStoreForFileViewer();n.updateFileStore(t,e)}(e),W(e,Q.user,s),te(Object.assign(Object.assign({},Q),{file:t||Q.file,files:e})))}function Z(){!function(){const e=document.getElementById(U);i.ReactDOM.unmountComponentAtNode(e),function(e){const t=document.getElementById(e);if(t){const e=t.getAttribute(X);e&&"true"===e&&document.body.removeChild(t)}}(U),Q=void 0}()}const ee=i.React$1.lazy((()=>s.__awaiter(void 0,void 0,void 0,(function*(){const{FileCollectionViewer:t}=yield new Promise((function(t,s){e(["./c_file_viewer_collection_viewer"],t,s)}));return{default:t}}))));function te(e){const t=document.getElementById(U);Q=e,i.ReactDOM.render(i.React$1.createElement(i.React$1.Suspense,{fallback:i.React$1.createElement("div",null)},i.React$1.createElement(ee,Object.assign({},e))),t)}t.close=Z,t.isShown=function(){return null!=Q},t.open=function(e,t,i,r,m,_){U=r,function(e){let t=document.getElementById(e);t||(t=document.createElement("div"),t.setAttribute(X,"true"),t.id=e,document.body.insertBefore(t,document.body.children[0]))}(U);const d=function(e){let{initialPreviewSourceAction:t,initialPreviewSourceContext:i,sharedLinkInfos:n,sharePermissions:o,shareTokens:r}=e,a=s.__rest(e,["initialPreviewSourceAction","initialPreviewSourceContext","sharedLinkInfos","sharePermissions","shareTokens"]);null==i&&(i=c.getSourceContext(a.fileViewOrigin)||u.SourceContext.Browse);null==t&&(t=c.getSourceAction());const{onCloseViewer:l}=a;return a.onCloseViewer=()=>(Z(),"function"==typeof l?l():void 0),Object.assign({initialPreviewSourceAction:t,initialPreviewSourceContext:i},a)}(m);_||function(e,t){K(n.getStoreForFileViewer(),e,t),t&&a.initializeStore(t,e)}(e,i);const v=n.getStoreForFileViewer(),f=o.getApiDataForFiles(v.getState(),e),w=e.map((e=>{var t;return Object.assign(Object.assign({},e),{preview:e.preview||(null===(t=f[l.getFileRevisionId(e)])||void 0===t?void 0:t.data)})}));te(Object.assign(Object.assign({},d),{containerId:r,files:w,file:w[t],sharedLinkInfos:m.sharedLinkInfos,shareTokens:m.shareTokens,sharePermissions:m.sharePermissions,user:i,updateFiles:Y}))},t.prewarmPreviewData=function(e,t){W(e,t)},t.updateFiles=Y,t.updateProps=function(e){Q&&te(Object.assign(Object.assign({},Q),e))}}));
//# sourceMappingURL=c_file_viewer_controller.js-vfl0S3acC.map
