define(["exports","./e_ui_page_files_router","./e_edison","./c_ui-icon_line_add-folder","./c_ui-icon_line_automation","./c_ui-icon_line_team","./c_src_simple-action-bar_action_bar_types","./c_spectrum_icon_partners_index","./c_core_i18n","./c_flows_redux_store","./c_browse_tts","./c_tslib","./c_ui-icon_line_record-screen-camera","./c_capture_sdk_helpers","./c_capture_redux_selectors","./c_capture_async_recorder","./c_ui-icon_line_upload-folder","./c_core_browser_detection"],(function(e,t,o,n,a,i,s,r,c,E,l,u,d,m,_,p,A,R){"use strict";const T={dropbox_form:o.static_url("/static/metaserver/static/images/dropbox_form-vfl1f-v2W.svg")},O=({iconName:e,displayName:t})=>{const n=T[e];return n?o.React$1.createElement("img",{alt:t,src:n,width:"24px",height:"24px"}):o.React$1.createElement(r.IconPartners,{name:e,width:"24px",height:"24px"})};O.displayName="NewFileIcon";const L=c.intl.formatMessage({id:"8/w9ir",defaultMessage:"Create new file"}),I=c.intl.formatMessage({id:"o96TiK",defaultMessage:"Create"}),P=c.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),g=c.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),C=c.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"}),M=c.intl.formatMessage({id:"0rYKaW",defaultMessage:"Excel Workbook"}),S=c.intl.formatMessage({id:"e9uLbL",defaultMessage:"PowerPoint Presentation"}),f=c.intl.formatMessage({id:"yY5byF",defaultMessage:"Word Document"}),D=c.intl.formatMessage({id:"neBk7u",defaultMessage:"Dropbox Paper"}),F=c.intl.formatMessage({id:"Rvv7NR",defaultMessage:"Dropbox Paper Template"}),y=c.intl.formatMessage({id:"sbO30Y",defaultMessage:"Dropbox Binder (Beta)"}),N=c.intl.formatMessage({id:"4gEt6j",defaultMessage:"Shortcut"}),b=t.defineMessage({id:"5L+krI",defaultMessage:"Automated folder"}),v=()=>{const e=o.React$1.useRef(null),n=t.useIntl(),i={nodeType:"dropdown",actionType:s.ActionBarActionTypes.CREATE,menuItem:{type:s.ActionBarActionTypes.CREATE,menuItem:s.FolderCreationAction.AUTOMATED_FOLDER}};return o.react.exports.useEffect((()=>{E.getStoreForAutomations()}),[]),o.React$1.createElement(o.React$1.Fragment,null,o.React$1.createElement(t.Menu.ActionItem,{ref:e,onClick:()=>{l.logBrowseTTS("create_automated_folder")},value:i,withLeftAccessory:o.React$1.createElement(t.UIIcon,{src:a.AutomationLine})},n.formatMessage(b)))};var U;v.displayName="CreateAutomatedFolderAction";const w="dropbox_browse",G="CAPTURE_FILES_INTEGRATION_HAS_CREATED_CAPTURES_WITH_WEB_RECORDER",W="function"==typeof(null===(U=navigator.mediaDevices)||void 0===U?void 0:U.getDisplayMedia);e.CaptureTypes=void 0,(e.CaptureTypes||(e.CaptureTypes={})).CAPTURE="webm";const h=t.defineMessage({id:"gwLhQ3",defaultMessage:"Screen recording"});var B;!function(e){e[e.FOLDER=0]="FOLDER",e[e.SHARED_FOLDER=1]="SHARED_FOLDER",e[e.TEAM_FOLDER=2]="TEAM_FOLDER",e[e.AUTOMATED_FOLDER=3]="AUTOMATED_FOLDER",e[e.PAPER=4]="PAPER",e[e.PAPER_TEMPLATE=5]="PAPER_TEMPLATE",e[e.PAPER_BINDER=6]="PAPER_BINDER",e[e.SIMPLE_POINTER=7]="SIMPLE_POINTER",e[e.MICROSOFT_WORD=8]="MICROSOFT_WORD",e[e.MICROSOFT_EXCEL=9]="MICROSOFT_EXCEL",e[e.MICROSOFT_POWERPOINT=10]="MICROSOFT_POWERPOINT",e[e.GOOGLE_DOC=11]="GOOGLE_DOC",e[e.GOOGLE_SHEET=12]="GOOGLE_SHEET",e[e.GOOGLE_SLIDE=13]="GOOGLE_SLIDE",e[e.CAPTURE_SCREEN=14]="CAPTURE_SCREEN"}(B||(B={}));const x={[B.FOLDER]:{menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:s.FolderCreationAction.FOLDER},description:c.intl.formatMessage({id:"RW4ijB",defaultMessage:"Folder"}),icon:t.FolderLine}},[B.SHARED_FOLDER]:{condition:({showSharedFolderCreate:e})=>e,menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:s.FolderCreationAction.SHARED_FOLDER},className:t.classnames(t.OA_PULSAR_CLASS,t.OAPulsarAction.SHARED_FOLDER),description:c.intl.formatMessage({id:"7nnCz9",defaultMessage:"Shared folder"}),icon:n.AddFolderLine}},[B.TEAM_FOLDER]:{condition:({showTeamFolderCreate:e})=>e,menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:s.FolderCreationAction.TEAM_FOLDER},description:c.intl.formatMessage({id:"mfWC8r",defaultMessage:"New team folder"}),icon:i.TeamLine}},[B.AUTOMATED_FOLDER]:{condition:({showAutomatedFolderCreate:e})=>e,menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:s.FolderCreationAction.AUTOMATED_FOLDER},description:c.intl.formatMessage(b),icon:a.AutomationLine,menuItem:o.React$1.createElement(v,null)}},[B.PAPER]:{condition:({showPaperCreate:e})=>e,menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:t.PaperNewFileTypes.PAPER},description:D,icon:o.React$1.createElement(O,{displayName:D,iconName:"dropbox_paper"})}},[B.PAPER_TEMPLATE]:{condition:({showPaperCreate:e})=>e,menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:t.PaperNewFileTypes.PAPER_TEMPLATE},description:F,icon:o.React$1.createElement(O,{displayName:F,iconName:"dropbox_paper_template"})}},[B.PAPER_BINDER]:{condition:({showBinderCreate:e})=>e,menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:t.PaperNewFileTypes.PAPER_BINDER},description:y,icon:o.React$1.createElement(O,{displayName:y,iconName:"dropbox_paper_binder"})}},[B.SIMPLE_POINTER]:{menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:t.PointerFileTypes.SIMPLE_POINTER},description:N,icon:o.React$1.createElement(O,{displayName:N,iconName:"shortcut"})}},[B.MICROSOFT_WORD]:{menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:t.MicrosoftFileTypes.WORD},description:f,icon:o.React$1.createElement(O,{displayName:f,iconName:"microsoft_docx"})}},[B.MICROSOFT_EXCEL]:{menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:t.MicrosoftFileTypes.EXCEL},description:M,icon:o.React$1.createElement(O,{displayName:M,iconName:"microsoft_xlsx"})}},[B.MICROSOFT_POWERPOINT]:{menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:t.MicrosoftFileTypes.POWERPOINT},description:S,icon:o.React$1.createElement(O,{displayName:S,iconName:"microsoft_pptx"})}},[B.GOOGLE_DOC]:{menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:t.GoogleFileTypes.GOOGLE_DSS_DOC},description:P,icon:o.React$1.createElement(O,{displayName:P,iconName:"google_gdoc"})}},[B.GOOGLE_SHEET]:{menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:t.GoogleFileTypes.GOOGLE_DSS_SHEET},description:g,icon:o.React$1.createElement(O,{displayName:g,iconName:"google_gsheet"})}},[B.GOOGLE_SLIDE]:{menuItem:{value:{type:s.ActionBarActionTypes.CREATE,menuItem:t.GoogleFileTypes.GOOGLE_DSS_SLIDES},description:C,icon:o.React$1.createElement(O,{displayName:C,iconName:"google_gslides"})}},[B.CAPTURE_SCREEN]:{condition:({showCaptureCreate:e})=>e,menuItem:{description:c.intl.formatMessage(h),id:"action-bar-capture-sdk-recording",menuItem:o.React$1.createElement((()=>{const e=o.React$1.useRef(null),n=t.useDispatch(),a=t.useIntl(),i=t.useSelector(_.getRecorderState);return o.React$1.createElement(t.Menu.ActionItem,{ref:e,withLeftAccessory:o.React$1.createElement(t.UIIcon,{src:d.RecordScreenCameraLine}),onClick:()=>u.__awaiter(void 0,void 0,void 0,(function*(){var e;yield m.handleSafariWorkaround(),n(_.openRecorder(w,!0)),t.logWebUserAction({event_name:t.WebUserActionLogEvent.CAPTURE_SDK_FILES_MENU_SCREEN_RECORDING_CLICKED,user_id:null===(e=t.getUser())||void 0===e?void 0:e.id})})),disabled:i.active},o.React$1.createElement(t.Text,{color:i.active?"disabled":"standard"},a.formatMessage(h)))}),null),value:{type:s.ActionBarActionTypes.CAPTURE_SCREEN,menuItem:e.CaptureTypes.CAPTURE}}}},$=(e,t)=>e.map((e=>{const t=x[e],{menuItem:o}=t,n=o.description;return Object.assign(Object.assign({},t),{menuItem:Object.assign(Object.assign({},o),{description:n})})})).filter((({condition:e})=>!e||e(t))).map((({menuItem:e})=>e)),k=e=>{const{showOnlyFolderCreation:t}=e,o=(e=>({menuItems:$([B.FOLDER,B.SHARED_FOLDER,B.TEAM_FOLDER,B.AUTOMATED_FOLDER],e)}))(e).menuItems;return t||(o.push(...$([B.CAPTURE_SCREEN],e)),o.push({description:c.intl.formatMessage({id:"oKv5aq",defaultMessage:"Document"}),submenuSections:[{menuItems:$([B.PAPER,B.MICROSOFT_WORD,B.GOOGLE_DOC],e)}]},{description:c.intl.formatMessage({id:"/JpyiR",defaultMessage:"Presentation"}),submenuSections:[{menuItems:$([B.MICROSOFT_POWERPOINT,B.GOOGLE_SLIDE],e)}]},{description:c.intl.formatMessage({id:"9xjlyh",defaultMessage:"Spreadsheet"}),submenuSections:[{menuItems:$([B.MICROSOFT_EXCEL,B.GOOGLE_SHEET],e)}]}),o.push({description:c.intl.formatMessage({id:"rSeA97",defaultMessage:"More"}),submenuSections:[{menuItems:$([B.PAPER_TEMPLATE,B.PAPER_BINDER,B.SIMPLE_POINTER],e)}]})),{label:void 0,menuItems:o}};var H;e.UploadAction=void 0,(H=e.UploadAction||(e.UploadAction={})).UPLOAD_FILES="upload-files",H.UPLOAD_FOLDER="upload-folder";e.AsyncBrowseRecorder=e=>{const{isInsideMyTeamFolderTree:n,isInsideSharedFolder:a,isInsideTeamFolderTree:i,currentNSPath:s}=t.useSelector(t.context),r=t.useSelector(_.getRecorderState),E=t.useSelector(_.getUploadResult),[l,d]=o.react.exports.useState(!0),[m,A]=o.react.exports.useState(!1);o.react.exports.useEffect((()=>{u.__awaiter(void 0,void 0,void 0,(function*(){const o=(yield t.getUserMetadata([G],e.user.id))[G];d(!o)}))}),[e.user]),o.react.exports.useEffect((()=>{E&&E.source===w&&(l?(A(!0),d(!1),t.logWebUserAction({event_name:t.WebUserActionLogEvent.CAPTURE_SDK_FILES_DOWNLOAD_MODAL_SHOWN,user_id:e.user.id})):I())}),[E,e.user]);const R=()=>{t.logWebUserAction({event_name:t.WebUserActionLogEvent.CAPTURE_SDK_FILES_DOWNLOAD_CTA_CLICKED,user_id:e.user.id})},T=()=>{t.setUserMetadata({[G]:!0},e.user.id),A(!1),I()},{storagePath:O,uploadPath:L}=o.react.exports.useMemo((()=>{const o=!n&&!a&&!i,r=t.getUserRoot(t.Viewer.get_viewer(),e.user);return{storagePath:!o||null==s?`${r}/Capture`:window.location.pathname,uploadPath:o&&null!=s?s:"/Capture"}}),[n,a,i,s,e.user]),I=()=>{if(!E)return;const n=`${window.location.origin}${O}?preview=${encodeURIComponent(E.name)}`;t.Snackbar.show(o.React$1.createElement(t.Snackbar,{actionButtonText:c.intl.formatMessage({id:"g2XDDU",defaultMessage:"View recording"}),id:"capture-sdk-files-success",onActionClick:()=>{window.history.pushState({},"",n),t.logWebUserAction({event_name:t.WebUserActionLogEvent.CAPTURE_SDK_FILES_VIEW_RECORDING_CLICKED,user_id:e.user.id}),window.location.reload()},onTimeout:()=>{t.Snackbar.close("capture-sdk-files-success")},timeoutDelayMsForCompleteVariant:5e3,title:c.intl.formatMessage({id:"iZbi1W",defaultMessage:"Created {filename}"},{filename:E.name}),variant:"complete"}))};return r.active&&r.source===w?o.React$1.createElement(o.react.exports.Suspense,{fallback:null},o.React$1.createElement(p.AsyncRecorder,{source:w,uploadPath:L,user:e.user})):m?o.React$1.createElement(o.react.exports.Suspense,{fallback:null},o.React$1.createElement(p.AsyncDownloadCaptureModal,{onClose:T,onConfirm:R,open:m,source:w})):null},e.LongNewFileCreateLabel=L,e.NewFileIcon=O,e.NewGoogleDocsLabel=P,e.NewGoogleSheetsLabel=g,e.NewGoogleSlidesLabel=C,e.NewMicrosoftExcelWorkbookLabel=M,e.NewMicrosoftPowerPointPresentationLabel=S,e.NewMicrosoftWordDocLabel=f,e.NewPaperBinderDocLabel=y,e.NewPaperDocLabel=D,e.NewPaperTemplateLabel=F,e.NewSimplePointerLabel=N,e.PAP_Select_Upload=function(e){return{class:"manual_upload",action:"select",object:"upload",properties:e}},e.ShortNewFileCreateLabel=I,e.canUseRecorder=W,e.getCreateMenu=function(e){const t=[k(e)];return{type:s.ActionBarMenuType.DROPDOWN,menuSections:t}},e.getUploadMenu=function(){const n=function(){if(!R.is_input_webkitdirectory_supported())return;const n=[];return n.push({value:{type:s.ActionBarActionTypes.UPLOAD,menuItem:e.UploadAction.UPLOAD_FILES},description:c.intl.formatMessage({id:"LNFEFg",defaultMessage:"Files"}),icon:o.React$1.createElement(t.UIIcon,{src:A.UploadFileLine})},{value:{type:s.ActionBarActionTypes.UPLOAD,menuItem:e.UploadAction.UPLOAD_FOLDER},description:c.intl.formatMessage({id:"kMDxiK",defaultMessage:"Folder"}),icon:o.React$1.createElement(t.UIIcon,{src:A.UploadFolderLine})}),{menuItems:n}}();if(n)return{type:s.ActionBarMenuType.DROPDOWN,menuSections:[n]}},e.isUploadAction=t=>Boolean(t)&&Object.values(e.UploadAction).includes(t),e.newFileTypeToLogEvent=e=>{switch(e){case t.MicrosoftFileTypes.WORD:return t.WebUserActionLogEvent.FILE_CREATE_WORD;case t.MicrosoftFileTypes.EXCEL:return t.WebUserActionLogEvent.FILE_CREATE_EXCEL;case t.MicrosoftFileTypes.POWERPOINT:return t.WebUserActionLogEvent.FILE_CREATE_POWERPOINT;case t.GoogleFileTypes.GOOGLE_DSS_DOC:return t.WebUserActionLogEvent.FILE_CREATE_GOOGLE_DOC;case t.GoogleFileTypes.GOOGLE_DSS_SHEET:return t.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SHEET;case t.GoogleFileTypes.GOOGLE_DSS_SLIDES:return t.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SLIDES;case t.PaperNewFileTypes.PAPER:return t.WebUserActionLogEvent.FILE_CREATE_PAPER;case t.PaperNewFileTypes.PAPER_TEMPLATE:return t.WebUserActionLogEvent.FILE_CREATE_PAPER_TEMPLATE;case t.PaperNewFileTypes.PAPER_BINDER:return t.WebUserActionLogEvent.FILE_CREATE_BINDER;case t.PointerFileTypes.SIMPLE_POINTER:return t.WebUserActionLogEvent.FILE_CREATE_SIMPLE_POINTER}}}));
//# sourceMappingURL=c_pap-events_manual_upload_select_upload.js-vfl2TA9eY.map
