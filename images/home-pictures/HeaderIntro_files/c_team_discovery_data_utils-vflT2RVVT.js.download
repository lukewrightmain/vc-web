define(["exports","./c_core_i18n","./c_lodash-es_lodash","./e_ui_page_files_router","./c_growth_ui_teams_web_actions_logger_events","./e_edison"],(function(e,t,a,o,n,i){"use strict";var s,r,m,_,g;e.JoinApiResultEnum=void 0,(s=e.JoinApiResultEnum||(e.JoinApiResultEnum={})).RequestSent="request_sent",s.RequestNotSent="request_not_sent",s.CanJoin="can_join",function(e){e[e.Conflict=5]="Conflict"}(r||(r={})),e.JoinApiV2RetReason=void 0,(m=e.JoinApiV2RetReason||(e.JoinApiV2RetReason={})).ExistsSameTeam="exists_same_team",m.ExistsDifferentTeam="exists_different_team",m.Conflict="conflict",m.MaxTeamSizeAchieved="max_team_size_achieved",m.Rejected="rejected",m.Other="other",e.RequestState=void 0,(_=e.RequestState||(e.RequestState={})).Sending="sending",_.PendingApproval="pending_approval",_.Joined="joined",e.Pages=void 0,(g=e.Pages||(e.Pages={})).Suggest="TeamDiscovery/Suggest",g.Confirm="TeamDiscovery/Confirm";const d=["standard","enterprise","limited"];function l(e){return d.find((t=>t===(null==e?void 0:e.toLowerCase())))}const u=["basic"];const c=(e,t,a,i=!0)=>{switch(i&&o.TeamsWebActionsLogger.log(e,a),e){case n.TeamJoinerLoggerEvents.SETUP_RENDER:{const{module_name:e,step:n}=a;o.logEvent({class:"onboard",action:"shown",object:"team_joiner_setup_step",properties:{actionSurface:t,moduleName:e,teamJoinerStepName:n}});break}case n.TeamJoinerLoggerEvents.SAW_TEAM_PROMO_PAGE:{const{verified:e,has_pending_invite:n,has_outstanding_request:i,has_approved_request:r,num_auto_join:m,num_ask_to_join:_,page_type:g,user_plan_type:d,team_id:l,team_type:c}=a;o.logEvent(function(e){return{class:"onboard",action:"shown",object:"team_promo_page",properties:e}}({actionSurface:t,isVerified:e,teamPromoHasPendingInvite:n,teamPromoHasOutstandingRequest:i,teamPromoHasApprovedRequest:r,teamPromoNumAutoJoin:m,teamPromoNumAskToJoin:_,teamPromoPageType:g,teamPromoPageUserPlanType:(s=d,u.find((e=>e===(null==s?void 0:s.toLowerCase())))),teamPromoTeamTypes:(null==c?void 0:c.join(","))||"",joinableTeamIds:(null==l?void 0:l.join(","))||""}));break}case n.TeamJoinerLoggerEvents.CLICKED_ACCEPT_INVITE:{const{team_id:e,team_type:n}=a;o.logEvent(function(e){return{class:"onboard",action:"select",object:"accept_invite",properties:e}}({actionSurface:t,joinableTeamId:e,teamType:l(n)}));break}case n.TeamJoinerLoggerEvents.CLK_COMBINE:{const{step:e}=a;o.logEvent(function(e){return{class:"onboard",action:"select",object:"combine_account",properties:e}}({actionSurface:t,teamJoinerStepName:e}));break}case n.TeamJoinerLoggerEvents.CLK_CREATE_NEW:{const{step:e}=a;o.logEvent(function(e){return{class:"onboard",action:"select",object:"create_new_account",properties:e}}({actionSurface:t,teamJoinerStepName:e}));break}}var s},p="clicked_req_to_join";var f,T,v;e.TeamJoinRequestOrigin=void 0,(f=e.TeamJoinRequestOrigin||(e.TeamJoinRequestOrigin={})).Signup="signup",f.Preview="preview",f.Requests="requests",f.Pass="pass",f.ExistingViralInband="existing_viral_inband",f.SignupViralInband="signup_viral_inband",f.SignupViralLinksharing="signup_viral_linksharing",f.SurfaceExistingTeamHomepage="surface_existing_teams_homepage",f.ShareRequestAccessPage="share_request_access_page",f.TeamDiscoveryPageRefresh="team_discovery_page_refresh",e.TeamSuggestPageDesign=void 0,(T=e.TeamSuggestPageDesign||(e.TeamSuggestPageDesign={})).New="new",T.Old="old",function(e){e.TEAM_DISCOVERY="team_discovery"}(v||(v={}));e.JoinApiRetReasonToLabel=function(e){return{request_sent:t.intl.formatMessage({id:"sQbTsQ",defaultMessage:"Request sent. Once it’s approved, you’ll get an invite from the team."}),exists_same_team:t.intl.formatMessage({id:"oZNXJZ",defaultMessage:"Looks like you’ve already asked to join this team."}),exists_different_team:t.intl.formatMessage({id:"mHIpiE",defaultMessage:"Looks like you already asked to join a different team."}),rejected:t.intl.formatMessage({id:"H8TlMC",defaultMessage:"Looks like this team already denied your request."}),max_team_size_achieved:t.intl.formatMessage({id:"dEJ+SP",defaultMessage:"Looks like this team size has already been reached"})}[e]||t.intl.formatMessage({id:"s86tt6",defaultMessage:"Couldn’t send request. Try asking to join in person."})},e.Logger=class{logAskToJoinEvent(e){const{teamId:t,userId:a,joinState:n,reason:i,origin:s,team_index:r,url:m,design:_,signupTag:g,preselectTeamId:d,numAskToJoin:l,numAutoJoin:u}=e;o.TeamsWebActionsLogger.log(p,{team_id:t,user_id:a,url:m,join_state:n,reason:i,origin:s,design:_,signup_tag:g,preselect_team_id:d,team_index:r+1,num_ask_to_join:l,num_auto_join:u})}logAskToJoinErrorEvent(e,t,a,n,i){o.TeamsWebActionsLogger.log("requested_access_to_team_error",{team_id:e,user_id:t,url:"team/discover/suggest",join_state:a,reason:n,origin:i})}logAcceptInvitation(e){c(n.TeamJoinerLoggerEvents.CLICKED_ACCEPT_INVITE,"team_discovery_page",{team_id:e})}logTeamDiscoveryPageSeen(e,t,a){let i={};const s=[],r=[],m=[],_=[];for(const t of e)"request_approved"===t.joinTeamRequestState[".tag"]?s.push(t):"waiting_for_approval"===t.joinTeamRequestState[".tag"]?r.push(t):"can_auto_join"===t.joinTeamRequestState[".tag"]?m.push(t):"approval_required"===t.joinTeamRequestState[".tag"]&&_.push(t);i={has_pending_invite:!!t,has_outstanding_request:r.length>0,has_approved_request:s.length>0,num_auto_join:m.length,num_ask_to_join:_.length,verified:a,_tk:o.get_pathname(),url:o.get_uri().toString()},o.TeamsWebActionsLogger.log_for_category(n.TeamJoinerLoggerEvents.SAW_TEAM_PROMO_PAGE,o.TeamsWebActionsLogger.LOG_CATEGORY.PROMO_TEAMS,i),c(n.TeamJoinerLoggerEvents.SAW_TEAM_PROMO_PAGE,"team_discovery_page",i,!1)}logClickCancelJoinRequest(t,a){o.TeamsWebActionsLogger.log("cancel_request_to_join",{num_team_members:a,origin:e.TeamJoinRequestOrigin.TeamDiscoveryPageRefresh,source:"team_discovery_page",team_id:t})}logClickStartNewTeamLink(){o.TeamsWebActionsLogger.log("clicked_create_team_cta")}logEmailVerificationModalShown(e,t){o.TeamsWebActionsLogger.log("email_verification_modal_shown",{user_id:e,team_id:t})}logEmailVerifiedSnackbarShown(e){o.TeamsWebActionsLogger.log("email_verified_snackbar_shown",{user_id:e})}logContinueToInstallEvent(e,t=!1){o.TeamsWebActionsLogger.log("surface_existing_team_continue_to_install",{user_id:e,url:"team/discover/suggest",is_cancel:t},(()=>{}),e)}logExposedToSETOnPreviewEvent(e,t,a,n,i,s,r){o.TeamsWebActionsLogger.log("exposed_to_set_on_preview",{team_id:i,user_id:e,url:"scl/fi/:sckey/:file_name",is_cdm_member:t,user_root_permissions:a,team_member_count:s,saw_ask_to_join:n,is_new_user:r},(()=>{}),e)}logClickedRequestToJoinEvent(e,t,a,n){o.TeamsWebActionsLogger.log(p,{team_id:e,user_id:t,url:"scl/fi/:sckey/:file_name",origin:a,is_new_user:n},(()=>{}),t)}logExposedToSETOnSignupPage(t,a,n,i,s,r,m,_){o.TeamsWebActionsLogger.log("exposed_to_set_on_signup_page",{design:e.TeamSuggestPageDesign.New,origin:a,signup_tag:n,number_of_teams:i,preselect_team_id:s,member_to_fetch_limit:r,first_team_same_domain:m,first_team_tc:_},(()=>{}),t)}logExposedToSETOnSignupPageLoadingScreen(e,t){o.TeamsWebActionsLogger.log("exposed_to_set_on_signup_page_loading",{origin:t},(()=>{}),e)}logUserSelectedJoinableTeam(e,t,a,o,n){this._logUserJoinableTeamChoice("user_selected_joinable_team",e,t,a,o,n)}logUserUnselectedJoinableTeam(e,t,a,o,n){this._logUserJoinableTeamChoice("user_unselected_joinable_team",e,t,a,o,n)}_logUserJoinableTeamChoice(t,a,n,i,s,r){o.TeamsWebActionsLogger.log(t,{team_id:a,design:e.TeamSuggestPageDesign.New,origin:i,signup_tag:s,preselect_team_id:r},(()=>{}),n)}},e.getAdminNamesStrForTeam=function(e,a){return function(e,a,o){const n=t.intl.formatMessage({id:"Om3b8J",defaultMessage:"{remainder, plural, =0{{adminName}} one{{adminName} + {remainder} more} few{{adminName} + {remainder} more} other{{adminName} + {remainder} more}}"},{adminName:e,remainder:a-1});return o?t.intl.formatMessage({id:"LQZIyx",defaultMessage:"{teamAdminCount, plural, one{Admin: {adminList}} other{Admins: {adminList}}}"},{teamAdminCount:a,adminList:n}):t.intl.formatMessage({id:"T2wYhx",defaultMessage:"{teamAdminCount, plural, one{Team admin: {adminList}} other{Team admins: {adminList}}}"},{teamAdminCount:a,adminList:n})}(function(e){const t=e.members.find((e=>e.isAdmin));if(void 0===t)throw new Error("No admin on team given to team card");return t.name}(e),e.adminsCount,a)},e.getLastShareTimeStr=function(e){return t.intl.formatMessage({id:"1Yl7QT",defaultMessage:"Last worked together {lastShareDate, date, medium}"},{lastShareDate:new Date(1e3*e)})},e.getSharedContentCountsText=function(e){var a,o;const n=(null!==(a=e.sharedFolderCount)&&void 0!==a?a:0)>0,i=(null!==(o=e.sharedFileCount)&&void 0!==o?o:0)>0,{sharedContextText:s,getFolderInfoText:r,getFileInfoText:m}={sharedContextText:t.intl.formatMessage({id:"VbL6qJ",defaultMessage:"Shared with you:"}),getFolderInfoText:e=>t.intl.formatMessage({id:"RUN5MW",defaultMessage:"{folderCount, plural, one {# folder} other {# folders}}"},{folderCount:e.sharedFolderCount}),getFileInfoText:e=>t.intl.formatMessage({id:"7Ql6Hu",defaultMessage:"{fileCount, plural, one {# file} other {# files}}"},{fileCount:e.sharedFileCount})};return n&&i?`${s} ${r(e)}, ${m(e)}`:n?`${s} ${r(e)}`:i?`${s} ${m(e)}`:null},e.preselectTeam=function(e,t,a){const o=e[0],n=1===e.length,i=t&&a&&o&&o.dbxTeamId===a;return n||i?o:void 0},e.toFacepileMember=function(e){return{memberKey:e.memberId.toString(),active:!0,alt:null,avatarColorSeed:e.memberId.toString(),initials:e.name.charAt(0),photoUrl:void 0===e.avatarURL?null:e.avatarURL,tooltipContent:i.React$1.createElement("div",null,e.name)}},e.toJoinableTeam=function(t){return{dbxTeamId:t.dbx_team_id,id:t.team_id,name:t.team_name,adminsCount:t.admins_count,membersCount:t.members_count,requestState:t.pending_request?e.RequestState.PendingApproval:void 0,joinTeamRequestState:t.join_request_state,joinRequestStateDate:t.join_request_state_date,isSameDomain:t.is_same_domain,isCollaborator:t.is_collaborator,sharedFolderCount:t.shared_folder_count,sharedFileCount:t.shared_file_count,lastShareTimestamp:t.last_share_timestamp,members:a.map(t.members,(e=>({memberId:e.member_id,name:e.member_name,isAdmin:e.is_admin,avatarURL:e.photo_url})))}}}));
//# sourceMappingURL=c_team_discovery_data_utils.js-vflkVNRc_.map
