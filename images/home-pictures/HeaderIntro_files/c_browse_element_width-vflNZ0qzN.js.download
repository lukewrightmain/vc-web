define(["require","exports","./e_ui_page_files_router","./e_edison","./c_spectrum_media_table_skeleton","./c_spectrum_media_table_media_cell","./c_spectrum_dimensions","./c_spectrum_vertically_fixed","./c_tslib","./c_core_browser_detection","./c_lodash-es_lodash","./c_controls_index","./c_ui-icon_line_arrow-down","./c_ui-icon_line_arrow-up","./c_core_i18n","./c_campaigns_campaigns_element_id_enum","./c_src_table","./c_combinations_index","./c_files_view_keyboard_shortcuts","metaserver/static/js/modules/constants/web_experience_constants","./c_files_view_files_view_logging","./c_spectrum_util_raf_throttle","./c_core_uri","./c_starred_actions","./c_starred_constants","./c_starred_star","./c_ui_selectable_list","./c_filename_highlights","./c_browse_interface","./c_ui_title_bubble","./c_ui_overlay","./c_src_highlighted-truncated-string_index","./c_files_view_file_thumbnail","./c_tagging_components_tags_container","./c_sync_everything_utils_deep_link_utils","./e_core_exception","./c_core_exception_info","./c_extensions_split_share_button","./c_ui-icon_line_more-horizontal","./c_vault_constants","./c_icon_file_folder_icon","./c_resize-observer-polyfill_dist_ResizeObserver","./c_spectrum_culled_list","./c_icon_file_icon","./c_aspect_ratio_index","./c_src_common_file","./c_ui-icon_line_more-vertical","./c_truncate_index","./c_core_notify"],(function(e,t,i,s,a,n,l,o,r,c,d,h,u,p,m,g,f,S,b,E,T,w,_,C,R,F,v,I,N,D,y,M,L,O,k,x,A,$,P,H,W,V,B,z,U,G,K,j,q){"use strict";function Y(e,t,s){const a=e.map((e=>e.sortField)).indexOf(t),n=e.map((e=>e.sortField)).indexOf(s);if(a===n||-1===a||-1===n)return e;const l=e[a],o=e[n];return i.splice(i.splice(e,a,1,o),n,1,l)}const X={columnResizingEnabled:!1,columnSizes:i.COLUMN_DEFAULT_WIDTHS,resizeColumn:function(e,t){},resizeColumnToDefault:function(e){}},J=s.React$1.createContext(X);function Z(e,t){const s=i.COLUMN_MIN_WIDTHS[t],a=i.COLUMN_MAX_WIDTHS[t];return Math.min(Math.max(e,s),a)}function Q(e){return d.mapValues(e,((e,t)=>Z(e,t)))}const ee=d.debounce((function(e,t){window.localStorage.setItem(e,JSON.stringify(t))})),te={type:"no_storage"},ie=e=>{const t=s.React$1.useRef(e);return t.current=e,t},se=({children:e,storageSetting:t,columnResizingEnabled:a,scrollContainerWidth:n,visibleColumns:l,visibleColumnsViewChange:o,isSearchMode:r})=>{const[h,u]=s.React$1.useState((()=>{switch(t.type){case"no_storage":return i.COLUMN_DEFAULT_WIDTHS;case"local_storage":return function(e){try{const t=window.localStorage.getItem(e),s=JSON.parse(t);return d.mapValues(i.COLUMN_DEFAULT_WIDTHS,((e,t)=>{const i=s[t];return"number"==typeof i?i:e}))}catch(e){return i.COLUMN_DEFAULT_WIDTHS}}(t.localStorageKey)}})),p=ie(h),m=ie(n),g=s.React$1.useRef("UNFROZEN"),f=s.React$1.useRef(c.safari);s.React$1.useEffect((()=>{if(a&&n&&n>0){if(f.current&&!r)return void(f.current=!1);const e=S(h),t="UNFROZEN"===g.current||"OVERFLOW"===g.current&&n>e||"UNDERFLOW"===g.current&&n<e;e>0&&n!==e&&t&&b(i.SortField.FILENAME,n-(e-h[i.SortField.FILENAME]),"DYNAMIC")}}),[n,o]);const S=e=>{let t=0;return l.map((e=>e.sortField)).forEach((i=>{t+=e[i]})),t},b=s.React$1.useCallback(((e,i,s="MANUAL")=>{if(p.current[e]!==i){const a=Object.assign(Object.assign({},p.current),{[e]:Z(i,e)});u(a),"local_storage"===t.type&&ee(t.localStorageKey,a),"MANUAL"===s&&m.current?g.current=S(a)>m.current?"OVERFLOW":"UNDERFLOW":"DYNAMIC"===s&&(g.current="UNFROZEN")}}),[t,p,m]),E=s.React$1.useCallback((e=>{const t=i.COLUMN_DEFAULT_WIDTHS[e];b(e,t)}),[b]),T=s.React$1.useMemo((()=>({columnSizes:Q(h),resizeColumn:b,resizeColumnToDefault:E,columnResizingEnabled:a})),[h,b,E,a]);return s.React$1.createElement(J.Provider,{value:T},e)};se.displayName="ColumnResizingProvider",se.displayName="ColumnResizingProvider";const ae=e=>{var{responsiveContainer:t}=e,i=r.__rest(e,["responsiveContainer"]);return(i.isMatchedLarge||i.isMatchedMedium)&&t?s.React$1.createElement(l.Dimensions,null,(({width:e})=>{const t=Object.assign({},i);return e&&(t.isMatchedLarge=e>824,t.isMatchedMedium=!t.isMatchedLarge&&e>588),s.React$1.createElement(ne,Object.assign({},t,{containerWidth:e}))})):s.React$1.createElement(ne,Object.assign({},i))};ae.displayName="ColumnManager";const ne=e=>{const[t,a]=s.React$1.useState((()=>e.preferredColumns?p(e):function(e){return e.columns.slice(0,S(e))}(e))),[n,l]=s.React$1.useState(e.viewType),[o,r]=s.React$1.useState((()=>b(t))),c=s.React$1.useRef(),h=s.React$1.useRef(),u=i.usePrevious(e);function p(e){const{currentSort:t,viewType:s,preferredColumns:a}=e;let n=a;if(s===i.ViewType.Grid||s===i.ViewType.LargeGrid){const e=n.find((e=>e.sortField===t.sortField));n=[e||n[0]]}else n=n.slice(0,S(e));return n}function m(t,i=!1){const s=b(t);a(t),r(s),i?c.current=setTimeout((()=>{g(),e.onCanDisplayFolderSizesChanged(s)})):e.onCanDisplayFolderSizesChanged(s)}s.React$1.useEffect((()=>{if(!u)return void e.onCanDisplayFolderSizesChanged(o);if(e.viewType!==u.viewType&&l(e.viewType),e.preferredColumns){const i=p(e);return void(d.isEqual(i,t)||m(i,!0))}const{columns:s,currentSort:n}=e,c=S(u),g=S(e);if(d.isEqual(e.columns,u.columns)&&e.viewType===u.viewType){if(g<c)m(t.slice(0,g),!0);else if(g>c){const e=g-t.length,i=d.filter(s,(e=>!d.find(t,(t=>t.sortField===e.sortField)))).slice(0,e);m([...t,...i],!0)}}else if(1===g&&s.length&&n){const{viewType:t,viewTypeColumns:l}=e,o=l?l[i.ViewType.Grid]:void 0;switch(t){case i.ViewType.List:case i.ViewType.CondensedList:m([s[0]],!0);break;case i.ViewType.Grid:case i.ViewType.LargeGrid:if(o){const i=s.find((e=>e.sortField===n.sortField))||s[0];!function(t,i,s){f();const n=b(t);a(t),r(n),h.current=setTimeout((()=>{f(),e.onColumnsChanged({columns:i,viewType:s,canDisplayFolderSizes:n})}))}([i],Y(o,o[0].sortField,i.sortField),t)}}}else m(s.slice(0,g),!0)}),[e.columns,e.viewType,e.isMatchedLarge,e.isMatchedMedium,e.numVisibleColumns,e.preferredColumns]);const g=()=>{c.current&&(clearTimeout(c.current),c.current=void 0)};function f(){h.current&&(clearTimeout(h.current),h.current=void 0)}function S(e){const{isMatchedLarge:t,isMatchedMedium:s,viewType:a,numVisibleColumns:n,isMoreColumnsEnabled:l,isSearchMode:o}=e;switch(a){case i.ViewType.Grid:case i.ViewType.LargeGrid:return 1;case i.ViewType.List:case i.ViewType.CondensedList:default:return l?o?3:n||3:t?3:s?2:1}}function b(e){return e.some((e=>e.sortField===i.SortField.SIZE))}const{children:E,containerWidth:T}=e;if(!E)return null;let w=E;return"function"==typeof E&&(w=E({visibleColumns:t,canDisplayFolderSizes:o,handleSelection:function(s,a){const{isMoreColumnsEnabled:n,preferredColumns:l,viewType:o}=e;n&&l&&(o===i.ViewType.List||o===i.ViewType.CondensedList)?function(s,a,n){const{onColumnsChanged:l,viewType:o}=e,r=t.indexOf(s),c=t.includes(a)?t.indexOf(a):t.length-1,d=r>=0?i.splice(t,r,1):i.splice(t,c+1,0,s);m(d),l({columns:[...d,...n.filter((e=>!d.includes(e)))],viewType:o,canDisplayFolderSizes:b(d),numVisibleColumns:d.length})}(s,a,l):function(s,a){const{viewType:n,onColumnsChanged:l,viewTypeColumns:o,preferredColumns:r}=e,c=r||(o?o[i.ViewType.List]:void 0),d=o?o[i.ViewType.Grid]:void 0;if(c&&d){const e=t.indexOf(a);if(-1===e||t.includes(s))m(t);else{const o=i.splice(t,e,1,s);m(o);const h=b(o);n===i.ViewType.List||n===i.ViewType.CondensedList?l({columns:Y(c,a.sortField,s.sortField),viewType:i.ViewType.List,canDisplayFolderSizes:h}):(r||l({columns:Y(d,a.sortField,s.sortField),viewType:n,canDisplayFolderSizes:h}),s.sortField!==i.SortField.FILENAME&&l({columns:Y(c,c[1].sortField,s.sortField),viewType:i.ViewType.List,canDisplayFolderSizes:h}))}}}(s,a)},handleReorder:function(s,a){const{preferredColumns:n,onColumnsChanged:l,viewType:o}=e;if(!n||!t[s]||!t[a])return;const r=i.splice(i.splice(t,a,1),s,0,t[a]);m(r),l({columns:[...r,...n.filter((e=>!r.includes(e)))],viewType:o,canDisplayFolderSizes:b(r),numVisibleColumns:r.length})},containerWidth:T})),s.React$1.createElement(se,{storageSetting:e.columnResizeStorageSetting||te,columnResizingEnabled:!!e.isMoreColumnsEnabled,scrollContainerWidth:e.scrollContainerWidth,visibleColumns:t,visibleColumnsViewChange:n,isSearchMode:e.isSearchMode},w)},le=s.React$1.createContext({draggedIndex:null,setDraggedIndex:()=>{},onReorder:()=>{}}),oe=({onReorder:e,children:t})=>{const[i,a]=s.react.exports.useState(null);return s.React$1.createElement(le.Provider,{value:{draggedIndex:i,setDraggedIndex:a,onReorder:e}},t)};oe.displayName="DraggableReorderProvider",oe.displayName="DraggableReorderProvider";function re(e){return e===i.SortDirection.ASCENDING?"ascending":e===i.SortDirection.DESCENDING?"descending":"none"}const ce=(e,t)=>i=>{i.getModifierState("Alt")&&"ArrowLeft"===i.key&&e(),i.getModifierState("Alt")&&"ArrowRight"===i.key&&t()},de=({column:e,sortDirection:t,setSort:a,onDecreaseSize:n,onIncreaseSize:l})=>{const{columnResizingEnabled:o}=s.React$1.useContext(J);return e.isSortDisabled||e.isSortOrderOptionDisabled?s.React$1.createElement(i.Text,{variant:"label",isBold:void 0!==t,className:i.classnames("files-view-column-header-unclickable","files-view-column-header-text",{"column-resizing-enabled":o}),tabIndex:o?0:void 0,onKeyDown:ce(n,l)},e.label):s.React$1.createElement(i.Button,{variant:"transparent",hasNoUnderline:!0,onClick:()=>a(e.sortField,t===i.SortDirection.ASCENDING?i.SortDirection.DESCENDING:i.SortDirection.ASCENDING),className:i.classnames("files-view-column-header-text",{"column-resizing-enabled":o}),onKeyDown:ce(n,l)},s.React$1.createElement(i.Text,{variant:"label",isBold:void 0!==t},e.label),t&&s.React$1.createElement(i.UIIcon,{src:t===i.SortDirection.ASCENDING?p.ArrowUpLine:u.ArrowDownLine,size:"small",className:"files-view-column-header-sort-button"}))};de.displayName="ColumnHeaderCellContent",de.displayName="ColumnHeaderCellContent";const he=e=>{var{index:t,className:a}=e,l=r.__rest(e,["index","className"]);const o=(e=>{const{draggedIndex:t,setDraggedIndex:a,onReorder:n}=s.react.exports.useContext(le),[l,o]=s.react.exports.useState(!1),r=s.react.exports.useRef(null),c=t===e,d=null!==t&&!c;return{draggable:!0,onDragStart:s.react.exports.useCallback((t=>{t.dataTransfer&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="move"),a(e)}),[e]),onDragEnd:s.react.exports.useCallback((e=>{e.preventDefault(),e.stopPropagation(),a(null)}),[]),onDragEnter:s.react.exports.useCallback((e=>{d&&(e.preventDefault(),e.stopPropagation(),o(!0),r.current=e.target)}),[d]),onDragLeave:s.react.exports.useCallback((e=>{e.target===r.current&&(e.preventDefault(),e.stopPropagation(),o(!1))}),[]),onDrop:s.react.exports.useCallback((i=>{d&&null!==t&&(i.preventDefault(),i.stopPropagation(),a(null),o(!1),n(e,t))}),[e,d,t,n]),className:i.classnames("draggable-reorder",{"draggable-reorder--dragging":c,"draggable-reorder--dragged-over-from-right":l&&null!==t&&t-e>0,"draggable-reorder--dragged-over-from-left":l&&null!==t&&t-e<0})}})(t),{className:c}=o,d=r.__rest(o,["className"]);return s.React$1.createElement(n.TableHeadCell,Object.assign({className:i.classnames(a,c)},l,d))};he.displayName="DraggableTableHeadCell";const ue=({children:e,column:t,index:i,role:a,setSort:l,sortDirection:o,canMove:r,onDecreaseSize:c,onIncreaseSize:d})=>{const h=s.React$1.useContext(J);let u;h.columnResizingEnabled&&(u=h.columnSizes[t.sortField]);const p=void 0===u?{}:{width:u,minWidth:u,maxWidth:u},m={key:i,role:a,scope:"col","aria-sort":re(o),className:"files-view-column-header-table-cell",style:p,children:s.React$1.createElement(s.React$1.Fragment,null,s.React$1.createElement(de,{column:t,sortDirection:o,setSort:l,onDecreaseSize:c,onIncreaseSize:d}),e)};return r?s.React$1.createElement(he,Object.assign({index:i},m)):s.React$1.createElement(n.TableHeadCell,Object.assign({},m))};var pe;ue.displayName="ColumnHeaderCell",ue.displayName="ColumnHeaderCell",function(e){e.TAGS_COLUMN_TOOLTIP_SEEN="tags_column_tooltip_seen"}(pe||(pe={}));class me extends i.GrowthUserActionTracker{constructor(){super(...arguments),this.project="manual_tagging"}}const ge=s.React$1.memo((({showTooltip:e,setShowTooltip:t,triggerRef:a})=>{const[n,l]=s.React$1.useState("bottom"),o=i.useIntl(),{columnSizes:c}=s.React$1.useContext(J),d=s.React$1.useRef(null),h=c[i.SortField.FILENAME];s.React$1.useEffect((()=>{var e;null===(e=null==d?void 0:d.current)||void 0===e||e.update()}),[h]),s.React$1.useEffect((()=>{(function(){var e;return r.__awaiter(this,void 0,void 0,(function*(){const t=i.Viewer.get_viewer(),s=null!==(e=t.work_user)&&void 0!==e?e:t.personal_user;if(!s)return!0;const a=new i.DefaultUserApiV2Client(s),n=new me(s.id);return(yield a.ns("growth").rpc("performed_user_action",{project:n.project,action:pe.TAGS_COLUMN_TOOLTIP_SEEN},{})).has_performed}))})().then((e=>t(!e)))}),[t]);const u=()=>{t(!1),l("bottom")};return s.React$1.createElement(i.ClickOutside,{isActive:e,onClickOutside:u},s.React$1.createElement(i.Tooltip.Control,{variant:"rich",open:e,ref:d,triggerRef:a,auto:!0,placement:n,onChangePlacement:e=>l(e),onDisplayed:()=>{!function(){var e;r.__awaiter(this,void 0,void 0,(function*(){const t=i.Viewer.get_viewer(),s=null!==(e=t.work_user)&&void 0!==e?e:t.personal_user;if(s)return new me(s.id).track(pe.TAGS_COLUMN_TOOLTIP_SEEN)}))}()}},s.React$1.createElement(i.Title,{size:"standard",inverse:!0},o.formatMessage({id:"+NJwpB",defaultMessage:"Show tags here"})),s.React$1.createElement(i.Text,{tagName:"p",color:"standard",inverse:!0},o.formatMessage({id:"7uh+Vn",defaultMessage:"To see all these files’ tags at a glance, just click the arrow and choose “tags” from the list."})),s.React$1.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",marginTop:"var(--spacing__unit--2)"}},s.React$1.createElement(i.Button,{variant:"outline",inverse:!0,onClick:u,autoFocus:!0},o.formatMessage({id:"5LJHki",defaultMessage:"Got it"})))))}));ge.displayName="TagsColumnTooltip";var fe;!function(e){e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.BOTH=3]="BOTH"}(fe||(fe={}));const Se=({columns:e,index:t,onSelection:a,onMenuOpen:n,selectedColumns:l,title:o,allowUnchecking:r,availableMoves:c,isSearchMode:d})=>{const h=[fe.BOTH,fe.LEFT].includes(c),u=[fe.BOTH,fe.RIGHT].includes(c),p=h||u,[g,f]=s.React$1.useState(!1),S=i.useSelector(i.manualTaggingVariant),b=0===t&&!d&&i.isTagsColumnOnBrowseEnabled(S);return s.React$1.createElement(i.Menu.Wrapper,{onSelection:e=>a(t,e),onToggle:({isOpen:e})=>e&&n(t,l[t].popoverTriggerLabel)},(({getContentProps:t,getTriggerProps:a,triggerRef:n})=>s.React$1.createElement(s.React$1.Fragment,null,s.React$1.createElement(i.IconButton,Object.assign({},a(),{variant:"transparent",size:"small","aria-label":m.intl.formatMessage({id:"+D26UW",defaultMessage:"Change column"}),className:i.classnames("files-view-column-header-menu-button",{"files-view-column-header-menu-open":t().open||g}),"data-testid":"files-view-column-header-menu-trigger"}),s.React$1.createElement(i.UIIcon,{src:i.ChevronDownLine,size:"small"})),s.React$1.createElement(i.Menu.Content,Object.assign({},t(),{placement:"bottom-end"}),s.React$1.createElement(i.Menu.Segment,{withLabel:o},e.map((e=>s.React$1.createElement(i.Menu.SelectItem,{"aria-label":e.popoverTriggerLabel,key:e.popoverTriggerLabel,value:{type:"ColumnSelection",payload:e},selected:l.includes(e),disabled:e.isLocked||!r&&l.includes(e)},e.label)))),p&&s.React$1.createElement(i.Menu.Segment,{withLabel:m.intl.formatMessage({id:"Yzabjr",defaultMessage:"Adjust"})},s.React$1.createElement(i.Menu.Submenu,{withTriggerContent:m.intl.formatMessage({id:"qKy/7I",defaultMessage:"Column order"})},s.React$1.createElement(i.Menu.Segment,null,s.React$1.createElement(i.Menu.ActionItem,{value:{type:"ColumnOrderSelection",payload:"left"},disabled:!h},m.intl.formatMessage({id:"obFNpg",defaultMessage:"Move left"})),s.React$1.createElement(i.Menu.ActionItem,{value:{type:"ColumnOrderSelection",payload:"right"},disabled:!u},m.intl.formatMessage({id:"7QBrxY",defaultMessage:"Move right"})))))),b&&s.React$1.createElement(ge,{showTooltip:g,setShowTooltip:f,triggerRef:n}))))};Se.displayName="ColumnHeaderMenu";const be=()=>s.React$1.createElement("span",{"aria-hidden":!0},"--");function Ee(e){switch(i.isFile(e)?i.split_filename(e.fq_path).ext:e.ext.slice(1)){case i.PaperFileTypes.PAPER:case i.PaperFileTypes.PAPER_TEMPLATE:return!0;default:return!1}}const Te=s.React$1.lazy((()=>r.__awaiter(void 0,void 0,void 0,(function*(){return{default:(yield new Promise((function(t,i){e(["./c_rows_cells_folder_size"],t,i)}))).FolderSizeCell}})))),we=e=>{const{file:t}=e;return t.is_dir?s.React$1.createElement(s.React$1.Suspense,{fallback:s.React$1.createElement(be,null)},s.React$1.createElement(Te,{file:t},s.React$1.createElement(be,null))):t.is_cloud_doc&&Ee(t)?s.React$1.createElement(be,null):s.React$1.createElement("span",null,t.size)},_e=e=>14*new i.Emstring(e).length,Ce=({items:e,onResize:t,onResizeToDefault:a,onColumnResizeEnd:n,sortField:l})=>{const o=s.React$1.useRef({type:"not_resizing"}),[r,c]=s.React$1.useState();s.React$1.useRef(t).current=t;const d=s.React$1.useCallback((e=>{if("resizing"===o.current.type){const{startingPageX:i,startingWidth:s}=o.current,a=s-(i-e.pageX);a!==s&&t(a)}}),[]),h=s.React$1.useCallback((e=>{window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",h),o.current={type:"not_resizing"},c(void 0),n()}),[]),u=e=>{e.preventDefault(),window.document.removeEventListener("click",u,!0)},p=()=>{let t=0;const s="--";null==e||e.forEach((e=>{if(e instanceof i.File)switch(l){case i.SortField.CATEGORY:t=Math.max(_e(i.File.getCategoryDescription(e)),t);break;case i.SortField.EXTENSION:t=Math.max(_e(i.File.getExtension(e)),t);break;case i.SortField.FILENAME:t=Math.max(_e(i.getFilename(e)),t);break;case i.SortField.MODIFIED:case i.SortField.RELEVANCE:t=Math.max(_e(e.is_dir?s:e.ago),t);break;case i.SortField.SIZE:t=Math.max(_e(e.is_dir?s:e.size),t)}else if(e instanceof i.FileSharedWithMe)switch(l){case i.SortField.FILENAME:t=Math.max(_e(i.getFilename(e)),t);break;case i.SortField.MODIFIED:case i.SortField.RELEVANCE:t=Math.max(_e(e.agoFromLastActionByUserTs||e.ago),t);break;case i.SortField.SIZE:t=Math.max(_e(e.is_cloud_doc&&Ee(e)?s:e.size),t)}}));let a=30;return l===i.SortField.FILENAME&&(a=110),t>0?t+a:0};return s.React$1.createElement("div",{className:"resize-drag-handle",onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),window.addEventListener("mousemove",d),window.addEventListener("mouseup",h);const t=window.innerHeight-e.currentTarget.getBoundingClientRect().top-4-16;o.current={type:"resizing",startingWidth:e.currentTarget.parentElement.getBoundingClientRect().width,startingPageX:e.pageX},c(t),window.document.addEventListener("click",u,!0)},onDoubleClick:()=>{if(l===i.SortField.SHARED_WITH)a();else{const e=p();e>0?t(e):a()}},"data-testid":"resize-handle"},void 0!==r&&s.React$1.createElement("div",{className:"resize-vertical-focus-line",style:{height:`${r}px`}}))};Ce.displayName="ResizeHandle",Ce.displayName="ResizeHandle";const Re=e=>{var{children:t,offsetHeight:i,style:a={}}=e,l=r.__rest(e,["children","offsetHeight","style"]);const c=void 0===i?a:Object.assign({flexBasis:i},a);return s.React$1.createElement("thead",Object.assign({className:"mc-table-head mc-table-head-fixed brws-column-header",style:c},l),s.React$1.createElement(o.VerticallyFixed,{tag:({style:e})=>s.React$1.createElement(n.TableRow,{className:"mc-table-head-row mc-table-head-row-fixed",style:Object.assign({height:i},e),role:"presentation"},t)}))};function Fe(e){const t=e.className,a={top:e.containerOffsetTop,position:"sticky"},n=i.classnames("native-sticky",t);return s.React$1.createElement("div",{style:a,className:n},"function"==typeof e.children?e.children():e.children)}function ve(e){const t=((e,t)=>s.React$1.Children.map(e,(e=>e&&e.type===Fe?s.React$1.cloneElement(e,t):e)))(e.children,{nativeSupport:!0,containerOffsetTop:e.offsetTop,hasParent:!0}),a={position:"relative"};return e.stickHeight&&(a.height=e.stickHeight),s.React$1.createElement("div",{className:i.classnames("native-sticky-container",e.className),style:a,key:e.id},t)}const Ie=e=>{var{children:t,columnFlex:i,offsetHeight:a,offsetTop:o}=e,c=r.__rest(e,["children","columnFlex","offsetHeight","offsetTop"]);const d=s.React$1.createElement(l.Dimensions,{tagName:"tr"},(({width:e})=>s.React$1.createElement("td",{className:"brws-sticky-table-cell"},s.React$1.createElement(ve,{offsetTop:o},s.React$1.createElement(Fe,null,s.React$1.createElement(n.Table,{columnFlex:i,style:{width:e}},s.React$1.createElement(n.TableHead,Object.assign({},c),t)))))));return s.React$1.createElement("thead",{className:"brws-sticky-table-head"},d)};const Ne=(e,t)=>{switch(e){case i.ViewType.Grid:case i.ViewType.LargeGrid:return m.intl.formatMessage({id:"iWzO4p",defaultMessage:"Group by"});case i.ViewType.List:default:return t?m.intl.formatMessage({id:"t3Jo9w",defaultMessage:"Sort by"}):m.intl.formatMessage({id:"IUsgJf",defaultMessage:"Show"})}},De=({columnFlex:e,items:t,isCompactMode:a,isSelectMode:l,currentSort:o,selectAllCheckboxState:r="unchecked",showSelectAllCheckbox:c=!0,stickyOffsetHeight:d,stickyOffsetTop:u,columns:p,visibleColumns:f,viewType:S,isSearchMode:b,isSearchTopRightSortEnabled:E,presentationOnly:T,variant:w="fixed",onMenuOpen:_,onSelectAll:C,onDeselectAll:R,onReorder:F,onSort:v,onSelection:I,isMoreColumnsEnabled:N,disableResizing:D})=>{const{resizeColumn:y,resizeColumnToDefault:M,columnSizes:L,columnResizingEnabled:O}=s.React$1.useContext(J),k=O&&!D,[x,A]=s.React$1.useState(!1),[$,P]=s.React$1.useState(!1),H={onMouseEnter:()=>P(!0),onMouseLeave:()=>P(!1)},W=b?i.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS:p,V=W.filter((e=>!e.isLocked)),B=!l&&!$&&!a,z=(e,t)=>{if("ColumnSelection"===t.type&&function(e){return"string"==typeof(null==e?void 0:e.popoverTriggerLabel)}(t.payload)){const s=f[e],a=t.payload;I(a,s,e),b?v(a.sortField,i.SortDirection.DESCENDING):N?f.includes(a)&&(null==o?void 0:o.sortField)===a.sortField&&v(f[0].sortField,i.SortDirection.ASCENDING):(null==o?void 0:o.sortField)===s.sortField&&(a.isSortOrderOptionDisabled?v(f[0].sortField,i.SortDirection.ASCENDING):v(a.sortField,o.sortDirection||i.SortDirection.ASCENDING))}else"ColumnOrderSelection"===t.type&&("right"===t.payload&&e<f.length-1?F(e+1,e):"left"===t.payload&&e>1&&F(e-1,e))},U=f.map(((e,i)=>{const a=(e=>{if(!N)return fe.NONE;const t=f[e];if(!t||t.isLocked)return fe.NONE;const i=0!==e&&!f[e-1].isLocked,s=e!==f.length-1&&!f[e+1].isLocked;return i&&s?fe.BOTH:i?fe.LEFT:s?fe.RIGHT:fe.NONE})(i),n=b&&E,l=N||!(e.isLocked||e.isSortDisabled);return s.React$1.createElement(ue,{key:e.popoverTriggerLabel,column:e,index:i,setSort:v,role:T?"presentation":"columnheader",sortDirection:n||(null==o?void 0:o.sortField)!==e.sortField?void 0:o.sortDirection,canMove:a!==fe.NONE,onIncreaseSize:()=>y(e.sortField,L[e.sortField]+4),onDecreaseSize:()=>y(e.sortField,L[e.sortField]-4)},!n&&l&&s.React$1.createElement(Se,{columns:N?W:V,index:i,onMenuOpen:_,onSelection:z,selectedColumns:f,title:Ne(S,!!b),allowUnchecking:N,availableMoves:a,isSearchMode:b}),k&&void 0!==y&&void 0!==M&&void 0!==o&&s.React$1.createElement(Ce,{onResize:t=>{A(!0),y(e.sortField,t)},onResizeToDefault:()=>M(e.sortField),onColumnResizeEnd:()=>A(!1),sortField:e.sortField,items:t}))})),G=s.React$1.createElement(oe,{onReorder:F},s.React$1.createElement(n.TableHeadCell,{className:"files-view-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell",role:T?"presentation":"columnheader",scope:"col"},s.React$1.createElement("div",{className:"brws-vertically-center"},c&&!B?s.React$1.createElement(h.Checkbox,{className:i.classnames("brws-checkbox",{"brws-checkbox-checked":"checked"===r}),checked:"checked"===r,isIndeterminate:"mixed"===r,onChange:e=>{"unchecked"===r?C():R()},"aria-label":m.intl.formatMessage({id:"YzMs/g",defaultMessage:"Select all"}),"data-testid":"brws-select-all-checkbox"}):null)),U),K={"data-campaigns-element-id":g.CampaignsElementIdEnum.BROWSE_VIEW_LIST_HEAD};return"default"===w?s.React$1.createElement(n.TableHead,Object.assign({className:i.classnames("brws-column-header",{"header-column-resize":k,"column-header-is-resizing":x})},H,{"data-testid":"table-head"},K),G):"fixed"===w?s.React$1.createElement(Re,Object.assign({offsetHeight:d},H,{"data-testid":"fixed-table-head"},K),G):"sticky-native"===w?s.React$1.createElement(n.TableHead,Object.assign({className:i.classnames("brws-column-header brws-column-header--sticky",{"header-column-resize":k,"column-header-is-resizing":x}),style:{top:u}},H,{"data-testid":"sticky-native-table-head"},K),G):s.React$1.createElement(Ie,Object.assign({columnFlex:e,offsetHeight:d,offsetTop:u,className:i.classnames("brws-column-header",{"header-column-resize":k,"column-header-is-resizing":x})},H,{"data-testid":"sticky-table-head"},K),G)};De.displayName="ColumnHeader",De.displayName="ColumnHeader";const ye=new i.ScopedEventHandlers(document);function Me(e,t,i,s,a,n,l){ye.add(e,"dragenter",(e=>{(t()||i())&&!e.target.closest(a)&&n()&&(l(null),s())}))}function Le(e){ye.remove(e,"dragenter")}const Oe="EmptyFolderTable",ke=({subtitle:e,subtitleLink:t,subtitleOnClick:a,numRowsAbove:n=2,totalRows:l=14,title:o,onTTI:r,onFocusSearchBar:c=d.noop,onNavigateToParentFolder:h=d.noop,onOpenKeyboardShortcutModal:u=d.noop,onPasteFromClipboard:p=d.noop})=>{const m=s.React$1.useRef(null);s.React$1.useEffect((()=>(null==r||r(),b.setupFilesViewKeyboardShortcuts({viewType:i.ViewType.List,getIsGlobalEvent:b.generateGetIsGlobalEventForRef(m),getIsItemEvent:()=>!1,getSelectedFiles:()=>i.immutable.exports.OrderedMap(),isCurrentPathWriteable:()=>!1,selectAllAction:d.noop,deselectAllAction:d.noop,onCopyToClipboard:d.noop,onCutToClipboard:d.noop,onDelete:d.noop,onFocusSearchBar:c,onNavigateToFileOrFolder:d.noop,onNavigateToParentFolder:h,onPasteFromClipboard:p,onShowRename:d.noop,scope:Oe,onShowHelpMenu:()=>u()}),()=>{b.resetFilesViewKeyboardShortcuts(Oe)})),[]);const g=[];for(let e=0;e<n;e++)g.push(s.React$1.createElement(f.Table.Row,{key:-e-1},s.React$1.createElement(f.Table.Cell,null)));const T=[],w=Math.max(l-n-1,0);for(let e=0;e<w;e++)T.push(s.React$1.createElement(f.Table.Row,{key:e+1},s.React$1.createElement(f.Table.Cell,null)));const _=s.React$1.createElement("h3",{className:"u-font-strong empty-folder-table-title"},o);return"V1"===E.DEFAULT_DRAG_AND_DROP||"V2"===E.DEFAULT_DRAG_AND_DROP?null:s.React$1.createElement("div",{className:"empty-folder-container"},s.React$1.createElement(f.Table,{"aria-atomic":"true","aria-live":"polite"},s.React$1.createElement(f.Table.Header,null),s.React$1.createElement(f.Table.Body,null,g,s.React$1.createElement(f.Table.Row,{key:0},s.React$1.createElement(f.Table.Cell,null,s.React$1.createElement(S.LabelGroup,{withText:_,withSubtext:e&&t?s.React$1.createElement("a",{className:"empty-folder-table-subtitle empty-folder-table-link",href:t,onClick:a},e):e?s.React$1.createElement("span",{className:"empty-folder-table-subtitle"},e):void 0}))),T)))};ke.displayName="EmptyFolderTable";const xe=e=>{var{scrollContainer:t}=e,a=r.__rest(e,["scrollContainer"]);const n=s.React$1.useMemo((()=>(null==t?void 0:t.current)?i.createFakeWindow(t.current):null),[null==t?void 0:t.current]);return t?t.current&&n?s.React$1.createElement(Ae,Object.assign({},a,{shouldUseWindowAsScrollContainer:!0,window:n})):null:s.React$1.createElement(Ae,Object.assign({},a))};xe.displayName="CulledTableBodyWithScrollContainer",xe.displayName="CulledTableBodyWithScrollContainer";class Ae extends s.React$1.PureComponent{constructor(e){super(e),this.updateOffsetCache()}componentDidMount(){this.updateScroll(!0)}componentDidUpdate(e){e.listItemHeight!==this.props.listItemHeight&&this.updateOffsetCache(),e.scrollToRow!==this.props.scrollToRow&&this.updateScroll(void 0===e.scrollToRow||e.scrollToRow<0)}updateOffsetCache({listItemHeight:e}=this.props){this.offsetCache=Array.isArray(e)?Pe(e):void 0}updateScroll(e){const{scrollToRow:t,listItemHeight:i,viewportTopOffset:s=0,scrollPositionOffset:a=0,window:n}=this.props;if(void 0!==t&&t>=0){const l=(Array.isArray(i)?this.offsetCache[t]:(t+1)*i)+a,o=Array.isArray(i)?i[t]:i;$e([l-o,l],s,n,e)}}render(){const e=this.props,{viewportTopOffset:t,scrollToRow:i}=e,a=r.__rest(e,["viewportTopOffset","scrollToRow"]);return s.React$1.createElement(n.CulledTableBody,Object.assign({viewportHeight:window.innerHeight-t},a))}}Ae.defaultProps={viewportTopOffset:0},Ae.displayName="CulledTableBodyWithScrollToRow";const $e=([e,t],i=0,s=window,a)=>{const n=s.innerHeight-i,l=((e=window)=>"scrollingElement"in e.document&&e.document.scrollingElement?e.document.scrollingElement.scrollTop:e.document.documentElement.scrollTop)(s),o=l+n;e<l?s.scrollTo(0,e):t>o&&(a&&t-e<n/2?s.scrollTo(0,t-n/2):s.scrollTo(0,t-n))},Pe=e=>e.reduce(((e,t)=>(e.push(t+(e[e.length-1]||0)),e)),[]);function He({file:e,dropTargetHighlightMode:t}){if(t===i.DropTargetHighlightMode.NONE)return!1;if(!e.is_dir)return!1;if(i.File.isReadOnlySharedFolder(e))return!1;if(e.isDeleted)return!1;switch(t){case i.DropTargetHighlightMode.ALL_FOLDERS:return!0;case i.DropTargetHighlightMode.NONSHARED_FOLDERS:return e.type!==i.FileTypes.SHARED_FOLDER;case i.DropTargetHighlightMode.NONSHARED_NONTEAM_FOLDERS:return![i.FileTypes.SHARED_FOLDER,i.FileTypes.TEAM_SHARED_FOLDER].includes(e.type)}return!1}function We({context:e,file:t,user:s,expVaultEnableViewOnlySharing:a=!1}){const n=t.per_node_metadata,l=!!((null==n?void 0:n.link_node)||(null==n?void 0:n.suppress_ns_partition)||(null==n?void 0:n.suppress_shared_link));return t.isDeleted||i.File.isTeamMemberFolder(t)||!i.File.canViewFileMembers(t,e)||e.isInsideVaultFolder&&!a||t.type===i.FileTypes.VAULT_FOLDER||t.type===i.FileTypes.SANDBOX||l}const Ve=(e,t)=>{const s=i.selectMainItems(e,t),a=!!i.selectDisabledMultiselect(e,t),n=i.selectViewType(e,t)===i.ViewType.CondensedList,l=i.selectIsActionBarEnabled(e,t);return Ue(Object.assign(Object.assign({},t),{isCheckboxDisabled:a,isCondensedListView:n,items:s,isActionBarEnabled:l}))},Be=i.createSelector(Ve,(e=>e.map((({height:e})=>e)))),ze=(e,t)=>i.selectViewType(e,t)===i.ViewType.CondensedList?20:void 0,Ue=i.createSelectorCreator(i.defaultMemoize,((e,t)=>Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every((i=>t.hasOwnProperty(i)&&e[i]===t[i]))))((({activeDropTarget:e,arePostTTIModulesLoaded:t,canDisplayFolderSizes:i,context:s,createNewFolderState:a,dropTargetHighlightMode:n,fileRename:l,focusedFileIndex:o,isCheckboxDisabled:r,isCompactMode:c,isSearchMode:d,isSelectMode:h,items:u,selection:p,sharingServiceInfo:m,starredState:g,user:f,visibleColumns:S,responsive:b,containerWidth:E,highDensity:T,isCondensedListView:w,fileToId:_,renderSharedWithController:C,expVaultEnableViewOnlySharing:R,isActionBarEnabled:F,expManualTagging:v,defaultListviewIconSize:I,isBoldFileNamesEnabled:N})=>({activeDropTarget:e,arePostTTIModulesLoaded:t,canDisplayFolderSizes:i,context:s,createNewFolderState:a,dropTargetHighlightMode:n,fileRename:l,focusedFileIndex:o,isCheckboxDisabled:r,isCompactMode:c,isSearchMode:d,isSelectMode:h,items:u,selection:p,sharingServiceInfo:m,starredState:g,user:f,visibleColumns:S,responsive:b,containerWidth:E,highDensity:T,isCondensedListView:w,fileToId:_,renderSharedWithController:C,expVaultEnableViewOnlySharing:R,isActionBarEnabled:F,expManualTagging:v,defaultListviewIconSize:I,isBoldFileNamesEnabled:N})),(e=>{const{activeDropTarget:t,context:s,createNewFolderState:a,dropTargetHighlightMode:n,items:l,fileRename:o,focusedFileIndex:c,selection:d,user:h,visibleColumns:u,responsive:p,containerWidth:m,highDensity:g,fileToId:f,isCondensedListView:S,isActionBarEnabled:b,defaultListviewIconSize:E,isSearchMode:T,isBoldFileNamesEnabled:w}=e,_=r.__rest(e,["activeDropTarget","context","createNewFolderState","dropTargetHighlightMode","items","fileRename","focusedFileIndex","selection","user","visibleColumns","responsive","containerWidth","highDensity","fileToId","isCondensedListView","isActionBarEnabled","defaultListviewIconSize","isSearchMode","isBoldFileNamesEnabled"]),C=!!e.expVaultEnableViewOnlySharing,R=i.isTaggingEnabled(e.expManualTagging);let F=i.DEFAULT_ROW_HEIGHT;S?F=i.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:g&&(F=i.DEFAULT_ROW_HEIGHT_DENSE);const v=S?32:E,I=l.toArray().map(((e,a)=>{if(e instanceof i.UserDefinedItem)return{type:"UserDefinedItemRow",props:{userDefinedItem:e},height:F};const l=m?m*i.FILE_NAME_CELL_SEARCH_FLEX_BASIS[u.length]/100:void 0,r=Ke({file:e,responsive:p}),E=Ye({snippets:e.snippets,fileNameCellWidth:l}),I=je({file:e,showSnippets:r,snippetRows:E,highDensity:g,isCondensedListView:S,showTags:R,fileNameCellWidth:l});if(e instanceof i.Paper)return{type:"PaperRow",props:{isSearchMode:T,paper:e,visibleColumns:u,arePostTTIModulesLoaded:_.arePostTTIModulesLoaded,showSnippets:r,snippetRows:E,height:I,showStar:_.arePostTTIModulesLoaded&&!i.isMobileMode(p),isBoldFileNamesEnabled:w},height:I};const N="fq_path"in e?f(e):e.file_id,D=d.selected.has(N);if(e instanceof i.FileSharedWithMe)return{type:"FileSharedWithMeRow",props:{file:e,visibleColumns:u,showSnippets:r,snippetRows:E,height:I,isSelected:D,arePostTTIModulesLoaded:_.arePostTTIModulesLoaded,isSelectMode:_.isSelectMode,isFocused:a===c,iconSize:v},height:I};const y=He({file:e,dropTargetHighlightMode:n});return{type:"FileRow",key:`file:${encodeURIComponent(e.file_id)}:${encodeURIComponent(e.fq_path)}`,itemIndex:a,props:Object.assign(Object.assign({},_),{file:e,iconSize:v,isActionBarEnabled:b,isActiveDropTarget:y&&t===e,isAvailableDropTarget:y,isFocused:a===c,isSelected:D,isExtensionsMenuDisabled:!0,isSharingDisabled:We({context:s,file:e,user:h,expVaultEnableViewOnlySharing:C}),renameState:o&&o.file.fq_path===e.fq_path?o.state:void 0,visibleColumns:u,height:I,containerWidth:m,isCondensedListView:S,responsive:p,isSearchMode:T}),height:I}}));return a&&"CREATE_FOLDER_INACTIVE"!==a&&I.unshift({type:"NewFolderRow",props:{createNewFolderState:a,isInsideMyTeamFolderTree:s.isInsideTeamFolderTree,iconSize:v},height:F}),I})),Ge=e=>e.find((({highlight_spans:e})=>!!e&&e.length>0)),Ke=({file:{snippets:e},responsive:t})=>!!e&&!!Ge(e)&&(t.isMatchedLarge||t.isMatchedMedium),je=({file:e,showSnippets:t,snippetRows:s,highDensity:a,isCondensedListView:n,showTags:l,fileNameCellWidth:o})=>{const r=l&&i.isFile(e)&&e.tags&&e.tags.length>0?i.TAGS_HEIGHT:0,c=qe({file:e,fileNameCellWidth:o});if(e.snippets&&t){if(!s)return i.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS+r+c;return i.ROW_VERTICAL_PADDING+i.ROW_TITLE_HEIGHT+i.ROW_SUBTITLE_HEIGHT+i.ROW_SNIPPET_VERTICAL_MARGIN+i.SNIPPET_HEIGHT_PER_ROW*s+r+c}return n?i.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:a?i.DEFAULT_ROW_HEIGHT_DENSE+r+c:i.DEFAULT_ROW_HEIGHT+r+c},qe=({file:e,fileNameCellWidth:t})=>{var s,a,n,l;const o=i.isFile(e)&&!!(null===(a=null===(s=e.media_data)||void 0===s?void 0:s.data)||void 0===a?void 0:a.date_taken);if(i.isFile(e)){const s=(null!==(l=null===(n=e.media_data)||void 0===n?void 0:n.display_info)&&void 0!==l?l:[]).map((e=>Ye({snippets:[{highlight_spans:e.highlights}],fileNameCellWidth:t}))).reduce(((e,t)=>e+t),0),a=o?s+1:s;return Math.min(a,3)*i.MEDIA_INFO_ITEM_HEIGHT}return 0},Ye=({snippets:e,fileNameCellWidth:t})=>{if(!e)return 0;const s=Ge(e);if(!s||!s.highlight_spans)return 0;if(!t)return 3;const a=s.highlight_spans.map((e=>e.highlight_str)).join().length,n=Math.max(t-i.MEDIA_CELL_ICON_WIDTH-i.SNIPPET_HORIZONTAL_PADDING,1),l=6*a;return Math.min(Math.ceil(l/n),3)},Xe=(e,t)=>{const s=i.selectMainItems(e,t),a=s&&s.get(t.itemIndex);return _.assert(!!a,`Item undefined at index: ${t.itemIndex}`),a},Je=(e,t)=>{const s=Xe(e,t);return _.assert(s instanceof i.File||s instanceof i.FileSharedWithMe,`item must be File or FileSharedWithMe at index: ${t.itemIndex}`),s},Ze=(e,t)=>{const s=Je(e,t);return s instanceof i.File?t.fileToId(s):s.file_id},Qe=(e,t)=>i.selectSelection(e,t).selected.has(Ze(e,t)),et=(e,t)=>t.isHovered||i.selectHasItemsSelected(e,t)||i.selectIsCompactMode(e,t),tt=(e,t)=>{const{rowIndex:s}=t;return 0===s||i.selectUser(e,t).is_cdm_member&&(2===t.rowIndex||1===t.rowIndex)},it=(e,t)=>tt(e,t)?"FileNameLabel-"+t.rowIndex:void 0,st=(e,t)=>{const s=i.selectFileRename(e,t),a=Xe(e,t);if(s&&a instanceof i.File)return s.file.fq_path===a.fq_path?s.state:void 0},at=(e,t)=>!st(e,t)&&i.selectViewType(e,t)!==i.ViewType.CondensedList,nt=(e,t)=>!(((e,t)=>{const s=Xe(e,t);return s instanceof i.File&&i.File.isNoAccessSharedFolder(s)})(e,t)||i.selectContext(e,t).isInsideVaultFolder||i.selectIsMobileMode(e,t)||((e,t)=>{const s=Xe(e,t);return s instanceof i.File&&void 0!==s.legacyPaperName})(e,t)),lt=(e,t)=>{const s=Xe(e,t);return s instanceof i.File&&i.File.isTeamMemberFolder(s)},ot=(e,t)=>i.selectArePostTTIModulesLoaded(e,t),rt=(e,t)=>{const s=((e,t)=>{const s=Xe(e,t);if(s instanceof i.Paper||s instanceof i.File||s instanceof i.FileSharedWithMe)return s.snippets})(e,t);return s&&s.find((({highlight_spans:e})=>!!e&&e.length>0))},ct=(e,t)=>Boolean(!i.selectIsMobileMode(e,t)&&rt(e,t)),dt=(e,t)=>{const s=ct(e,t),a=i.selectHighDensity(e,t),n=i.selectViewType(e,t),l=((e,t)=>{const s=Xe(e,t),a=i.selectExpManualTagging(e,t);return i.isTaggingEnabled(a)&&s instanceof i.File&&s.tags&&s.tags.length>0})(e,t);if(s){const s=ht(e,t);if(!s)return l?i.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS+i.TAGS_HEIGHT:i.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS;const a=i.ROW_VERTICAL_PADDING+i.ROW_TITLE_HEIGHT+i.ROW_SUBTITLE_HEIGHT+i.ROW_SNIPPET_VERTICAL_MARGIN+i.SNIPPET_HEIGHT_PER_ROW*s;return l?a+i.TAGS_HEIGHT:a}return n===i.ViewType.CondensedList?i.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:a?l?i.DEFAULT_ROW_HEIGHT_DENSE+i.TAGS_HEIGHT:i.DEFAULT_ROW_HEIGHT_DENSE:l?i.DEFAULT_ROW_HEIGHT+i.TAGS_HEIGHT:i.DEFAULT_ROW_HEIGHT},ht=(e,t)=>{const s=rt(e,t);if(!s||!s.highlight_spans)return 0;const{containerWidth:a,numVisibleColumns:n}=t,l=a?a*i.FILE_NAME_CELL_SEARCH_FLEX_BASIS[n]/100:void 0;if(!l)return 3;const o=s.highlight_spans.map((e=>e.highlight_str)).join().length,r=Math.max(l-i.MEDIA_CELL_ICON_WIDTH-i.SNIPPET_HORIZONTAL_PADDING,1),c=6*o;return Math.min(Math.ceil(c/r),3)},ut=(e,t)=>Boolean(i.selectEligibleForFirstTaskSubtitle(e,t)&&pt(e,t)),pt=(e,t)=>{const s=i.selectContext(e,t),a=Xe(e,t),n=i.selectUser(e,t);return a instanceof i.File&&(s.isInsideMyTeamFolderTree&&s.isCurrentlyInRoot&&a.fq_path===n.cdm_tmf_path)},mt=(e,t,s)=>i.selectViewType(e,t)===i.ViewType.CondensedList?32:s,gt=(e,t)=>{const s=i.selectCutItems(e,t),a=Xe(e,t);return i.isCutToClipboard(a,s)},ft=s.react.exports.createContext(void 0),St=({props:{onDelete:e,onShowRename:t,onNewFolderSubmit:i,onNewFolderCancel:a,onRenameSubmit:n,onRenameCancel:l,onSetClipboard:o,onPasteFromClipboard:r,onSwitchViewType:c,onColumnsChanged:d,onCanDisplayFolderSizesChanged:h,onAddFileJumpKeyCode:u,onResetFileJump:p,onShowShare:m,onLocationLinkClick:g,onNavigateToFileOrFolder:f,onNavigateToParentFolder:S,onOpenFileSharedWithMe:b,onOpenPaper:E,onSelectionChange:T,onSortChange:w,onStarClick:_,onComponentTTI:C,onFocusSearchBar:R},children:F})=>{const v=s.react.exports.useMemo((()=>({onDelete:e,onShowRename:t,onNewFolderSubmit:i,onNewFolderCancel:a,onRenameSubmit:n,onRenameCancel:l,onSetClipboard:o,onPasteFromClipboard:r,onSwitchViewType:c,onColumnsChanged:d,onCanDisplayFolderSizesChanged:h,onAddFileJumpKeyCode:u,onResetFileJump:p,onShowShare:m,onLocationLinkClick:g,onNavigateToFileOrFolder:f,onNavigateToParentFolder:S,onOpenFileSharedWithMe:b,onOpenPaper:E,onSelectionChange:T,onSortChange:w,onStarClick:_,onComponentTTI:C,onFocusSearchBar:R})),[e,t,i,a,n,l,o,r,c,d,h,u,p,m,g,f,S,b,E,T,w,_,C,R]);return s.react.exports.createElement(ft.Provider,{value:v},F)};St.displayName="FilesViewCallbackContextProvider";const bt=({item:e,user:t,className:a,isReadOnly:n,tabIndex:l,starButtonClassName:o,alwaysShowUnstarred:r})=>{const{id:c,type:d}=i.idTypePairFromStarrableItem(e),h=i.itemNameFromStarrableItem(e),{onStarClick:u}=s.React$1.useContext(ft)||{};return i.isStarColumnEnabled_TTVCTest()?s.React$1.createElement("div",{className:a},s.React$1.createElement(F.Star,{id:c,key:"star",idType:d,isDir:Boolean(e.is_dir),user:t,onStarClick:t=>{e instanceof i.File&&(null==u||u(e,t))},source:R.StarredSource.BROWSE,isReadOnly:n,tabIndex:l,starButtonClassName:o,alwaysShowUnstarred:r,itemName:h})):null};class Et extends s.React$1.PureComponent{render(){const{snippets:e,lineClamp:t,isMakeSnippetsOneLineEnabled:a}=this.props,n={maxHeight:i.SNIPPET_HEIGHT_PER_ROW*t,WebkitLineClamp:t},l=Ge(e);if(!l)return null;let o;return a&&l.highlight_spans&&(o=l.highlight_spans.filter((e=>"\n"!==e.highlight_str)).reduce(((e,t)=>e+t.highlight_str),"")),s.React$1.createElement("span",{className:i.classnames("brws-file-snippets",{"brws-file-snippets-one-line":a}),style:n,title:o},s.React$1.createElement(Tt,{snippet:l}))}}Et.defaultProps={lineClamp:3},Et.displayName="FileSnippets";const Tt=({snippet:e})=>I.highlightReactFromAllHighlightSpans(e.highlight_spans||[]);Tt.displayName="FileSnippet";const wt=()=>{};class _t extends s.React$1.PureComponent{constructor(){super(...arguments),this.inputRef=s.React$1.createRef(),this.handleDragStart=e=>{e.stopPropagation()},this.handleSubmit=e=>{e.preventDefault(),this.submitIfChanged(i.NameInputActionSource.SUBMIT)},this.handleKeyDown=e=>{e.key===i.Key_enum.Key.Escape?(e.preventDefault(),this.props.onCancel({source:i.NameInputActionSource.ESC})):e.key===i.Key_enum.Key.Enter&&this.handleSubmit(e)},this.handleBlur=e=>{this.submitIfChanged(i.NameInputActionSource.BLUR)},this.handleClick=e=>{e.preventDefault(),this.props.onClick(e)}}componentDidMount(){this.inputRef.current&&this.inputRef.current.focus(),window.requestAnimationFrame((()=>{if(!this.inputRef.current)return;const e=this.inputRef.current.value;let t=this.props.ignoreFileExtension?e.length:e.lastIndexOf(".");t<0&&(t=e.length),this.inputRef.current.setSelectionRange(0,t)}))}submitIfChanged(e){if(this.inputRef.current){const t=this.inputRef.current.value.trim();t===this.props.defaultValue?this.props.onCancel({source:e}):this.props.onSubmit(t)}}render(){return s.React$1.createElement("form",{className:"u-pad-right-xs",onSubmit:this.handleSubmit},s.React$1.createElement(i.TextInput,{ref:this.inputRef,defaultValue:this.props.defaultValue,className:this.props.className,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onDragStart:this.handleDragStart,"aria-label":this.props.label,onClick:this.handleClick}))}}_t.defaultProps={className:"",onCancel:wt,onClick:wt,onSubmit:wt,idDir:null},_t.displayName="NameInput";function Ct(e,t,s,a){if(a&&a>32){const n=(a-32)/t,l=Math.max(s,n-s);return i.Emstring.em_snippet(e,Math.floor(l),.5)}return e}function Rt(e,t){if(i.isFile(t)||(e=>e instanceof i.FileSharedWithMe)(t)){if(t.highlight_spans)return t.highlight_spans.map((e=>({string:e.highlight_str,isHighlighted:e.is_highlighted})));if(i.isFile(t)&&t.filename_highlights){return I.highlightMatchSections(e,t.filename_highlights).map((e=>({string:e.text,isHighlighted:e.isHighlighted})))}}}const Ft=({file:e,renderAsLink:t=!0,user:a,containerWidth:n,onClick:l,focusable:o,isInsideBackupFolder:r,backupInfo:c,isFilteredView:d})=>{const h={notAddedYetString:e=>m.intl.formatMessage({id:"hY0d5Z",defaultMessage:"not added yet, in {location}"},{location:e}),sharedWithYouString:m.intl.formatMessage({id:"FWJkxz",defaultMessage:"Shared with you"}),formattedLocationText:e=>m.intl.formatMessage({id:"yR1l4z",defaultMessage:"in {location}"},{location:e})};if(!i.isFile(e))return s.React$1.createElement(s.React$1.Fragment,null,h.sharedWithYouString);const u=i.parent_dir(e.fq_path);let p="/"===u?N.get_browse_root_name(a):u.slice(1);if(e.is_in_backup_folder){const e=(null==c?void 0:c.displayName)?u.replace(c.name,c.displayName):u;p="/"===u?N.get_browse_root_name(a):e.slice(1)}if(e.is_unmounted)return d?null:s.React$1.createElement(s.React$1.Fragment,null,h.notAddedYetString(p));if(d&&"/"===u)return null;const g=Ct(d?i.File.getParentDirName(e):h.formattedLocationText(p),12,6,n);if(!t||e.isDeleted)return s.React$1.createElement(s.React$1.Fragment,null,g);const f=i.browse_uri_for_fq_path(a,u,void 0,{isBackup:r});return s.React$1.createElement("a",{className:"brws-file-name-cell-location",href:f.toString(),onClick:l,tabIndex:o?0:-1},d?s.React$1.createElement(i.Text,{color:"faint",size:"small"},g):g)};Ft.displayName="FileSubtitle",Ft.displayName="FileSubtitle";const vt=e=>e instanceof i.FileSharedWithMe,It=({file:e,user:t,hrefForFile:a,showHighlights:n,showUserEducationEffects:l,userEducationEffectName:o,isSelected:r,containerWidth:c,onNameClick:d,isTooltipEnabled:h,backupInfo:u,isFilteredView:p})=>{var m;const g=e.file_id&&(null==u?void 0:u.id)===e.file_id,f=e instanceof i.File&&e.is_dir?g?null!==(m=u.displayName)&&void 0!==m?m:u.name:i.getDisplayedFilename(i.getFilename(e)):i.getFilename(e),S=s.React$1.useRef(null),b=s.React$1.useMemo((()=>((e,t,s)=>{if(!t||vt(e)||!s.current)return!1;const a=s.current,n=i.filename(e.fq_path),l=a.offsetWidth<a.scrollWidth,o=a.textContent!==n;return l||o})(e,h,S)),[e,h]),E=s.React$1.useContext(L.FilesViewOverrideContext);let T,w;if(c)T=s.React$1.createElement(M.HighlightedTruncatedString,{text:f,className:"brws-file-name-element",fontSize:14,availableWidth:c,highlightSpans:Rt(f,e),cellBuffer:3,isBold:E.isBoldFileNamesEnabled});else{const t=Ct(f,14,3,c);T=n&&(e.highlight_spans||i.isFile(e)&&e.filename_highlights)?function(e,t){const a=i.getFilename(t),n=function(e,t){let i=0;for(;i<e.length&&e.charAt(i)===t.charAt(i);)++i;return i===e.length||"…"!==e.charAt(i)?[e]:[e.substring(0,i),e.substring(i+1)]}(e,a);if(1===n.length)return i.isFile(t)&&!t.highlight_spans?I.highlightMatchReact(e,t.filename_highlights):I.highlightReactFromHighlightSpans(e,t.highlight_spans);let l,o;return i.isFile(t)&&!t.highlight_spans?(l=I.highlightMatchReact(a,t.filename_highlights,0,n[0].length),o=I.highlightMatchReact(a,t.filename_highlights,a.lastIndexOf(n[1]))):(l=I.highlightReactFromHighlightSpans(a,t.highlight_spans,0,n[0].length),o=I.highlightReactFromHighlightSpans(a,t.highlight_spans,a.lastIndexOf(n[1]))),s.React$1.createElement("span",null,l,"…",o)}(t,e):s.React$1.createElement("span",null,t),T=s.React$1.createElement("div",{className:"brws-file-name-element",ref:S},T)}if(b){const e=f.length<=i.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH?f:s.React$1.createElement("div",{className:"brws-file-name-cell-tooltip"},f);T=s.React$1.createElement(D.TitleBubble,{content:e,position:y.StickyPosition.BOTTOM,className:"list-label__title-bubble"},T)}return vt(e)?w=e.href:e.is_unmounted||e.isDeleted?p&&e.is_unmounted&&(w=e.href):w=null==a?void 0:a(t,e),void 0!==w&&(T=s.React$1.createElement("a",{className:"brws-file-name-cell-filename",href:w,onClick:d,onAuxClick:d,tabIndex:r?0:-1},T)),l&&(T=s.React$1.createElement(i.UserEducationEffect,{containerName:"FileNameLabel",name:o||"FileNameLabel",useSpan:!0},T)),T};It.displayName="FileNameTitle",It.displayName="FileNameTitle";const Nt=({file:e,isSelected:t})=>{const a=[];return i.isFile(e)&&e.isDeleted&&a.push(m.intl.formatMessage({id:"RBvabN",defaultMessage:"Deleted"})),t&&a.push(m.intl.formatMessage({id:"mpdvwi",defaultMessage:"Selected"})),i.isFile(e)&&e.is_dir&&(e.type===i.FileTypes.SHARED_FOLDER?i.File.isReadOnlySharedFolder(e)?a.push(m.intl.formatMessage({id:"513aYe",defaultMessage:"Read-only shared folder"})):a.push(m.intl.formatMessage({id:"r6q13e",defaultMessage:"Shared folder"})):e.type===i.FileTypes.TEAM_SHARED_FOLDER?i.File.isReadOnlySharedFolder(e)?a.push(m.intl.formatMessage({id:"dNfvWF",defaultMessage:"Read-only team shared folder"})):a.push(m.intl.formatMessage({id:"8zuxGM",defaultMessage:"Team shared folder"})):a.push(m.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"}))),a.length>0?s.React$1.createElement("span",{className:"ax-visually-hidden"},`${a.join(" ")}`):null};Nt.displayName="FileNameAudioDescription";const Dt=i.Loadable({loader:()=>r.__awaiter(void 0,void 0,void 0,(function*(){yield i.waitForTTI();const{MediaSearchSnippet:t}=yield new Promise((function(t,i){e(["./c_media_filters_media_search_snippet"],t,i)}));return t}))}),yt=e=>s.React$1.createElement(Dt,Object.assign({},e));yt.displayName="AsyncMediaSearchSnippet";const Mt=e=>{null==e||e.stopPropagation()},Lt=({file:t,renameState:a,showLocation:l,showSnippets:o,shouldShowSubtitle:c,snippetRows:d,user:h,onNameClick:u,isSelected:p,showUserEducationEffects:m,showHighlights:g,hrefForFile:f,userEducationEffectName:S,isTooltipEnabled:b,showFirstTaskSubtitle:E,renderFilenameSubtitleAsLink:T,onRenameCancel:w,onRenameSubmit:_,isHovered:C,onLocationLinkClick:R,width:F,shouldShowTags:v,backupNewLocationHintEnabled:I,isInsideBackupFolder:N,ggToCdmMigrationVariant:D,backupInfo:y,isFilteredView:M})=>{var x;const A=Ot(),$=((e,t)=>s=>{const a=!i.shouldHandleClick(s);a||(s.preventDefault(),s.stopPropagation()),i.isFile(e)&&(null==t||t(e,a))})(t,R),P=()=>{i.isFile(t)&&(null==w||w(t))},H=e=>{i.isFile(t)&&(null==_||_(t,e))},W=s.React$1.useContext(L.FilesViewOverrideContext),V=W.isMoveFilePathBelowSnippetEnabled,B=D&&"OFF"!==D?s.React$1.lazy((()=>r.__awaiter(void 0,void 0,void 0,(function*(){const{MigrationTooltip:t,MigrationTooltipStep:i}=yield new Promise((function(t,i){e(["./c_gg_to_cdm_migration_migration_tooltip"],t,i)}));return{default:e=>s.React$1.createElement(t,Object.assign({},e,{step:i.Two}))}})))):void 0,z=D&&"OFF"!==D?s.React$1.lazy((()=>r.__awaiter(void 0,void 0,void 0,(function*(){const{MigrationTooltip:t,MigrationTooltipStep:i}=yield new Promise((function(t,i){e(["./c_gg_to_cdm_migration_migration_tooltip"],t,i)}));return{default:e=>s.React$1.createElement(t,Object.assign({},e,{step:i.Four}))}})))):void 0,U=s.React$1.useRef(null),G=s.React$1.useMemo((()=>B?s.React$1.createElement(B,{triggerRef:U,ggToCdmMigrationVariant:D,user:h}):void 0),[U,D]),K=s.React$1.useMemo((()=>z?s.React$1.createElement(z,{triggerRef:U,ggToCdmMigrationVariant:D,user:h}):void 0),[U,D]);if(i.isFile(t)&&a===i.RenameState.PENDING_INPUT)return s.React$1.createElement(_t,{defaultValue:i.filename(t.fq_path),label:t.is_dir?A.renameDirStr:A.renameFileStr,onClick:Mt,onSubmit:H,onCancel:P,ignoreFileExtension:t.is_dir});let j;j=a===i.RenameState.SAVING_INPUT?s.React$1.createElement(s.React$1.Fragment,null,A.renamingStr):s.React$1.createElement(It,{file:t,user:h,containerWidth:F,isSelected:p,onNameClick:u,hrefForFile:f,showHighlights:g,isTooltipEnabled:b,showUserEducationEffects:m,userEducationEffectName:S,backupInfo:y,isFilteredView:M}),t instanceof i.File&&i.File.isTeamMemberFolder(t)&&G&&K&&(j=s.React$1.createElement("span",{ref:U},j,s.React$1.createElement(s.React$1.Suspense,{fallback:s.React$1.createElement(s.React$1.Fragment,null)},G,K))),M&&C&&(j=s.React$1.createElement(s.React$1.Fragment,null,j,s.React$1.createElement("span",{style:{marginLeft:"8px"}},s.React$1.createElement(Ft,{containerWidth:F,file:t,onClick:$,renderAsLink:T,user:h,focusable:p,isInsideBackupFolder:!1,backupInfo:y,isFilteredView:!0}))));let q=null;E?q=s.React$1.createElement("span",{className:"first-task-content-subtitle"},A.filesMovedString):l&&(q=s.React$1.createElement(Ft,{containerWidth:F,file:t,onClick:$,renderAsLink:T,user:h,focusable:p,isInsideBackupFolder:N,backupInfo:y}));const Y=s.React$1.createElement(n.MediaCellText,{key:"subtitle",variant:"subtitle"},q),X=F?{width:F}:void 0,J=i.isFile(t)&&t.media_data,Z=o||v&&i.isFile(t)||J,Q=i.isFile(t)&&t.tags?t.tags.filter((e=>i.isTagUserGenerated(e.value))):[],ee=null===(x=null==y?void 0:y.anchorFolders)||void 0===x?void 0:x.filter((e=>"broken"===e.folder_state[".tag"]&&e.folder_name===i.getFilename(t)));return s.React$1.createElement(s.React$1.Fragment,null,s.React$1.createElement(n.MediaCellText,{key:"title",highlight:C},s.React$1.createElement("div",{className:"brws-file-name-cell-title-container"},j,s.React$1.createElement(Nt,{file:t,isSelected:p}),I&&i.isBackupFolderIcon(t)&&!i.isBackupBrowse()&&s.React$1.createElement(i.Tooltip,{title:A.backupNewLocationTooltipStr,placement:"right"},s.React$1.createElement(i.Button,{className:"brws-file-name-cell-backup-new-location",variant:"transparent",size:"small",withIconLeft:s.React$1.createElement(i.UIIcon,{src:i.OpenLine,size:"small"}),onClick:t=>{new Promise((function(t,i){e(["./e_ui_page_files_router"],t,i)})).then((function(e){return e.constants_esnext})).then((({getBackupUrl:e})=>i.open_tab(e("browse_row")))),t.stopPropagation()}},A.backupNewLocationButtonStr)),i.isBackupBrowse()&&1===(null==y?void 0:y.nestLevel)&&void 0!==ee&&(null==ee?void 0:ee.length)>0&&s.React$1.createElement(i.Button,{className:"brws-file-name-cell-backup-finish-setup",variant:"transparent",size:"small",withIconLeft:s.React$1.createElement(i.UIIcon,{src:i.WarningLine,size:"small"}),onClick:e=>{k.launchBackupOnDesktop({hostId:null==y?void 0:y.deviceId,action:i.BackupAppDeepLinkAction.CHANGE_DEVICE_FOLDERS}),e.stopPropagation()}},A.backupFinishSetup))),c&&!V&&Y,Z&&s.React$1.createElement(n.MediaCellText,{key:"snippets_tags",variant:"subtitle",style:X},s.React$1.createElement("div",{className:"brws-file-snippets-tags-container"},J&&s.React$1.createElement("span",{className:"brws-file-snippets-media-search",style:X},s.React$1.createElement(yt,{mediaData:t.media_data})),o&&s.React$1.createElement(Et,{snippets:t.snippets,lineClamp:d,isMakeSnippetsOneLineEnabled:W.isMakeSnippetsOneLineEnabled}),v&&Q.length>0&&s.React$1.createElement("span",{className:"brws-file-snippets",style:X},s.React$1.createElement(O.TagsContainer,{tags:Q.map((e=>e.value)),highlightedIndexes:Q.map(((e,t)=>e.highlighted?t:void 0)).filter((e=>void 0!==e)),onTagClick:(e,s)=>{if(s){!i.shouldHandleClick(s)||(s.preventDefault(),s.stopPropagation())}i.isFile(t)&&(i.logTagClick(h,[t],"center_pane",e),i.redirectToSearchByTag(h,e.tag_text))},containerClassName:"brws-file-tags-container",chipClassName:"brws-file-tag",showMoreClassName:"brws-file-tags-show-more",chipSize:"xsmall",containerMaxRows:1,expandable:!1,showMoreWidth:100})))),c&&V&&Y)};Lt.displayName="FileNameCellContents";const Ot=()=>({filesMovedString:m.intl.formatMessage({id:"WYezR2",defaultMessage:"Your existing files moved here."}),renameFileStr:m.intl.formatMessage({id:"44Ky+Q",defaultMessage:"Rename file"}),renameDirStr:m.intl.formatMessage({id:"YApL4x",defaultMessage:"Rename directory"}),renamingStr:m.intl.formatMessage({id:"KvygQC",defaultMessage:"Renaming…"}),backupNewLocationButtonStr:m.intl.formatMessage({id:"wX0e+1",defaultMessage:"New location"}),backupNewLocationTooltipStr:m.intl.formatMessage({id:"Pn0YTw",defaultMessage:"Backups have a new home"}),backupFinishSetup:m.intl.formatMessage({id:"n2sso0",defaultMessage:"Finish setup"})}),{lazy:kt,Suspense:xt}=s.React,At=kt((()=>r.__awaiter(void 0,void 0,void 0,(function*(){const{FlowsFolderBadge:t}=yield new Promise((function(t,i){e(["./c_flows_components_badge"],t,i)}));return{default:t}})))),$t=({isFolderFocused:e,folderFqPath:t})=>s.react.exports.createElement(xt,{fallback:s.react.exports.createElement("div",null)},s.react.exports.createElement(At,{isFolderFocused:e,folderFqPath:t}));$t.displayName="AsyncBadgeComponent";const Pt=({mediaActions:e,fileNameCellWidth:t,draggable:a,shouldTruncateMiddleFilename:n,renameState:l,showStar:o,file:r,user:c,isMobileMode:d,isSelected:h,showLocation:u,showSnippets:p,shouldShowSubtitle:m,snippetRows:g,onNameClick:f,showUserEducationEffects:S,showHighlights:b,hrefForFile:E,userEducationEffectName:T,isTooltipEnabled:w,showFirstTaskSubtitle:_,renderFilenameSubtitleAsLink:C,onRenameCancel:R,onRenameSubmit:F,isHovered:I,onLocationLinkClick:N,onSelect:D,onDragStart:y,showTags:M,preventSelectionOnDrag:L,backupNewLocationHintEnabled:O,isInsideBackupFolder:k,ggToCdmMigrationVariant:x,backupInfo:A,isFilteredView:$})=>{const P=i.classnames("brws-file-name-cell-text","brws-vertically-center",{"brws-file-name-cell-text-rename":!!l}),H=i.classnames("brws-file-name-container",{"brws-file-name-container--action-ui-inline-star":!0}),W=i=>{let s;return n&&(s=t||i,void 0!==s&&void 0!==e&&(s-=48)),s},V=e=>{y&&(L||h||!D||D(v.SelectOptions.DEFAULT,i.ActionSourceValue.ROW_SINGLE_CLICK),y(e))},B=n&&void 0===t,z=s.React$1.useRef(null);return s.React$1.createElement(s.React$1.Fragment,null,s.React$1.createElement(Ht,{className:H,shouldWrap:B},(e=>s.React$1.createElement("div",{className:H},s.React$1.createElement("div",{className:P,draggable:a&&l!==i.RenameState.PENDING_INPUT,onDragStart:V,ref:z},s.React$1.createElement(Lt,{file:r,renameState:l,showLocation:u,showSnippets:p,shouldShowSubtitle:m,snippetRows:g,user:c,onNameClick:f,isSelected:h,showUserEducationEffects:S,showHighlights:b,hrefForFile:E,userEducationEffectName:T,isTooltipEnabled:w,showFirstTaskSubtitle:_,renderFilenameSubtitleAsLink:C,onRenameCancel:R,onRenameSubmit:F,isHovered:I,onLocationLinkClick:N,width:W(e),shouldShowTags:M,backupNewLocationHintEnabled:O,isInsideBackupFolder:k,ggToCdmMigrationVariant:x,backupInfo:A,isFilteredView:$})),r instanceof i.File&&r.is_dir&&s.React$1.createElement($t,{isFolderFocused:h,folderFqPath:r.fq_path}),!l&&o&&s.React$1.createElement(bt,{item:r,user:c,className:"brws-file-name-cell-star",isReadOnly:d,tabIndex:h?0:-1,starButtonClassName:"brws-file-name-star-button",alwaysShowUnstarred:!0})))),e)};Pt.displayName="FileNameCellComponent";const Ht=({children:e,className:t,shouldWrap:i})=>i?s.React$1.createElement(l.Dimensions,{className:t},(({width:t})=>e(t))):e();Ht.displayName="ConditionalDimensions";const Wt=i.connect(((e,t)=>{const s=Je(e,t),a=i.BROWSE_NAMESPACE_KEY in e&&"fq_path"in s?i.isInsideBackupFolderByFile(e)(s):void 0,n=i.BROWSE_NAMESPACE_KEY in e&&"fq_path"in s?i.folderBackupInfoByFile(e)(s):void 0,l=i.BROWSE_NAMESPACE_KEY in e&&i.selectedFilter(e)!==i.BrowseFilterType.NONE;return{file:s,isSelectMode:i.selectHasItemsSelected(e,t),isSelected:Qe(e,t),renameState:st(e,t),renderFilenameSubtitleAsLink:i.selectRenderFilenameSubtitleAsLink(e,t),isMobileMode:i.selectIsMobileMode(e,t),showHighlights:i.selectShouldShowFileNameHighlights(e,t),showLocation:i.selectShouldShowFileNameLocation(e,t),showStar:nt(e,t),showUserEducationEffects:tt(e,t),userEducationEffectName:it(e,t),isTooltipEnabled:ot(e,t),user:i.selectUser(e,t),shouldTruncateMiddleFilename:i.selectArePostTTIModulesLoaded(e,t),showSnippets:ct(e,t),snippetRows:ht(e,Object.assign(Object.assign({},t),{numVisibleColumns:t.visibleColumns.length})),showFirstTaskSubtitle:ut(e,t),shouldShowSubtitle:at(e,t),backupNewLocationHintEnabled:i.backupNewLocationHintEnabled(e),isInsideBackupFolder:a,ggToCdmMigrationVariant:i.ggToCdmMigrationVariant(e),backupInfo:n,isFilteredView:l}}))(Pt);class Vt extends s.React$1.PureComponent{constructor(){super(...arguments),this.lastClickTimestamp=0,this.onClick=e=>{const{onDoubleClick:t,onClick:i,threshold:s}=this.props;if(t){const a=(new Date).getTime();a-this.lastClickTimestamp<s?(t(e),this.lastClickTimestamp=0):(this.lastClickTimestamp=a,i(e))}else i(e)}}render(){return this.props.children({onClick:this.onClick})}}Vt.defaultProps={onClick:()=>{},threshold:500},Vt.displayName="WithDoubleClick";const Bt=({className:e,isSelected:t,isDeleted:a,isDraggable:l,isActiveDropTarget:o,rowIndex:r,ariaLabel:c,filename:d,children:h,onDragEnter:u,isSelectMode:p,onDragStart:m,onDragEnd:f,onNavigateToItem:S,onSelect:b,onDeselect:E,topOffset:T=0,isRightClickEnabled:w})=>{const _=e=>{w&&(e.defaultPrevented||(e.preventDefault(),e.shiftKey?b(v.SelectOptions.EXTEND,i.ActionSourceValue.ROW_SINGLE_CLICK):e.ctrlKey||e.metaKey?b(v.SelectOptions.DEFAULT,i.ActionSourceValue.ROW_SINGLE_CLICK):t||b(v.SelectOptions.ONLY,i.ActionSourceValue.ROW_SINGLE_CLICK)))},C=(e,t)=>{0===e.button&&(e.preventDefault(),e.stopPropagation(),S({openInNewTab:Boolean(i.hasModifierKey(e)),actionSource:t}))};return s.React$1.createElement(Vt,{onClick:e=>{e.defaultPrevented||(e.preventDefault(),e.shiftKey?b(v.SelectOptions.EXTEND,i.ActionSourceValue.ROW_SINGLE_CLICK):e.ctrlKey||e.metaKey?t?E(!1,i.ActionSourceValue.ROW_SINGLE_CLICK):b(v.SelectOptions.DEFAULT,i.ActionSourceValue.ROW_SINGLE_CLICK):b(v.SelectOptions.ONLY,i.ActionSourceValue.ROW_SINGLE_CLICK))},onDoubleClick:e=>{e.defaultPrevented||C(e,i.ActionSourceValue.ROW_DOUBLE_CLICK)}},(({onClick:S})=>s.React$1.createElement(n.CulledMediaRow,{className:i.classnames(e,{"brws-file-row-selected":t,"brws-file-row-deleted":a,"brws-file-row-dragover":o,"brws-row-click-selection-method":!0}),variant:(o?"dragover":t&&"selected")||"default",onClick:S,onContextMenu:_,draggable:l,topOffset:T,onDragEnter:u,onDragStart:t?m:void 0,onDragEnd:f,"aria-rowindex":(r||0)+1,"aria-label":c,"data-filename":d,tabIndex:p?-1:0===r?0:-1,"data-campaigns-element-id":g.CampaignsElementIdEnum.BROWSE_VIEW_LIST_FILE},h)))};Bt.displayName="FilesViewRowUnmemoed";const zt=s.React$1.memo(Bt);zt.displayName="FilesViewRow";const Ut=e=>{var{height:t,width:i,children:a}=e,l=r.__rest(e,["height","width","children"]);const o=void 0===i?{}:{width:i,minWidth:i,maxWidth:i};return s.React$1.createElement(n.MediaCell,{icon:s.React$1.createElement(L.FileThumbnail,Object.assign({},l)),style:Object.assign({minHeight:t-1},o),children:a})};Ut.displayName="ThumbnailMediaCell",Ut.displayName="ThumbnailMediaCell";const Gt=()=>s.React$1.createElement("span",{"aria-hidden":!0},"--"),Kt=e=>void 0===e?{}:{width:e,minWidth:e,maxWidth:e},jt=({file:e})=>e.is_cloud_doc&&Ee(e)?s.React$1.createElement(Gt,null):s.React$1.createElement("span",null,e.size);class qt extends s.React$1.PureComponent{constructor(e){super(e),this.setRef=e=>{this.brwsFilenameContainerDiv=e},this.checkboxRef=null,this.handleWindowResize=()=>{this.throttledWindowResize.request()},this.handleResize=()=>{if(this.brwsFilenameContainerDiv){const{brwsFilenameContainerDivWidth:e}=this.state,t=this.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&this.setState({brwsFilenameContainerDivWidth:t})}},this.handleTitleClick=e=>this.handleOpenNewTabOrNavigate(e,i.ActionSourceValue.ROW_TITLE),this.handleOpenNewTabOrNavigate=(e,t)=>{0===e.button&&(e.preventDefault(),e.stopPropagation(),this.onNavigateToItem({openInNewTab:i.hasModifierKey(e),actionSource:t}))},this.onSelect=(e,t)=>{this.props.onSelect&&this.props.onSelect(this.props.file.file_id,e,t)},this.onDeselect=(e,t)=>{this.props.onDeselect&&this.props.onDeselect(this.props.file.file_id,e,t)},this.onNavigateToItem=({openInNewTab:e,actionSource:t})=>{e?i.open_tab(this.props.file.href):this.props.onOpenFileSharedWithMe(this.props.file,{actionSource:t})},this.getCheckboxNode=()=>this.checkboxRef&&s.reactDom.exports.findDOMNode(this.checkboxRef),this.isCheckboxNode=e=>{const t=this.getCheckboxNode();return!!t&&t.contains(e)},this.handleCheckboxChange=e=>{},this.handleCheckboxClick=e=>{e.stopPropagation();const{onSelect:t,onDeselect:s,file:a}=this.props;t&&s&&(e.currentTarget.checked?t(a.file_id,e.shiftKey?v.SelectOptions.EXTEND:v.SelectOptions.DEFAULT,i.ActionSourceValue.SINGLE_CHECKBOX):s(a.file_id,e.shiftKey,i.ActionSourceValue.SINGLE_CHECKBOX))},this.setCheckboxRef=e=>{this.checkboxRef=e},this.handleCheckboxTouchTargetClick=e=>{if(this.shouldHandleClick(e)){if(!this.props.isCheckboxDisabled&&this.props.onDeselect&&this.props.onSelect){e.preventDefault();const t=this.props.file.file_id;this.props.isSelected?this.props.onDeselect(t,e.shiftKey,i.ActionSourceValue.SINGLE_CHECKBOX):this.props.onSelect(t,e.shiftKey?v.SelectOptions.EXTEND:v.SelectOptions.DEFAULT,i.ActionSourceValue.SINGLE_CHECKBOX)}}else e.preventDefault()},this.renderCheckbox=e=>{const{isCompactMode:t,isSelectMode:a,isSelected:n,showUserEducationEffects:l}=this.props;let o=null;return o=!(e||n||a||t)?null:s.React$1.createElement(h.Checkbox,{disabled:this.props.isCheckboxDisabled,checked:!!n,className:i.classnames("brws-checkbox",{"brws-checkbox-checked":n}),onChange:this.handleCheckboxChange,onClick:this.handleCheckboxClick,ref:this.setCheckboxRef,"aria-label":m.intl.formatMessage({id:"sJRsRx",defaultMessage:"Select item"}),tabIndex:n?0:-1}),l&&(o=s.React$1.createElement(i.UserEducationEffect,{containerName:"FileSharedWithMeRow",name:"FirstFileSelectCheckbox",useSpan:!0},o||s.React$1.createElement("div",{style:{width:20,height:20}}))),o},this.state={brwsFilenameContainerDivWidth:void 0},this.throttledWindowResize=new w.RafThrottle((()=>this.handleResize()))}componentDidMount(){this.handleWindowResize(),window.addEventListener("resize",this.handleWindowResize)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize)}componentDidUpdate(e){(this.props.isFocused&&!e.isFocused||this.props.isFocused&&this.props.isSelected&&!e.isSelected)&&this.checkboxRef&&Promise.resolve().then((()=>{const e=this.getCheckboxNode();e&&e.focus()}))}renderModifiedCell(e,t,a,l){const o=a&&e.agoFromLastActionByUserTs,r=o?e.agoFromLastActionByUserTs:e.ago;let c;if(r&&this.props.isUseNaturalLanguageTimeDeltasEnabled){const e=new Date(r);c=isNaN(e.getTime())?s.React$1.createElement("span",{"aria-hidden":!0},"--"):i.agoFromDate(e,Date.now(),!1)}const d=o?a:e.last_modified_name||void 0,h=d?m.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:d}):m.intl.formatMessage({id:"5794tP",defaultMessage:"by you"});return s.React$1.createElement(n.MediaCell,{className:"brws-file-modified-at-cell",key:"modifiedAt",subtitle:h,title:c||r||s.React$1.createElement(Gt,null),style:Kt(l)},t)}renderCell({isHovered:e,isKeyboardFocused:t,sortField:a,isLastCell:l}){const{arePostTTIModulesLoaded:o,file:r,isSelectMode:c,isSelected:d,responsive:h,user:u,showSnippets:p,snippetRows:m,height:g,filteredContactName:f,iconSize:S,columnSizes:b}=this.props,E=void 0,T=null==b?void 0:b[a];switch(a){case i.SortField.FILENAME:const t={file:r,isHovered:e,isSelectMode:!!c,isSelected:!!d,isMobileMode:!h.isMatchedLarge&&!h.isMatchedMedium,user:u,mediaActions:E,shouldTruncateMiddleFilename:o,showHighlights:true,showLocation:true,showStar:!1,showSnippets:!!p,snippetRows:m,onNameClick:this.handleTitleClick,renameState:void 0,renderFilenameSubtitleAsLink:!1,showUserEducationEffects:!1,userEducationEffectName:"",isTooltipEnabled:!1,showFirstTaskSubtitle:!1,shouldShowSubtitle:!0,draggable:!1,backupNewLocationHintEnabled:!1,isInsideBackupFolder:!1,ggToCdmMigrationVariant:"OFF",backupInfo:void 0,isFilteredView:!1},{brwsFilenameContainerDivWidth:l}=this.state;return s.React$1.createElement("div",{className:i.classnames("brws-file-name-container",{"brws-file-name-container-resizing-enabled":void 0!==T}),ref:this.setRef},s.React$1.createElement(Ut,{file:r,height:g,iconSize:S,width:T},s.React$1.createElement(Pt,Object.assign({},t,{fileNameCellWidth:l?l-64:void 0}))));case i.SortField.RELEVANCE:case i.SortField.MODIFIED:return this.renderModifiedCell(r,E,f,T);case i.SortField.SIZE:return s.React$1.createElement(n.MediaCell,{className:"brws-file-size-cell",key:"size",title:s.React$1.createElement(jt,{file:r}),style:Kt(T)},E);default:case i.SortField.CATEGORY:case i.SortField.EXTENSION:case i.SortField.SHARED_WITH:return x.reportException({err:new Error("FileSharedWithMe.renderCell is not implemented for "+a),severity:A.SEVERITY.NONCRITICAL,tags:["js:search"]}),s.React$1.createElement(n.MediaCell,{key:a,title:s.React$1.createElement(Gt,null),style:Kt(T)})}}shouldHandleClick(e){return!e.defaultPrevented&&!this.isCheckboxNode(e.target)}render(){const{rowIndex:e,topOffset:t,isSelected:i,isSelectMode:a,visibleColumns:l}=this.props;return s.React$1.createElement(zt,{className:"brws-filesharedwithme-row",isSelected:i,topOffset:t,rowIndex:e,isSelectMode:a,onSelect:this.onSelect,onDeselect:this.onDeselect,onNavigateToItem:this.onNavigateToItem},(({isHovered:e,isKeyboardFocused:t})=>[s.React$1.createElement(n.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},s.React$1.createElement("div",{className:"brws-vertically-center brws-file-row-checkbox-target",onClick:this.handleCheckboxTouchTargetClick},this.renderCheckbox(e))),...l.map(((i,s)=>this.renderCell({isHovered:e,isKeyboardFocused:t,sortField:i.sortField,isLastCell:s===l.length-1})))]))}}qt.displayName="FileSharedWithMeRow";const Yt=e=>{const{createNewFolderState:t,isInsideMyTeamFolderTree:i=!1,onCancel:a,onSubmit:l,rowIndex:o,topOffset:r,iconSize:c}=e;let d;d="SAVING_INPUT"===t?s.React$1.createElement("p",{className:"brws-new-folder-row-status",role:"status","aria-live":"polite"},m.intl.formatMessage({id:"p58M12",defaultMessage:"Creating new folder…"})):s.React$1.createElement(_t,{defaultValue:"",label:m.intl.formatMessage({id:"ss4CO0",defaultMessage:"Folder name"}),onSubmit:l,onCancel:a});const h=s.React$1.createElement(Xt,{isInsideMyTeamFolderTree:i,iconSize:c});return s.React$1.createElement(n.CulledMediaRow,{"aria-rowindex":void 0!==o?o+1:void 0,className:"brws-new-folder-row",topOffset:r},s.React$1.createElement(n.TableCell,{className:"brws-checkbox-cell"}),s.React$1.createElement(n.MediaCell,{icon:h},s.React$1.createElement("div",{className:"brws-new-folder-row-content brws-vertically-center"},d)),s.React$1.createElement(n.TableCell,null),s.React$1.createElement(n.TableCell,null))},Xt=e=>{const{isInsideMyTeamFolderTree:t,iconSize:a}=e,n=e.className||"",l=a?{width:a,height:a}:{};return s.React$1.createElement(i.IconContent,Object.assign({className:n,name:t?"folder_team-small":"folder-small"},l))};let Jt;function Zt(e){const t=function(){Jt||(Jt=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]\ufe0f?|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g);return Jt}();t.lastIndex=0;const i=t.exec(e);if(i&&0===i.index){const s=i[0];if("‍"===e[s.length])return"";const a=t.exec(e);return a&&a.index===s.length?"":s||""}return""}function Qt(e,t,a,n){let{title:l,highlight_spans:o,title_highlights:r}=e;const c=o&&o.length>0,d=Zt(l);if(d)if(l=l.substr(d.length),c){const e={highlight_str:o[0].highlight_str.substr(d.length),is_highlighted:o[0].is_highlighted};o=[e,...o.slice(1)]}else if(r){const e=d.length/2;r=r.slice().map((t=>({pos:t.pos-e,len:t.string.length,string:t.string})))}let h;h=c?I.highlightReactFromHighlightSpans(l,o):I.highlightMatchReact(l,r);const u=function(e,t,a,n){return e?s.React$1.createElement("div",{className:"mc-media-cell-icon brws-file-name-icon-emoji-container"},s.React$1.createElement(i.IconContent,{name:n?"blank-large":"blank-small",className:t}),s.React$1.createElement("span",{className:a},e)):s.React$1.createElement(i.IconContent,{name:n?"paper-large":"paper-small",className:t})}(d,t,a,n);return{title:l,highlightedTitle:h,icon:u}}function ei(){}const ti=e=>void 0===e?{}:{width:e,minWidth:e,maxWidth:e};class ii extends s.React$1.PureComponent{constructor(e){super(e),this.setRef=e=>{this.brwsFilenameContainerDiv=e},this.handleWindowResize=()=>{this.throttledWindowResize.request()},this.handleResize=()=>{if(this.brwsFilenameContainerDiv){const{brwsFilenameContainerDivWidth:e}=this.state,t=this.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&this.setState({brwsFilenameContainerDivWidth:t})}},this.handleOpenNewTabOrNavigate=e=>{0===e.button&&(e.preventDefault(),e.stopPropagation(),this.handleNavigate({openInNewTab:i.hasModifierKey(e)}))},this.handleNavigate=({openInNewTab:e})=>{const{paper:t,onOpenPaper:s}=this.props;e?i.open_tab(t.url):s(t)},this.throttledWindowResize=new w.RafThrottle((()=>this.handleResize())),this.state=this.calcState(e)}UNSAFE_componentWillReceiveProps(e){if(this.props.paper.title!==e.paper.title||this.props.paper.highlight_spans!==e.paper.highlight_spans){const t=this.calcState(e);this.setState(t)}}componentDidMount(){this.handleResize(),window.addEventListener("resize",this.handleWindowResize)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize)}componentDidUpdate(e){var t,s;(null===(t=e.columnSizes)||void 0===t?void 0:t[i.SortField.FILENAME])!==(null===(s=this.props.columnSizes)||void 0===s?void 0:s[i.SortField.FILENAME])&&this.handleResize()}calcState(e){return{titleParts:Qt(e.paper,"brws-file-name-cell-icon","brws-file-name-cell-icon-emoji")}}getHighlightedSpansForHighlightedTruncatedString(e){let{title:t,highlight_spans:i,title_highlights:s}=e;const a=i&&i.length>0,n=Zt(t);if(a){if(n){const e={highlight_str:i[0].highlight_str.substr(n.length),is_highlighted:i[0].is_highlighted};i=[e,...i.slice(1)]}return i.map((e=>({string:e.highlight_str,isHighlighted:e.is_highlighted})))}if(s){if(n){t=t.substr(n.length);const e=n.length/2;s=s.slice().map((t=>({pos:t.pos-e,len:t.string.length,string:t.string})))}return I.highlightMatchSections(t,s).map((e=>({string:e.text,isHighlighted:e.isHighlighted})))}}renderTitleElement(e){const{paper:t,showHighlights:a}=this.props,{title:n,highlightedTitle:l}=this.state.titleParts;if(e){const l=s.React$1.createElement(M.HighlightedTruncatedString,{text:n,className:"brws-file-name-element",fontSize:14,highlightSpans:this.getHighlightedSpansForHighlightedTruncatedString(t),cellBuffer:3,availableWidth:e});return s.React$1.createElement("a",{className:i.classnames("brws-paper-doc-name-cell-title",{"brws-paper-doc-name-cell-title-bold":this.props.isBoldFileNamesEnabled}),href:t.url,onClick:this.handleOpenNewTabOrNavigate},a?l:s.React$1.createElement("span",null,n))}return s.React$1.createElement("a",{className:i.classnames("brws-paper-doc-name-cell-title",{"brws-paper-doc-name-cell-title-bold":this.props.isBoldFileNamesEnabled}),href:t.url,onClick:this.handleOpenNewTabOrNavigate},a?l:s.React$1.createElement("span",null,n))}renderPaperCellContent(e,t){const{paper:i,user:a,showSnippets:l,snippetRows:o,showStar:r}=this.props;return s.React$1.createElement(s.React$1.Fragment,null,s.React$1.createElement("div",{className:"brws-paper-doc-name-cell-content brws-vertically-center"},s.React$1.createElement("div",{className:"brws-paper-doc-name-cell-title-container"},s.React$1.createElement(n.MediaCellText,{highlight:e,className:"brws-paper-doc-cell-name"},this.renderTitleElement(t))),s.React$1.createElement(n.MediaCellText,{variant:"subtitle"},m.intl.formatMessage({id:"mvOTrD",defaultMessage:"in Paper"})),l&&s.React$1.createElement(n.MediaCellText,{key:"snippets",variant:"subtitle"},s.React$1.createElement("div",{className:"brws-file-snippets-tags-container"},s.React$1.createElement(Et,{snippets:i.snippets,lineClamp:o})))),r&&s.React$1.createElement(bt,{item:i,user:a,key:"paperStar",className:"brws-file-name-cell-star",starButtonClassName:"brws-file-name-star-button",alwaysShowUnstarred:!0}))}renderDocName(e,t){const{height:a}=this.props,{icon:l}=this.state.titleParts,o={highlight:e,icon:l,style:Object.assign({minHeight:a-1},ti(t))},r=i.classnames("brws-file-name-container",{"brws-file-name-container--action-ui-inline-star":!0}),{brwsFilenameContainerDivWidth:c}=this.state;return s.React$1.createElement(n.MediaCell,Object.assign({key:"docName"},o),s.React$1.createElement("div",{className:r,ref:this.setRef},this.renderPaperCellContent(e,c)))}renderDocInfo(e){const{paper:t}=this.props;let a;if(this.props.isUseNaturalLanguageTimeDeltasEnabled){const e=new Date(t.last_modified_date);a=isNaN(e.getTime())?s.React$1.createElement("span",{"aria-hidden":!0},"--"):i.agoFromDate(e,Date.now(),!1)}const l=t.last_modified_date||"",o=t.last_editor_name?m.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:t.last_editor_name}):m.intl.formatMessage({id:"5794tP",defaultMessage:"by you"});return s.React$1.createElement(n.MediaCell,{key:"docInfo",subtitle:o,title:a||l,style:ti(e)})}renderCell({isHovered:e,sortField:t}){var a;const l=null===(a=this.props.columnSizes)||void 0===a?void 0:a[t];switch(t){case i.SortField.FILENAME:return this.renderDocName(e,l);case i.SortField.RELEVANCE:case i.SortField.MODIFIED:return this.renderDocInfo(l);default:return s.React$1.createElement(n.MediaCell,{key:t,title:s.React$1.createElement("span",{"aria-hidden":!0},"--"),style:ti(l)})}}render(){const{rowIndex:e,topOffset:t,visibleColumns:i,paper:a}=this.props;return s.React$1.createElement(zt,{className:"brws-paper-row",topOffset:t,rowIndex:e,filename:a.title,ariaLabel:a.title,onSelect:ei,onDeselect:ei,onNavigateToItem:this.handleNavigate},(({isHovered:e})=>[s.React$1.createElement(n.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"}),...i.map((t=>this.renderCell({isHovered:e,sortField:t.sortField})))]))}}function si(e){e.stopPropagation()}ii.defaultProps={showHighlights:!0},ii.displayName="PaperRow";const ai=i.connect(((e,t)=>({FilesViewInlineActionBar:i.selectInlineActionBar(e,t)})))((function(e){const{FilesViewInlineActionBar:t,file:a,highlighted:n,onHoverLocked:l,isMobile:o}=e;s.React$1.useEffect((()=>{o||_.cancel()}),[o]);const r=i.classnames("brws-file-row-inline-action-bar",{"brws-file-row-inline-action-bar--safari":c.safari});return t?s.React$1.createElement("td",{onClick:si,className:"brws-file-row-inline-action-bar--container"},s.React$1.createElement(t,{className:r,file:a,highlighted:n,onHoverLocked:l,isMobile:o})):null})),ni=i.Loadable({loader:()=>new Promise((function(t,i){e(["./c_files_view_mobile_overflow_menu"],t,i)})).then((({FilesViewMobileOverflowMenu:e})=>e))});var li;!function(e){e[e.Normal=0]="Normal",e[e.Small=1]="Small"}(li||(li={}));class oi extends s.React$1.Component{constructor(e){super(e),this.handleSelection=e=>{e.performAction()},this.handleMenuToggle=({isOpen:e})=>{if(e&&this.props.onMenuOpen&&this.props.onMenuOpen(),oi.isDynamicProps(this.props)&&e){const e=this.props.getOverflowMenuActions(this.props.file,!!this.props.canDisplayFolderSizes);this.setState({actionSection:e})}},this.handlePreventMouseDown=e=>{e.preventDefault(),e.stopPropagation()},this.handleMobileMenuOpen=e=>t=>{this.handlePreventMouseDown(t),this.handleMenuToggle({isOpen:!0}),e()},this.handleClick=e=>t=>{this.handlePreventMouseDown(t),e({})},this.state={actionSection:oi.isDynamicProps(e)?[]:e.actionSection}}render(){const{isResponsive:e,size:t,showBorders:a,ariaHidden:n}=this.props,{file:l}=oi.isDynamicProps(this.props)?this.props:{},o=e&&c.is_mobile_or_tablet(),r=t===li.Small?"small":"standard";return s.React$1.createElement("div",{"aria-hidden":n?"true":void 0,className:"browse-overflow-menu","data-testid":"browse-overflow-menu"},o?s.React$1.createElement(ni,{trigger:({openMobileMenu:e})=>s.React$1.createElement(ri,{onClick:this.handleMobileMenuOpen(e),showBorders:a,size:r}),file:l,actionSection:this.state.actionSection}):s.React$1.createElement(i.Menu.Wrapper,{onSelection:this.handleSelection,onToggle:this.handleMenuToggle,onClick:this.handlePreventMouseDown,onDoubleClick:this.handlePreventMouseDown,isPortaled:!1},(({getTriggerProps:e,getContentProps:t,openMenu:l})=>s.React$1.createElement(s.React$1.Fragment,null,s.React$1.createElement(ri,{triggerProps:e(),onClick:this.handleClick(l),showBorders:a,size:r,tabIndex:n?-1:0}),s.React$1.createElement(i.Menu.Content,Object.assign({placement:"bottom-end"},t(),{className:"browse-overflow-menu-content"}),this.state.actionSection.map(((e,t)=>s.React$1.createElement(i.Menu.Segment,{key:`action-group-${t}`},e.map(((e,t)=>s.React$1.createElement(i.Menu.ActionItem,{key:`${t}-${e.label}`,value:e,disabled:e.disabled,className:i.classnames("browse-overflow-menu-item",e.className)},e.label)))))))))))}}oi.isDynamicProps=e=>"file"in e,oi.defaultProps={onMenuToggle:()=>{},isResponsive:!0},oi.displayName="FilesViewOverflowMenu";const ri=({size:e,showBorders:t,onClick:a,tabIndex:n,triggerProps:l})=>{const o=m.intl.formatMessage({id:"oeNPkV",defaultMessage:"More actions"});return s.React$1.createElement(i.IconButton,Object.assign({},l,{"aria-label":o,onClick:a,size:e,variant:t?"outline":"transparent",tabIndex:n}),s.React$1.createElement(i.UIIcon,{src:P.MoreHorizontalLine,size:e}))};ri.displayName="MenuTrigger";class ci extends s.React$1.PureComponent{constructor(){super(...arguments),this.state={isActionDropdownOpen:!1},this.onSplitShareDropdownOpen=()=>{this.onActionDropdownOpen()},this.onActionDropdownOpen=()=>{this.setState({isActionDropdownOpen:!0})},this.onActionDropdownClose=()=>{this.setState({isActionDropdownOpen:!1})},this.logSplitShareButton=t=>{i.UserSurvey.trackEvent("share_item","browse"),i.isFile(this.props.file)&&this.props.file.is_in_vault_folder&&function(t){r.__awaiter(this,void 0,void 0,(function*(){const{logProductAnalyticsEvent:i}=yield new Promise((function(t,i){e(["./c_vault_lib_api"],t,i)})).then((function(e){return e.api_esnext})),{AnalyticsEventAction:s,AnalyticsEventObject:a,AnalyticsEventActionSurface:n}=yield new Promise((function(t,i){e(["./c_src_common_logging-types"],t,i)}));i({eventAction:s.SELECT,eventObject:t?a.SHARE_FOLDER:a.SHARE_FILE,actionSurface:n.VAULT_HOME})}))}(this.props.file.is_dir)}}render(){const{arePostTTIModulesLoaded:e,canDisplayFolderSizes:t,file:i,getOverflowMenuActions:a,isCompactMode:l,isHovered:o,isSelectMode:r,isSharingDisabled:c,shareButtonLabel:d,showShareButton:h,showBorders:u,user:p,viewportTopOffset:m}=this.props,g=this.props.onShowShare||(()=>{});return r?null:s.React$1.createElement(n.MediaActions,null,!c&&!1!==h&&s.React$1.createElement($.SplitShareButton,{shareButtonLabel:d,onShowShare:g,logShareButtonClick:this.logSplitShareButton,isVisible:o&&!l||this.state.isActionDropdownOpen,user:p,files:[i],onDropdownOpen:this.onSplitShareDropdownOpen,onDropdownClose:this.onActionDropdownClose,variant:"opacity",shouldUsePortalPopover:!0}),e&&s.React$1.createElement(oi,{canDisplayFolderSizes:t,file:i,getOverflowMenuActions:a,showBorders:o||!!u,viewportTopOffset:m,ariaHidden:!0}))}}ci.displayName="FileMediaActions";const di=({isSelected:e,isDisabled:t,shouldShowUserEducationEffects:a,isCheckboxVisible:n,onSelect:l,onDeselect:o,selectionId:r,isFocused:c})=>{const d={selectItem:m.intl.formatMessage({id:"MkD8+F",defaultMessage:"Select item"})},u=s.React$1.useRef(null),p=()=>{var e,t;null===(t=null===(e=u.current)||void 0===e?void 0:e.querySelector("input"))||void 0===t||t.focus()};s.React$1.useEffect((()=>{c&&p()}),[c]),s.React$1.useEffect((()=>{e&&c&&p()}),[e,c]);const g=s=>{l&&o&&!t&&(s.stopPropagation(),e?o(r,s.shiftKey,i.ActionSourceValue.SINGLE_CHECKBOX):l(r,s.shiftKey?v.SelectOptions.EXTEND:v.SelectOptions.DEFAULT,i.ActionSourceValue.SINGLE_CHECKBOX))};let f=null;return n&&(f=s.React$1.createElement(h.Checkbox,{disabled:t,checked:e,onClick:g,"aria-label":d.selectItem,tabIndex:e?0:-1,readOnly:!0})),a&&(f=s.React$1.createElement(i.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox",useSpan:!0},f||s.React$1.createElement("div",{style:{width:20,height:20}}))),s.React$1.createElement("div",{className:i.classnames("brws-vertically-center","brws-file-row-checkbox-target",{"brws-file-row-checkbox-background":n}),onClick:g,ref:u,"data-testid":"brws-file-row-checkbox"},f)};di.displayName="FileRowCheckboxComponent",di.displayName="FileRowCheckboxComponent";const hi=i.connect(((e,t)=>({isCheckboxDisabled:i.selectDisabledMultiselect(e,t),isCheckboxVisible:et(e,t),isSelected:Qe(e,t),shouldShowUserEducationEffects:tt(e,t),isDisabled:i.selectDisabledMultiselect(e,t),selectionId:Ze(e,t)})))(di),ui=()=>s.React$1.createElement("span",{"aria-hidden":!0},"--"),pi=({file:e})=>{if(!e.recentsInfo||!e.recentsInfo.recent_event_type||!e.recentsInfo.activity_timestamp_ms)return s.React$1.createElement(ui,null);const t=function(e){switch(e[".tag"]){case"file_shared_view":case"file_private_view":case"paper_view":return m.intl.formatMessage({id:"9V+0Zh",defaultMessage:"Opened"});case"file_edit":case"paper_edit":return m.intl.formatMessage({id:"zA0VWC",defaultMessage:"Edited"});default:return m.intl.formatMessage({id:"1EfErT",defaultMessage:"Added"})}}(e.recentsInfo.recent_event_type);return s.React$1.createElement("span",null,t+" ",i.agoFromDate(e.recentsInfo.activity_timestamp_ms,Date.now(),!1))};const mi=({file:e,mediaActions:t,filteredContactName:a,isSearchMode:l,shouldBubbleSubtitle:o,width:r})=>{const c=a&&e.agoFromLastActionByUserTs,d=e.is_dir&&!l?void 0:c?e.agoFromLastActionByUserTs:e.ago,h=c?a:e.last_modified_name||void 0,u=h?m.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:h}):e.is_dir?void 0:m.intl.formatMessage({id:"5794tP",defaultMessage:"by you"}),p=s.React$1.useContext(L.FilesViewOverrideContext),{isUseNaturalLanguageTimeDeltasEnabled:g}=p;let f;if(d&&g){const e=new Date(d);f=isNaN(e.getTime())?s.React$1.createElement("span",{"aria-hidden":!0},"--"):i.agoFromDate(e,Date.now(),!1)}const S=d||s.React$1.createElement("span",{"aria-hidden":!0},"--"),b=void 0===r?{}:{width:r,minWidth:r,maxWidth:r},E=o&&u?s.React$1.createElement(i.Tooltip,{title:u},s.React$1.createElement("span",null,S)):S;return s.React$1.createElement(n.MediaCell,{className:"brws-file-modified-at-cell",subtitle:o?void 0:u,title:f||E,style:b},t)};mi.displayName="ModifiedCell",mi.displayName="ModifiedCell";const gi=()=>s.React$1.createElement("span",{"aria-hidden":!0},"--");class fi extends s.React$1.Component{constructor(){super(...arguments),this.state={isHoverLocked:!1,rowIsDragging:!1},this.handleOpenFileClick=e=>this.handleOpenNewTabOrNavigate(e,i.ActionSourceValue.ROW_PREVIEW_ICON),this.handleTitleClick=e=>this.handleOpenNewTabOrNavigate(e,i.ActionSourceValue.ROW_TITLE),this.handleOpenNewTabOrNavigate=(e,t)=>{if(0===e.button||1===e.button){if(i.hasModifierKey(e)&&"A"===e.currentTarget.tagName)return void e.stopPropagation();e.preventDefault(),e.stopPropagation();const s="A"===e.currentTarget.tagName?e.currentTarget.href:void 0;this.onNavigateToItem({openInNewTab:!1,actionSource:t,href:s,middleClick:1===e.button})}},this.onSelect=(e,t)=>{this.props.onSelect&&this.props.onSelect(this.props.fileToId(this.props.file),e,t);const s=this.props.file.fq_path;i.getStoreForSharedWith().dispatch(i.loadSharedLinkDataForPath(s))},this.onDeselect=(e,t)=>{this.props.onDeselect&&this.props.onDeselect(this.props.fileToId(this.props.file),e,t)},this.onNavigateToItem=({openInNewTab:e,actionSource:t,href:s,middleClick:a})=>{if(e){const{file:e,user:t,hrefForFile:s}=this.props;i.open_tab(s(t,e))}else this.props.onNavigateToFileOrFolder(this.props.file,{actionSource:t,href:s,middleClick:a})},this.onDragEnter=e=>{const{file:t,isSelected:i,isActiveDropTarget:s}=this.props;this.props.onDragEnter(e,t,!!i,!!s)},this.onDragStart=e=>{this.setState({rowIsDragging:!0});const{file:t,isSelected:i,onDragStart:s}=this.props;s&&(i?s(e):s(e,[t]))},this.onDragEnd=e=>{this.setState({rowIsDragging:!1});const{onDragEnd:t}=this.props;t&&t(e)},this.onShowShare=()=>{this.props.onShowShare(this.props.file,i.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ROW)},this.handleHoverLocked=({isOpen:e})=>{this.setState({isHoverLocked:e})},this.getAriaLabelForColumn=(e,t)=>{var s;switch(e.sortField){case i.SortField.FILENAME:return e.label+" "+i.filename(t.fq_path);case i.SortField.MODIFIED:return e.label+" "+t.ago;case i.SortField.CATEGORY:return e.label+" "+i.File.getCategoryDescription(t);case i.SortField.EXTENSION:return e.label+" "+i.File.getExtension(t);case i.SortField.SIZE:return e.label+" "+t.size;case i.SortField.PARENT_FOLDER:return e.label+" "+i.File.getParentDirName(t);case i.SortField.RECENT_ACTIVITY:return e.label+" "+(null===(s=t.recentsInfo)||void 0===s?void 0:s.activity_timestamp_ms);case i.SortField.SHARED_WITH:default:return}},this.renderMediaActions=(e,t)=>{const{instanceId:i,arePostTTIModulesLoaded:a,canDisplayFolderSizes:n,file:l,getOverflowMenuActions:o,isCompactMode:r,responsive:c,isSelectMode:d,isSelected:h,isSharingDisabled:u,renameState:p,shareButtonLabel:m,showShareButton:g,user:f,viewportTopOffset:S,isActionBarEnabled:b}=this.props,E=!c.isMatchedLarge&&!c.isMatchedMedium;return!(E&&(p||d))?b?e||E?s.React$1.createElement(ai,{instanceId:i,file:l,highlighted:h,onHoverLocked:this.handleHoverLocked,isMobile:E}):void 0:s.React$1.createElement(ci,{arePostTTIModulesLoaded:a,canDisplayFolderSizes:n,file:l,getOverflowMenuActions:o,isCompactMode:!!r,isHovered:e,isSelectMode:!!d,isSharingDisabled:!!u,onOpenFileClick:this.handleOpenFileClick,onShowShare:this.onShowShare,shareButtonLabel:m,showShareButton:g,showBorders:t,user:f,viewportTopOffset:S}):void 0}}renderCell({isHovered:e,sortField:t,renderCell:a}){var l,o;const{instanceId:r,itemIndex:c,rowIndex:d,fileToId:h,visibleColumns:u,containerWidth:p,height:m,file:g,hrefForFile:f,isSearchMode:S,isSelectMode:b,onLocationLinkClick:E,onRenameCancel:T,onRenameSubmit:w,filteredContactName:_,showCDMUserEducationEffects:C,iconSize:R,isCondensedListView:F,columnSizes:v,renderSharedWithController:I,isSelected:N,expManualTagging:D,preventSelectionOnDrag:y}=this.props;if(a)return a({file:g});const M=null==v?void 0:v[t];switch(t){case i.SortField.FILENAME:return s.React$1.createElement(Ut,{key:"fileName",file:g,height:m,width:M,showCDMUserEducationEffects:C,iconSize:R},s.React$1.createElement(Wt,{instanceId:r,itemIndex:c,rowIndex:d,isHovered:e,fileToId:h,visibleColumns:u,containerWidth:p,onLocationLinkClick:E,onRenameCancel:T,onRenameSubmit:w,hrefForFile:f,onNameClick:this.handleTitleClick,onSelect:this.onSelect,onDragStart:this.onDragStart,draggable:!b,showTags:S&&i.isTaggingEnabled(D),preventSelectionOnDrag:y}));case i.SortField.RELEVANCE:case i.SortField.MODIFIED:return s.React$1.createElement(mi,{key:"modified",file:g,filteredContactName:_,isSearchMode:Boolean(S),shouldBubbleSubtitle:F,width:M});case i.SortField.SHARED_WITH:case i.SortField.CATEGORY:case i.SortField.EXTENSION:case i.SortField.SIZE:case i.SortField.PARENT_FOLDER:case i.SortField.RECENT_ACTIVITY:case i.SortField.LOCKED_FILES:{const e=void 0===M?{}:{width:M,minWidth:M,maxWidth:M},a={[i.SortField.SHARED_WITH]:I(g,N?0:void 0),[i.SortField.CATEGORY]:null,[i.SortField.EXTENSION]:null,[i.SortField.SIZE]:null,[i.SortField.LOCKED_FILES]:null,[i.SortField.PARENT_FOLDER]:null,[i.SortField.RECENT_ACTIVITY]:null}[t],r={[i.SortField.SHARED_WITH]:void 0,[i.SortField.CATEGORY]:i.File.getCategoryDescription(g),[i.SortField.EXTENSION]:i.File.getExtension(g),[i.SortField.SIZE]:s.React$1.createElement(we,{file:g}),[i.SortField.LOCKED_FILES]:void 0,[i.SortField.PARENT_FOLDER]:i.File.getParentDirName(g)||s.React$1.createElement(gi,null),[i.SortField.RECENT_ACTIVITY]:s.React$1.createElement(pi,{file:g})}[t],c={[i.SortField.SHARED_WITH]:"sharedWith",[i.SortField.CATEGORY]:"category",[i.SortField.EXTENSION]:"extension",[i.SortField.SIZE]:"size",[i.SortField.LOCKED_FILES]:"locked_files",[i.SortField.PARENT_FOLDER]:"folder",[i.SortField.RECENT_ACTIVITY]:"recentActivity"}[t],d={[i.SortField.SHARED_WITH]:"brws-file-shared-with-cell",[i.SortField.CATEGORY]:"brws-file-category-cell",[i.SortField.EXTENSION]:"brws-file-extension-cell",[i.SortField.SIZE]:"brws-file-size-cell",[i.SortField.LOCKED_FILES]:"brws-file-size-cell",[i.SortField.PARENT_FOLDER]:"brws-file-size-cell",[i.SortField.RECENT_ACTIVITY]:"brws-file-size-cell"}[t];let h;if(t===i.SortField.SIZE&&S){const e=null===(l=g.media_data)||void 0===l?void 0:l.data.image_width,t=null===(o=g.media_data)||void 0===o?void 0:o.data.image_height;h=e&&t?`${e}x${t} px`:"​"}return s.React$1.createElement(n.MediaCell,{className:d,subtitle:h,title:r,style:e,key:c},a)}default:return x.reportException({err:new Error("renderCell function for "+t+"is not implemented"),severity:A.SEVERITY.NONCRITICAL,tags:["js:browse"]}),s.React$1.createElement(gi,null)}}render(){const{file:e,fileToId:t,instanceId:a,isActiveDropTarget:l,isSearchMode:o,isSelectMode:r,isSelected:c,itemIndex:d,onDeselect:h,onSelect:u,renameState:p,rowIndex:m,topOffset:g,visibleColumns:f,isCutToClipboard:S,isFocused:b,isRightClickEnabled:E}=this.props,{isHoverLocked:T}=this.state;let w="";f.forEach((t=>{const i=this.getAriaLabelForColumn(t,e);i&&(w+=i+", ")}));const _=this.state.rowIsDragging&&!c,C=i.classnames({"brws-file-row":!0,"brws-file-row-no-access":i.File.isNoAccessSharedFolder(e)||_,"brws-file-row-hover-forced":T,"brws-file-row-cut":S,"brws-file-row-dragging":_}),R=!(p||o||i.File.isTeamMemberFolder(e)||i.File.isReadOnlySharedFolder(e)||i.File.isNoAccessSharedFolder(e)||i.isBackupFolderIcon(e)||!c);return s.React$1.createElement(zt,{className:C,isActiveDropTarget:l,isSelected:c,isDeleted:e.isDeleted,isDraggable:R,topOffset:g,rowIndex:m,isSelectMode:r,filename:String(e.fq_path.split("/").slice(-1)),ariaLabel:w,onSelect:this.onSelect,onDeselect:this.onDeselect,onNavigateToItem:this.onNavigateToItem,onDragEnter:this.onDragEnter,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,isRightClickEnabled:E},(({isHovered:e,isKeyboardFocused:i})=>(e=e||T,s.React$1.createElement(s.React$1.Fragment,null,s.React$1.createElement(n.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},s.React$1.createElement(hi,{instanceId:a,itemIndex:d,rowIndex:m,isHovered:e,isFocused:!!b,fileToId:t,onSelect:u,onDeselect:h})),...f.map(((t,i)=>this.renderCell({isHovered:e&&!_,sortField:t.sortField,renderCell:t.renderCell}))),this.renderMediaActions(e,i)))))}}fi.defaultProps={topOffset:0,controlsFocusable:!1,fileToId:e=>e.fq_path},fi.displayName="FileRow";const Si=s.React$1.memo((e=>s.React$1.createElement(J.Consumer,null,(({columnSizes:t,columnResizingEnabled:i})=>s.React$1.createElement(fi,Object.assign({},e,{columnSizes:i?t:void 0}))))));Si.displayName="RowContainerWithoutRedux";const bi=i.connect(((e,t)=>({arePostTTIModulesLoaded:i.selectArePostTTIModulesLoaded(e,t),context:i.selectContext(e,t),isCheckboxDisabled:i.selectDisabledMultiselect(e,t),responsive:i.selectResponsive(e,t),showCDMUserEducationEffects:lt(e,t),height:dt(e,Object.assign(Object.assign({},t),{numVisibleColumns:t.visibleColumns.length})),iconSize:mt(e,t,t.iconSize),isCutToClipboard:gt(e,t)})))(Si),Ei=s.React$1.memo((({rowIndex:e,topOffset:t,userDefinedItem:i})=>i.renderUserDefinedItemRow({rowIndex:e,topOffset:t})));Ei.displayName="UserDefinedItemRow";const Ti=()=>{},wi=e=>{const t=["menuitem","treeitem"];switch(e.key){case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":return!(e.target instanceof Element&&t.includes(e.target.getAttribute("role")||""));default:return!0}};class _i extends s.React$1.Component{constructor(){super(...arguments),this.getIsListEvent=e=>this.props.isSelectableListEvent()&&(!(e.target instanceof Element)||"BUTTON"!==e.target.tagName),this.getSelectedFiles=()=>this.props.selectedFiles,this.getActiveDropTarget=()=>this.props.activeDropTarget,this.getIsDraggingInternalFiles=()=>!!this.props.isDraggingInternalFiles,this.getIsDraggingExternalFiles=()=>!!this.props.isDraggingExternalFiles,this.renderRow=(e,t,a)=>{var n,l,o,r;if("NewFolderRow"===e.type)return s.React$1.createElement(Yt,{createNewFolderState:e.props.createNewFolderState,isInsideMyTeamFolderTree:e.props.isInsideMyTeamFolderTree,onCancel:this.props.onNewFolderCancel,onSubmit:this.props.onNewFolderSubmit,rowIndex:t,topOffset:a,iconSize:e.props.iconSize});if("PaperRow"===e.type)return s.React$1.createElement(L.FilesViewOverrideContext.Consumer,null,(({isUseNaturalLanguageTimeDeltasEnabled:i})=>s.React$1.createElement(J.Consumer,null,(({columnSizes:n,columnResizingEnabled:l})=>s.React$1.createElement(ii,{paper:e.props.paper,rowIndex:t,topOffset:a,user:this.props.user,visibleColumns:e.props.visibleColumns,onOpenPaper:this.props.onOpenPaper,arePostTTIModulesLoaded:e.props.arePostTTIModulesLoaded,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height,showStar:e.props.showStar,columnSizes:l?n:void 0,isBoldFileNamesEnabled:e.props.isBoldFileNamesEnabled,isUseNaturalLanguageTimeDeltasEnabled:i})))));if("UserDefinedItemRow"===e.type)return s.React$1.createElement(Ei,{userDefinedItem:e.props.userDefinedItem,rowIndex:t,topOffset:a});const{selection:c}=this.props,d=e.props.file instanceof i.File?c.selected.last()===this.props.fileToId(e.props.file):c.selected.last()===e.props.file.file_id;if("FileSharedWithMeRow"===e.type)return null===(l=(n=this.props).registerListItem)||void 0===l||l.call(n,e.props.file.file_id,{top:a,height:e.props.height,left:0}),s.React$1.createElement(L.FilesViewOverrideContext.Consumer,null,(({isUseNaturalLanguageTimeDeltasEnabled:i})=>s.React$1.createElement(J.Consumer,null,(({columnSizes:n,columnResizingEnabled:l})=>s.React$1.createElement(qt,{arePostTTIModulesLoaded:this.props.arePostTTIModulesLoaded,file:e.props.file,visibleColumns:this.props.visibleColumns,isCompactMode:e.props.isCompactMode,getOverflowMenuActions:this.props.getOverflowMenuActions,onOpenFileSharedWithMe:this.props.onOpenFileSharedWithMe,rowIndex:t,controlsFocusable:d,topOffset:a,user:this.props.user,responsive:this.props.responsive,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,onSelect:this.props.onSelectFile,onDeselect:this.props.onDeselectFile,isFocused:e.props.isFocused,filteredContactName:this.props.filteredContactName,iconSize:e.props.iconSize,columnSizes:l?n:void 0,isUseNaturalLanguageTimeDeltasEnabled:i})))));null===(r=(o=this.props).registerListItem)||void 0===r||r.call(o,this.props.fileToId(e.props.file),{top:a,height:e.props.height,left:0});const h={key:e.key,instanceId:this.props.instanceId,itemIndex:e.itemIndex,containerWidth:e.props.containerWidth,file:e.props.file,getOverflowMenuActions:this.props.getOverflowMenuActions,hideViewFileButton:this.props.hideViewFileButton,isActiveDropTarget:e.props.isActiveDropTarget,isAvailableDropTarget:e.props.isAvailableDropTarget,isCompactMode:e.props.isCompactMode,responsive:e.props.responsive,isExtensionsMenuDisabled:e.props.isExtensionsMenuDisabled,isFocused:e.props.isFocused,isSearchMode:e.props.isSearchMode,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,isSharingDisabled:e.props.isSharingDisabled,onDeselect:this.props.onDeselectFile,onDragStart:this.props.onDragStart,onDragEnter:this.props.onDragEnter,onDragEnd:this.props.onDragEnd,onLocationLinkClick:this.props.onLocationLinkClick,onNavigateToFileOrFolder:this.props.onNavigateToFileOrFolder,onRenameCancel:this.props.onRenameCancel,onRenameSubmit:this.props.onRenameSubmit,onSelect:this.props.onSelectFile,renameState:e.props.renameState,rowIndex:t,controlsFocusable:d,topOffset:a,user:this.props.user,visibleColumns:this.props.visibleColumns,canDisplayFolderSizes:this.props.canDisplayFolderSizes,renderSharedWithController:this.props.renderSharedWithController,hrefForFile:this.props.hrefForFile,onShowShare:this.props.onShowShare,shareButtonLabel:this.props.shareButtonLabel,showShareButton:this.props.showShareButton,filteredContactName:this.props.filteredContactName,fileToId:this.props.fileToId,isCondensedListView:e.props.isCondensedListView,isActionBarEnabled:e.props.isActionBarEnabled,expManualTagging:this.props.expManualTagging,preventSelectionOnDrag:this.props.preventSelectionOnDrag,iconSize:e.props.iconSize,isRightClickEnabled:this.props.isRightClickEnabled};return s.React$1.createElement(bi,Object.assign({},h))}}componentDidMount(){this.props.onTTI(),this.setupKeyboardShortcuts(),this.setupExternalDragHandler()}componentWillUnmount(){this.cleanupKeyboardShortcuts(),Le(this.props.keyScope)}componentDidUpdate(e){e.isActive!==this.props.isActive&&(this.props.isActive?this.setupKeyboardShortcuts():this.cleanupKeyboardShortcuts())}cleanupKeyboardShortcuts(){b.resetFilesViewKeyboardShortcuts(this.props.keyScope),b.resetFileJumpKeyboardShortcuts(this.props.keyScope)}setupKeyboardShortcuts(){const{user:e,onDelete:t,onShowRename:s,getIsFileJumping:a,onAddFileJumpKeyCode:n,onResetFileJump:l,keyScope:o,onCopyToClipboard:r,onCutToClipboard:c,onNavigateToParentFolder:d,onPasteFromClipboard:h}=this.props;b.setupFileJumpKeyboardShortcuts({scope:o,getIsFileJumping:a,onAddFileJumpKeyCode:n,onResetFileJump:l}),b.setupFilesViewKeyboardShortcuts({user:e,viewType:i.ViewType.List,getIsGlobalEvent:this.getIsGlobalEvent(),getIsItemEvent:this.getIsListEvent,getSelectedFiles:this.getSelectedFiles,isCurrentPathWriteable:this.props.getIsCurrentPathWriteable,selectAllAction:Ti,deselectAllAction:Ti,onCopyToClipboard:r,onCutToClipboard:c,onDelete:t,onFocusSearchBar:this.props.onFocusSearchBar,onNavigateToFileOrFolder:e=>this.props.onNavigateToFileOrFolder(e,{actionSource:i.ActionSourceValue.KEYBOARD}),onNavigateToParentFolder:d,onPasteFromClipboard:h,onShowRename:s,scope:o,onShowHelpMenu:()=>this.props.onOpenKeyboardShortcutModal()})}setupExternalDragHandler(){Me(this.props.keyScope,this.getIsDraggingInternalFiles,this.getIsDraggingExternalFiles,this.props.onSetFileUploaderPath,".brws-file-row",this.getActiveDropTarget,this.props.onSetDropTarget)}getIsGlobalEvent(){return wi}render(){const{scrollPositionOffset:e,viewportTopOffset:t,focusedFileIndex:i,onRangeInView:a,scrollContainer:n,listItems:l,heights:o,itemBuffer:r}=this.props;return s.React$1.createElement(xe,{items:l,listItemHeight:o,renderRow:this.renderRow,scrollPositionOffset:e,scrollToRow:i,shouldUseWindowAsScrollContainer:!0,viewportTopOffset:t,onRangeInView:a,scrollContainer:n,itemBuffer:r,id:"files-view-table-container"})}}_i.defaultProps={isFileViewerShown:()=>!1},_i.displayName="FilesViewListComponent";const Ci=i.connect(((e,t)=>({listItems:Ve(e,t),heights:Be(e,t),itemBuffer:ze(e,t),isActive:i.isActiveFilesView(e,t.instanceId),isCheckboxDisabled:i.selectDisabledMultiselect(e,t),cutItems:i.selectCutItems(e,t)})))(_i),Ri=({scrollContainer:e,path:t,viewType:a})=>{const n=i.useSelector(i.currentScroll),l=t=>{e&&e.current?e.current.scrollTop=t:window.scrollTo(0,t)};return s.React$1.useEffect((()=>{(()=>{if(!n)return;const{scrollTop:e}=n;l(e)})()}),[n]),s.React$1.useEffect((()=>{l(0)}),[t,a]),null};function Fi(e){const t=i.classnames("tile-label-input",e.className),a=e.defaultValue||"";return s.React$1.createElement(_t,{className:t,defaultValue:a,label:e.label,onCancel:e.onCancel,onClick:e=>{e&&(e.stopPropagation(),e.preventDefault())},onSubmit:e.onSubmit})}class vi{constructor(e,t,i,s){this.recordTileError=e=>{const t=Math.floor(e/this.numTilesPerPage);this.pagesWithThumbErrors.has(t)||this.pagesWithThumbErrors.add(t)},this.recordTileLoaded=(e,t,i)=>{if(i){if(this.thumbsLoaded.has(e))return;this.thumbsLoaded.add(e)}else{if(this.iconsLoaded.has(e))return;this.iconsLoaded.add(e)}let s=!1;s=this.numTiles%this.numTilesPerPage==0?e>=this.numTiles-this.numTilesPerPage:e>=this.numTiles-this.numTiles%this.numTilesPerPage;let a=this.numTilesPerPage;if(s){const e=this.numTiles%this.numTilesPerPage;0!==e&&(a=e)}const n=Math.floor(e/this.numTilesPerPage);if(i||!t){const e=this.numTilesFinalizedByPage[n]||0;this.numTilesFinalizedByPage[n]=e+1}if(0===n&&this.handleTTI){!(this.iconsLoaded.has(e)&&this.thumbsLoaded.has(e))&&(this.numTilesLoadedOnFirstPage++,this.numTilesLoadedOnFirstPage===a&&this.handleTTI())}i&&(this.pagesWithThumbs.has(n)||this.pagesWithThumbs.add(n),this.anyThumbLoadedTimeByPage.get(n)||this.anyThumbLoadedTimeByPage.set(n,this.getTimeNow()),this.numTilesFinalizedByPage[n]===a&&this.allThumbsLoadedTimeByPage.set(n,this.getTimeNow()))},this.pruneTrackedPages=()=>{this.startTimeByPage.forEach(((e,t)=>{!this.pagesToLog.has(t)&&!this.pagesCompletedLogging.has(t)&&this.getTimeNow()-e>2e3&&this.startTimeByPage.delete(t)}))},this.logCompletedPages=()=>{this.pagesToLog.forEach((e=>{const t=this.startTimeByPage.get(e),i=Math.max(this.allThumbsLoadedTimeByPage.get(e),t),s=Math.max(this.anyThumbLoadedTimeByPage.get(e),t);!i||this.pagesWithThumbs.has(e)?this.pagesWithThumbErrors.has(e)?this.handlePageCompletedLogging(e):t&&i&&s&&(this.logPerfStats(e,t,s,i),this.handlePageCompletedLogging(e)):this.handlePageCompletedLogging(e)}))},this.numTiles=e,this.numTilesPerPage=t,this.numTilesFinalizedByPage=[],this.numTilesLoadedOnFirstPage=0,this.iconsLoaded=new Set,this.thumbsLoaded=new Set,this.startTimeByPage=new Map,this.allThumbsLoadedTimeByPage=new Map,this.anyThumbLoadedTimeByPage=new Map,this.pagesWithThumbErrors=new Set,this.pagesWithThumbs=new Set,this.pagesCompletedLogging=new Set,this.pagesToLog=new Set,this.handleTTI=s}getTimeNow(){return window.performance.now()}updateNumTiles(e){this.numTiles>=e||(this.numTiles=e)}handlePageCompletedLogging(e){this.pagesCompletedLogging.add(e),this.pagesToLog.delete(e),this.startTimeByPage.delete(e),this.anyThumbLoadedTimeByPage.delete(e),this.allThumbsLoadedTimeByPage.delete(e)}static logThumbLoadError(){i.JSStopwatch.recordTrace("visual_browse_thumb_load_error",{stopwatchName:"infinite_tile_grid_logging",traceTime:0})}static logThumbRTT(e){i.JSStopwatch.recordTrace("visual_browse_thumb_rtt",{stopwatchName:"infinite_tile_grid_logging",traceTime:e})}logPerfStats(e,t,s,a){i.JSStopwatch.recordTrace(`loaded_any_thumbs_page_${e}`,{stopwatchName:"infinite_tile_grid_logging",traceTime:s-t}),i.JSStopwatch.recordTrace(`loaded_all_thumbs_page_${e}`,{stopwatchName:"infinite_tile_grid_logging",traceTime:a-t})}}const Ii=()=>null,Ni=({ariaLabel:e,children:t,onClick:i})=>{if(!t)return null;const a=s.React$1.createElement("div",{className:"tile-label","aria-hidden":"true"},t);return i?s.React$1.createElement("a",{onClick:i,tabIndex:-1,"aria-label":e},a):a};Ni.displayName="TileLabel";const Di=({leftOffset:e,tileHeight:t,tileWidth:i,thumbNode:a,labelNode:n})=>s.React$1.createElement("div",{className:"tile",style:{left:e,height:t,width:i,pointerEvents:"none"}},s.React$1.createElement("div",{className:"tile__thumb-container",style:{height:i,width:i}},a||s.React$1.createElement("div",{className:"tile__preview--placeholder"})),s.React$1.createElement(Ni,null,n));Di.displayName="TilePlaceholder";class yi extends s.React$1.PureComponent{constructor(e){super(e),this.thumbRequestId=null,this.animationRequestIds=[],this.handleThumbnailError=()=>{const{onThumbnailError:e,tileIndex:t}=this.props;this.setState({thumbLoaded:!1}),e&&e(t)},this.logTileInteractive=()=>{const e=!!this.props.thumbnailUrl,t=this.state.thumbLoaded;if(this.props.onThumbnailLoad){const i=window.requestAnimationFrame((()=>{const i=window.requestAnimationFrame((()=>{this.props.onThumbnailLoad(this.props.tileIndex,e,t)}));this.animationRequestIds.push(i)}));this.animationRequestIds.push(i)}},this.toggleSelect=e=>{e.stopPropagation(),this.props.handleToggleSelect(e)},this.handleKeyDown=e=>{const t=e.key;e.currentTarget!==e.target||" "!==t&&t!==i.Key_enum.Key.Enter||(e.preventDefault(),this.props.onClick(e))},this.handleCheckboxChange=()=>{},this.state=Object.assign({thumbLoaded:yi.isThumbLoaded(e)},this.calcPaperTitleState(e))}componentDidMount(){this.props.delayRenderFullTile?this.renderCompleteTileTimeout=setTimeout((()=>{this.renderCompleteTileTimeout=0,this.fetchThumbnail(this.props)}),100):this.fetchThumbnail(this.props),this.logTileInteractive()}componentDidUpdate(e,t){if(!e.isFocused&&this.props.isFocused){const e=this.refs.tileContainer;e&&e.focus()}}UNSAFE_componentWillReceiveProps(e){if(e.thumbnailUrl!==this.props.thumbnailUrl&&(this.unbindThumbnailIfNeeded(),this.fetchThumbnail(e)),yi.getPaperTitle(this.props)!==yi.getPaperTitle(e)){const t=this.calcPaperTitleState(e);this.setState(t)}}static getPaperTitle(e){return e.paper?e.paper.title:null}calcPaperTitleState(e){return e.paper?{paperTitleParts:Qt(e.paper,"brws-file-name-grid-icon","brws-file-name-grid-icon-emoji",!0)}:{}}componentWillUnmount(){this.unbindThumbnailIfNeeded(),this.renderCompleteTileTimeout&&clearTimeout(this.renderCompleteTileTimeout),this.animationRequestIds.forEach((e=>{window.cancelAnimationFrame(e)})),this.animationRequestIds=[]}fetchThumbnail(e){const{thumbnailUrl:t,thumbStore:i}=e;if(t){const e=Date.now();this.thumbRequestId=i.bind_url(t,{onSuccess:()=>{this.setState({thumbLoaded:!0}),vi.logThumbRTT(Date.now()-e)},onError:()=>{this.handleThumbnailError()}})}}unbindThumbnailIfNeeded(){const{thumbStore:e}=this.props;this.thumbRequestId&&(e.unbind_url(this.thumbRequestId),this.thumbRequestId=null),this.setState({thumbLoaded:!1})}static isThumbLoaded(e){const{thumbStore:t,thumbnailUrl:i}=e;return!(!i||!t.get_thumb(i))}renderCheckbox(){let e=s.React$1.createElement(h.Checkbox,{className:"tile-checkbox","aria-label":this.props.checkboxAriaText,onClick:this.toggleSelect,onChange:this.handleCheckboxChange,tabIndex:this.props.checkboxTabIndex,checked:this.props.isSelected});return 0===this.props.tileIndex&&(e=s.React$1.createElement(i.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox"},e)),s.React$1.createElement("div",{key:"tile-select-checkbox",className:"tile-select-checkbox"},e)}renderActionNode(){return s.React$1.createElement("div",{key:"tile-action-node",className:"tile__action-button"},this.props.actionNode)}renderThumbnail(){const{thumbnailUrl:e,thumbStore:t,height:i,width:a,isSelected:n}=this.props;if(this.state.thumbLoaded){const l=t.get_thumb(e);if(l){const e=n?a-24:a,t=i||e;return s.React$1.createElement(z.LockBadge,{file:this.props.file,variant:"preview-large"},s.React$1.createElement("img",{className:"tile__preview tile__preview--thumb",draggable:!1,src:l,style:{maxHeight:t,maxWidth:e},onError:this.handleThumbnailError,alt:""}))}}return this.renderFileIcon()}renderFileIcon(){const{file:e,paper:t}=this.props;return t?this.state.paperTitleParts.icon:e?s.React$1.createElement(W.FileOrFolderIcon,Object.assign({className:"tile__preview tile__preview--icon brws-file-name-grid-icon",file:e,variant:"large",showPreview:!1},{"aria-hidden":!0})):s.React$1.createElement("div",{className:"tile__preview--placeholder"})}render(){const{altText:e,file:t,height:a,href:n,isActiveDropTarget:l,isAvailableDropTarget:o,isCutToClipboard:r,isDraggable:c,isFocused:d,isSelectable:h,isSelected:u,isViewOnly:p,labelHeight:m,labelNode:f,leftOffset:S,onClick:b,onRightClick:E,onDoubleClick:T,onLabelClick:w,onDragEnter:_,onDragStart:C,onDragEnd:R,overrideTabIndex:F,width:v,className:I}=this.props,N=a||v,D=N+m;if(p)return s.React$1.createElement(Di,{leftOffset:S,tileHeight:D,tileWidth:v,thumbNode:this.renderThumbnail(),labelNode:f});const y={left:S,height:D,width:v},M={height:N,width:v},L={className:i.classnames("tile",I,{"tile--is-selected":u,"tile--is-dragover":l,"tile--is-droppable":o&&!l,"tile--is-cut":r}),"data-filename":t&&t.name,"data-campaigns-element-id":g.CampaignsElementIdEnum.BROWSE_VIEW_LIST_FILE,style:y,draggable:c,href:n,onDragEnter:_,onDragStart:C,onDragEnd:R,"aria-label":t&&t.name,role:"gridcell"},O=s.React$1.createElement("div",{className:"tile__thumb-container",style:M},this.renderThumbnail());return s.React$1.createElement("div",{role:"row",ref:"tileContainer",className:"tile__container",onKeyDown:this.handleKeyDown,tabIndex:F||d?0:-1,"aria-label":e,"aria-selected":u},s.React$1.createElement(Vt,{onClick:b,onDoubleClick:T},(e=>s.React$1.createElement("div",Object.assign({},L,{onClick:e.onClick,onContextMenu:E}),O,h&&this.renderCheckbox(),this.renderActionNode(),s.React$1.createElement(Ni,{onClick:w,ariaLabel:t&&t.name},f)))))}}yi.defaultProps={checkboxAriaText:"",checkboxTabIndex:-1,delayRenderFullTile:!0,handleToggleSelect:Ii,isFocused:!1,isSelected:!1,isViewOnly:!1,onDragEnter:Ii,onDragStart:Ii,onClick:Ii,onRightClick:Ii},yi.displayName="TileElementComponentForTests";const Mi=L.withThumbStore(yi);i.injectInternalStyle("typescript/component_libraries/files_components/src/content-tile/content-tile-thumbnail.module.out.css",(e=>"._contentTile_1flgk_1:hover{cursor:pointer}"));const Li="_contentTile_1flgk_1";i.injectInternalStyle("typescript/component_libraries/files_components/src/content-tile/selectable-overlay.module.out.css",(e=>"._checkboxContainer_1yivw_1{left:var(--spacing__base_unit);position:absolute;top:var(--spacing__unit--2)}._starContainer_1yivw_7{position:absolute;right:var(--spacing__base_unit);top:var(--spacing__base_unit)}._durationContainer_1yivw_13{bottom:var(--spacing__base_unit);font-size:12px;left:var(--spacing__base_unit);position:absolute}._duration_1yivw_13{background:rgba(84,74,68,.5);border-radius:2px;margin:var(--spacing__base_unit);padding:var(--spacing__base_unit)}"));const Oi="_checkboxContainer_1yivw_1",ki="_starContainer_1yivw_7",xi="_durationContainer_1yivw_13",Ai="_duration_1yivw_13",$i=({isMobile:e=!1,onClick:t,onKeyPress:a,isDisabled:n=!1,tabIndex:l=-1,showTooltip:o=!0,identifier:r,ariaLabelledBy:c,ariaHasPopup:d,inverse:h=!1,variant:u="transparent"})=>{const p=i.useUniqueId({prefix:"more-options-button"}),m=i.useIntl(),g=Pi(m,r);let f=s.react.exports.createElement(i.IconButton,{variant:u,role:"button","aria-label":g,"aria-haspopup":d,onClick:t,onKeyPress:a,disabled:n,tabIndex:l,"data-testid":"more-options-button",id:p,"aria-labelledby":i.classnames(p,c),inverse:h},s.react.exports.createElement(i.UIIcon,{src:e?P.MoreHorizontalLine:K.MoreVerticalLine}));return o&&(f=s.react.exports.createElement(i.Tooltip,{title:g,placement:"top"},f)),f};$i.displayName="MoreOptionsButton";const Pi=(e,t)=>e.formatMessage({id:"vtRg71",defaultMessage:"More options{identifier, select, undefined {} other { for {identifier}}}"},{identifier:t}),Hi=({selectable:e,selected:t=!1,onSelect:i,starrable:a=!1,starred:n=!1,setStarred:l,showOverlay:o=!1,showDuration:r=!1,duration:c,inverse:d=!1,showMenuIcon:u=!1,isMobile:p=!1,onMenuClick:m,isDisabled:g=!1,text:f,checkboxAriaText:S})=>{const b=G.formatSecondsDuration(c);return s.React$1.createElement(U.CardNamespace.Scrim,{isVisible:o},e&&(o||t)&&s.React$1.createElement(U.CardNamespace.Actions,{className:Oi},s.React$1.createElement(h.Checkbox,{inverse:!1,onClick:e=>{e.stopPropagation(),null==i||i(e)},checked:t,"aria-label":null!=S?S:"Select this collections card."})),p?u&&s.React$1.createElement(U.CardNamespace.Actions,{className:ki},s.React$1.createElement($i,{onClick:e=>{e.stopPropagation(),null==m||m()},onKeyPress:e=>{e.stopPropagation(),null==m||m()},showTooltip:!0,isDisabled:g,inverse:!0,variant:"filled",isMobile:p,identifier:f})):a&&(o||n)&&s.React$1.createElement(U.CardNamespace.Actions,{className:ki},s.React$1.createElement(G.StarButton,{isStarred:n,ariaLabelledBy:"",onClick:e=>{e.stopPropagation(),null==l||l(!n)},inverse:d,variant:o?"transparent":"filled",identifier:f})),r&&b&&s.React$1.createElement(U.CardNamespace.Actions,{className:xi},s.React$1.createElement("div",{className:Ai,"data-testid":"duration"},b)))};i.injectInternalStyle("typescript/component_libraries/files_components/src/content-tile/content-tile-content.module.out.css",(e=>"._cardContent_18ld9_1 svg{min-width:42px}._smallLine_18ld9_5{font-size:12px}._cardContent_18ld9_1 ._breakWord_18ld9_9{word-break:break-all}"));const Wi="_cardContent_18ld9_1",Vi="_breakWord_18ld9_9",Bi=({text:e,subtext:t,icon:i,showMenuIcon:a=!1,isMobile:n=!1,size:l="small",onMenuClick:o,isDisabled:r=!1,starrable:c=!1,starred:d=!1,setStarred:h,containerWidth:u})=>{const p=n?48:64,m={display:"flex",alignItems:"center",justifyContent:"space-between",columnGap:"var(--spacing__base_unit)",height:p,maxHeight:p,margin:0},g=(()=>{if(!u)return;let e=u-16;return n&&c&&d?e-=32:n||(e-=44),e})();return s.React$1.createElement(U.CardNamespace.Content,{paddingTop:"0",paddingBottom:"0"},s.React$1.createElement("div",{style:m,className:Wi},s.React$1.createElement(S.LabelGroup,{withLeftAccessory:n?void 0:i,withText:s.React$1.createElement("span",{className:Vi},s.React$1.createElement(j.Truncate,{lines:n?1:3,maxWidth:g,tooltipControlProps:{auto:!0,placement:"bottom"}},e)),withSubtext:s.React$1.createElement("span",{className:Vi},t),size:l}),n?c&&d&&s.React$1.createElement(G.StarButton,{isStarred:d,ariaLabelledBy:"",onClick:e=>{e.stopPropagation(),null==h||h(!d)},identifier:e}):a&&s.React$1.createElement($i,{onClick:e=>{e.stopPropagation(),null==o||o()},onKeyPress:e=>{e.stopPropagation(),null==o||o()},showTooltip:!0,isDisabled:r,identifier:e})))},zi={"folder_camera_upload-large":i.FolderCameraUploadDefaultLarge,"folder_camera_upload-small":i.FolderCameraUploadDefaultSmall,"folder_confidential-large":i.FolderConfidentialDefaultLarge,"folder_confidential-small":i.FolderConfidentialDefaultSmall,"folder_confidential_admin_view-large":i.FolderConfidentialDefaultLarge,"folder_confidential_admin_view-small":i.FolderConfidentialDefaultSmall,"folder_dropbox-large":i.FolderDropboxDefaultLarge,"folder_dropbox-small":i.FolderDropboxDefaultSmall,"folder_shared-large":i.FolderSharedDefaultLarge,"folder_shared-small":i.FolderSharedDefaultSmall,"folder_team-large":i.FolderTeamDefaultLarge,"folder_team-small":i.FolderTeamDefaultSmall,"folder_team_member-large":i.FolderTeamMemberDefaultLarge,"folder_team_member-small":i.FolderTeamMemberDefaultSmall,"folder_team_read_only-large":i.FolderTeamReadOnlyLarge,"folder_team_read_only-small":i.FolderTeamReadOnlySmall,"folder_shared_read_only-large":i.FolderSharedDefaultLarge,"folder_shared_read_only-small":i.FolderSharedDefaultSmall,"folder_app-large":i.FolderAppDefaultLarge,"folder_app-small":i.FolderAppDefaultSmall,"folder-large":i.FolderBaseDefaultLarge,"folder-small":i.FolderBaseDefaultSmall,"folder_dropdown-small":i.FolderBaseDefaultSmall,"folder_dropdown-large":i.FolderBaseDefaultLarge,"folder_project-small":i.FolderBaseDefaultSmall,"folder_project-large":i.FolderBaseDefaultLarge,"folder_space_read_only-large":i.FolderBaseDefaultLarge,"folder_space_read_only-small":i.FolderBaseDefaultSmall,"folder_space-large":i.FolderBaseDefaultLarge,"folder_space-small":i.FolderBaseDefaultSmall,"folder_team_member_child-large":i.FolderBaseDefaultLarge,"folder_team_member_child-small":i.FolderBaseDefaultSmall},Ui=(e,t)=>{const i=`${Gi(e)}-${t}`;if(i in zi)return zi[i]},Gi=e=>{const t=e.length,i=e.lastIndexOf("_",t);return parseInt(e.substring(i+1),10)?e.substring(0,i):e};i.injectInternalStyle("typescript/component_libraries/files_components/src/content-tile/thumbnail.module.out.css",(e=>"._background_1jdm6_1{background-color:var(--dig-color__secondary__surface)}._gridCenter_1jdm6_5{align-items:center;display:grid;justify-items:center}._thumbnailCenter_1jdm6_11{align-items:center;display:flex;justify-content:center;padding:var(--spacing__unit--2)}._imgContain_1jdm6_18{max-height:100%;max-width:100%;object-fit:contain}"));const Ki="_background_1jdm6_1",ji="_gridCenter_1jdm6_5",qi="_thumbnailCenter_1jdm6_11",Yi="_imgContain_1jdm6_18",Xi=({imgSource:e,imgLabel:t,extension:a,icon:n,isLoading:l})=>{let o,r=a;if(""===a.trim()&&(null==n?void 0:n.startsWith("folder"))){const e=Ui(n,"large");o=null==e?void 0:e({})}else if(a.startsWith(".")){const e=a.split(".");r=e[e.length-1]}const c=!!o,d=!l&&!!e&&!c,h=!l&&!e&&!c,u=i.classnames(Ki,{[qi]:d},{[ji]:!d});return s.React$1.createElement("div",{className:u},l?s.React$1.createElement(i.Spinner,{size:"medium"}):s.React$1.createElement(s.React$1.Fragment,null,d&&s.React$1.createElement("img",{src:e,alt:t,className:Yi}),c&&s.React$1.createElement("div",{className:u},o),h&&s.React$1.createElement(i.FileIcon$1,{extension:r,size:"large"})))},Ji=({extension:e,icon:t})=>{let a,n=e;if(""===e.trim()&&(null==t?void 0:t.startsWith("folder"))){const e=Ui(t,"small");a=null==e?void 0:e({})}else if(e.startsWith(".")){const t=e.split(".");n=t[t.length-1]}return s.React$1.createElement(s.React$1.Fragment,null,a?s.React$1.createElement(s.React$1.Fragment,null,a):s.React$1.createElement(i.FileIcon$1,{extension:n,size:"small"}))},Zi=({extension:e,text:t,icon:i,imgSource:a,imgLabel:n,duration:l,subtext:o,selectable:r,selected:c=!1,starrable:d=!1,starred:h=!1,setStarred:u,onMenuClick:p,isDisabled:m=!1,isLoading:g=!1,isMobile:f=!1,checkboxAriaText:S,containerWidth:b,onSelect:E})=>{const[T,w]=s.react.exports.useState(!1),_=m?void 0:e=>null==E?void 0:E(e),C=m?{isDisabled:!0}:{isSelected:c},R=s.react.exports.useRef(!1);return s.React$1.createElement(U.CardNamespace,Object.assign({className:Li,onFocusWithin:()=>{R.current=!0,w(!0)},onBlurWithin:()=>{R.current=!1,w(!1)},onMouseEnter:()=>{w(!0)},onMouseLeave:()=>{w(!1)},onTouchStart:()=>{w(!0)},onTouchEnd:()=>{w(!1)},isLink:!0,onClick:_},C),s.React$1.createElement(U.CardNamespace.Media,{ratio:4/3,withOverlay:!m&&s.React$1.createElement(Hi,{showOverlay:T,selectable:r,selected:c,onSelect:E,starred:h,setStarred:u,starrable:d,inverse:!T,duration:l,showDuration:!!l,isMobile:f,showMenuIcon:!0,onMenuClick:p,isDisabled:m,text:t,checkboxAriaText:S})},s.React$1.createElement(Xi,{imgSource:a,imgLabel:n,extension:e,icon:i,isLoading:g})),s.React$1.createElement(Bi,{text:t,subtext:o,icon:s.React$1.createElement(Ji,{extension:e,icon:i}),showMenuIcon:!0,onMenuClick:p,isDisabled:m,starrable:d,starred:h,setStarred:u,isMobile:f,containerWidth:b}))},Qi=()=>null,es=({ariaLabel:e,children:t,onClick:i})=>{if(!t)return null;const a=s.React$1.createElement("div",{className:"tile-label","aria-hidden":"true"},t);return i?s.React$1.createElement("a",{onClick:i,tabIndex:-1,"aria-label":e},a):a};es.displayName="TileLabel";const ts=({leftOffset:e,tileHeight:t,tileWidth:i,thumbNode:a,labelNode:n})=>s.React$1.createElement("div",{className:"tile",style:{left:e,height:t,width:i,pointerEvents:"none"}},s.React$1.createElement("div",{className:"tile__thumb-container",style:{height:i,width:i}},a||s.React$1.createElement("div",{className:"tile__preview--placeholder"})),s.React$1.createElement(es,null,n));ts.displayName="ContentTilePlaceholder";const is=({file:e,paper:t,labelNode:a,altText:n,onClick:l,onRightClick:o,onDoubleClick:r,onLabelClick:c,height:d,width:h,leftOffset:u,tileIndex:p,labelHeight:m,delayRenderFullTile:f,actionNode:S,isDraggable:b,onDragEnter:E,onDragStart:T,onDragEnd:w,isSelectable:_,isSelected:C,isFocused:R,isViewOnly:F,isActiveDropTarget:v,isAvailableDropTarget:I,handleToggleSelect:N,checkboxAriaText:D,checkboxTabIndex:y,href:M,overrideTabIndex:L,isCutToClipboard:O,className:k,contentTileMetadata:x,thumbStore:A,isMobile:$=!1,onHeightChange:P})=>{var H;const[W,V]=s.react.exports.useState(!1),B=s.react.exports.useRef(null),z=s.react.exports.useRef(!!R),[U,G]=s.react.exports.useState(!0),[K,j]=s.react.exports.useState(),[q,Y]=s.react.exports.useState(),X=s.react.exports.useRef(null),J=s.react.exports.useRef(!0),Z=s.react.exports.useRef(null),Q=(null==x?void 0:x.isDir)?void 0:i.format_bytes(null!==(H=null==x?void 0:x.size)&&void 0!==H?H:0);s.react.exports.useEffect((()=>()=>{ee(),J.current=!1}),[]),s.react.exports.useEffect((()=>{const{thumbnailUrl:e,icon:t,preview:i}=x||{};if(e?X.current=A.bind_url(e,{onSuccess:()=>{J.current&&(j(e),G(!1))},onError:()=>{J.current&&G(!1)}}):t&&!e&&J.current&&G(!1),(null==i?void 0:i.content)&&"video"in i.content&&J.current){const e=i.content.video;Y(e.transcode_url)}}),[x,null==x?void 0:x.thumbnailUrl,null==x?void 0:x.preview,A]),s.react.exports.useEffect((()=>{if(!z.current&&R){const e=B.current;e&&e.focus()}z.current=!!R}),[R]),s.react.exports.useEffect((()=>{if(Z.current&&Z.current.firstElementChild){const e=Z.current.firstElementChild.clientHeight;P(e)}}),[P,h]);const ee=()=>{X.current&&(A.unbind_url(X.current),X.current=null)},te=(d||h)+m;if(F)return s.React$1.createElement(ts,{leftOffset:u,tileHeight:te,tileWidth:h,labelNode:a});const ie={left:u,height:te,width:h},se={className:i.classnames("tile",k,{"tile--is-selected":C,"tile--is-dragover":v,"tile--is-droppable":I&&!v,"tile--is-cut":O}),"data-filename":e&&e.name,"data-campaigns-element-id":g.CampaignsElementIdEnum.BROWSE_VIEW_LIST_FILE,style:ie,draggable:b,href:M,onDragEnter:E,onDragStart:T,onDragEnd:w,"aria-label":e&&e.name,role:"gridcell"};return s.React$1.createElement("div",{role:"row",ref:B,className:"tile__container",onKeyDown:e=>{const t=e.key;e.currentTarget!==e.target||" "!==t&&t!==i.Key_enum.Key.Enter||(e.preventDefault(),l(e))},tabIndex:L||R?0:-1,"aria-label":n,"aria-selected":C},s.React$1.createElement(Vt,{onClick:l,onDoubleClick:r},(t=>{var i,a;return s.React$1.createElement("div",Object.assign({},se,{ref:e=>{Z.current=e},onClick:t.onClick,onContextMenu:o}),s.React$1.createElement(Zi,{extension:null!==(i=null==x?void 0:x.extension)&&void 0!==i?i:"",selectable:!0,starrable:!0,selected:C,onSelect:N,starred:W,setStarred:V,text:null!==(a=null==x?void 0:x.name)&&void 0!==a?a:"",checkboxAriaText:D,containerWidth:h,subtext:Q,isLoading:U,imgSource:K,videoSrc:q,icon:null==e?void 0:e.icon,isMobile:$}))})))};is.displayName="ContentTileElementComponentForTests",is.defaultProps={checkboxAriaText:"",checkboxTabIndex:-1,delayRenderFullTile:!0,handleToggleSelect:Qi,isFocused:!1,isSelected:!1,isViewOnly:!1,onDragEnter:Qi,onDragStart:Qi,onClick:Qi,onRightClick:Qi};const ss=L.withThumbStore(is);function as({className:e,label:t}){return e=i.classnames("tile-label__text",e),s.React$1.createElement("div",{className:e},t)}class ns extends s.React$1.PureComponent{constructor(e){if(super(e),this.tileIndexToRowIndex=[],this.rowHeights=[],this.ttiReported=!1,this.itemRangeByRow=[],this.tileLoadLogger=null,this.updateLayout=()=>{this.animationFrameRequestId=window.requestAnimationFrame((()=>{const e=this.getAndUpdateTileLayout();this.props.logTileLoading&&!this.tileLoadLogger&&this.setupTileLogging(this.getRowHeight(),e.tilesPerRow)}))},this.updateScroll=e=>{const{scrollToIndex:t,scrollIntoView:i,scrollPositionOffset:s}=this.props;if(void 0!==t&&i){const a=this.tileIndexToRowIndex[t],n=this.rowHeights.slice(0,a).reduce(((e,t)=>e+t),s);i({top:n,bottom:n+this.rowHeights[a]},e)}},this.handleContentTileHeightChange=e=>{this.setState({contentTileHeight:e})},this.getAndUpdateTileLayout=()=>{const e=this.props.maxTileWidth+this.props.tilePadding,t=s.reactDom.exports.findDOMNode(this);if(!t||0===t.clientWidth)return{tileWidth:this.state.tileWidth,tilesPerRow:this.props.tilesPerRow};const a=t.clientWidth;let n=Math.max(1,Math.floor(a/e)),l=this.props.maxTileWidth;return a%e>1&&(n++,l=a/n-this.props.tilePadding,"ON"!==E.CONTENT_TILES||this.props.isMobile||(l=this.props.maxTileWidth===i.ContentTileConstants.SMALL_GRID_VIEW_MAX_WIDTH?Math.max(i.ContentTileConstants.SMALL_GRID_VIEW_MIN_WIDTH,l):Math.max(i.ContentTileConstants.LARGE_GRID_VIEW_MIN_WIDTH,l),l*n+this.props.tilePadding*(n-1)>a&&(n--,l=(a-this.props.tilePadding*(n-1))/n-this.props.tilePadding))),this.state.tileWidth!==l&&this.setState({tileWidth:l}),this.props.tilesPerRow!==n&&this.props.onTilesPerRowChange(n),{tileWidth:l,tilesPerRow:n}},this.handleTTI=()=>{this.ttiReported=!0;const{handleTTI:e}=this.props;e&&e()},this.setLastViewedPage=e=>{if(!this.tileLoadLogger)return;const t=document.documentElement.scrollTop||document.body.scrollTop,i=Math.round(t/e);if(this.tileLoadLogger.pruneTrackedPages(),this.tileLoadLogger.logCompletedPages(),!this.tileLoadLogger.pagesCompletedLogging.has(i)&&!this.tileLoadLogger.pagesToLog.has(i))if(i!==this.tileLoadLogger.lastViewedPage){if(this.tileLoadLogger.lastViewedPage=i,this.tileLoadLogger.pageChangeTime=this.tileLoadLogger.getTimeNow(),!this.tileLoadLogger.startTimeByPage.get(i)){const e=this.tileLoadLogger.getTimeNow();this.tileLoadLogger.startTimeByPage.set(i,e)}}else{this.tileLoadLogger.getTimeNow()-this.tileLoadLogger.pageChangeTime>1e3&&this.tileLoadLogger.pagesToLog.add(i)}},this.logTileError=e=>{this.tileLoadLogger&&this.tileLoadLogger.recordTileError(e),this.props.logTileLoading&&vi.logThumbLoadError()},this.logTileLoaded=(e,t,i)=>{this.tileLoadLogger&&this.tileLoadLogger.recordTileLoaded(e,t,i)},this.renderTileElement=(e,t,a,n)=>{var l,o,r;if(e<0||e>this.props.totalNumItems)return null;const c=this.props.getTileItem(e,a);if(!c)return s.React$1.createElement(Di,{leftOffset:t,tileHeight:this.state.tileWidth,tileWidth:this.state.tileWidth});const d=this.ttiReported&&this.props.delayRenderFullTile,h=c.isSelectable&&!!this.props.selectedIds&&this.props.selectedIds.has(c.id),u=c.file&&this.props.shouldFileBeHighlightedDropTarget(c.file,h),p=u&&c.file===this.props.activeDropTarget;let m,g="";c.fileSharedWithMe?(g=c.fileSharedWithMe.file_id,m={type:c.fileSharedWithMe.type,icon:c.fileSharedWithMe.icon,fq_path:`/${c.fileSharedWithMe.filename}`,thumbnail_url_tmpl:c.fileSharedWithMe.thumbnail_url_tmpl,name:c.fileSharedWithMe.filename}):c.file&&(g=c.file.fq_path,m={type:c.file.type,icon:c.file.icon,fq_path:c.file.fq_path,thumbnail_url_tmpl:c.file.thumbnail_url_tmpl,name:i.filename(c.file.fq_path),isDeleted:c.file.isDeleted,is_locked:c.file.is_locked,is_lockholder:c.file.is_lockholder,lockholder_name:c.file.lockholder_name,lock_info:c.file.lock_info});const f=c.labelNode?this.props.labelHeight:0;null===(o=(l=this.props).registerSelectableTile)||void 0===o||o.call(l,g,{top:n,left:t,width:this.state.tileWidth,height:f+this.state.tileWidth});const S=0===e&&this.props.selectedIds&&0===this.props.selectedIds.size;let b;return"ON"===E.CONTENT_TILES?(c.file&&(b={name:i.filename(c.file.fq_path),extension:c.file.ext,preview:null===(r=c.file)||void 0===r?void 0:r.preview,size:c.file.bytes,isDir:c.file.is_dir,thumbnailUrl:c.thumbnailUrl,icon:c.file.icon}),s.React$1.createElement(ss,{file:m,paper:c.paper,key:c.id,contentTileMetadata:b,onClick:c.onClick,onRightClick:c.onRightClick,onDoubleClick:c.onDoubleClick,onLabelClick:c.onLabelClick,width:this.state.tileWidth,leftOffset:t,tileIndex:e,labelHeight:f,delayRenderFullTile:d,actionNode:c.actionNode,labelNode:c.labelNode,altText:c.altText,isDraggable:c.isDraggable,onDragEnter:c.onDragEnter,onDragStart:c.onDragStart,onDragEnd:c.onDragEnd,isFocused:c.isFocused,isSelectable:c.isSelectable,isSelected:h,isViewOnly:c.isViewOnly,isActiveDropTarget:p,isAvailableDropTarget:u,handleToggleSelect:c.handleToggleSelect,checkboxAriaText:c.checkboxAriaText,checkboxTabIndex:c.isCheckboxFocusable?0:-1,href:c.href,overrideTabIndex:S,isCutToClipboard:c.isCutToClipboard,className:c.className,isMobile:this.props.isMobile,onHeightChange:this.handleContentTileHeightChange})):s.React$1.createElement(Mi,{file:m,paper:c.paper,key:c.id,onClick:c.onClick,onRightClick:c.onRightClick,onDoubleClick:c.onDoubleClick,onLabelClick:c.onLabelClick,width:this.state.tileWidth,leftOffset:t,tileIndex:e,labelHeight:f,delayRenderFullTile:d,actionNode:c.actionNode,thumbnailUrl:c.thumbnailUrl,labelNode:c.labelNode,altText:c.altText,onThumbnailError:this.props.logTileLoading?this.logTileError:void 0,onThumbnailLoad:this.props.logTileLoading?this.logTileLoaded:void 0,isDraggable:c.isDraggable,onDragEnter:c.onDragEnter,onDragStart:c.onDragStart,onDragEnd:c.onDragEnd,isFocused:c.isFocused,isSelectable:c.isSelectable,isSelected:h,isViewOnly:c.isViewOnly,isActiveDropTarget:p,isAvailableDropTarget:u,handleToggleSelect:c.handleToggleSelect,checkboxAriaText:c.checkboxAriaText,checkboxTabIndex:c.isCheckboxFocusable?0:-1,href:c.href,overrideTabIndex:S,isCutToClipboard:c.isCutToClipboard,className:c.className})},this.renderRow=(e,t,i)=>{const a=this.getRowHeight(t);if(!e)return s.React$1.createElement(B.CulledItem,{className:this.props.rowClass,height:a,key:t,tagName:"div",topOffset:i});if(!Array.isArray(e))return s.React$1.createElement(B.CulledItem,{className:this.props.rowClass,height:a,key:t,tagName:"div",topOffset:i},e);const[n,l]=e,o=this.state.tileWidth+this.props.tilePadding,r=[];let c=4;for(let e=n;e<l;e++)r.push(this.renderTileElement(e,c,r.length,i)),c+=o;return s.React$1.createElement(B.CulledItem,{className:this.props.rowClass,height:a,key:t,tagName:"div",topOffset:i},r)},this.handleRangeInView=function(e){let t=null;return(...i)=>{if(!t||t.length!==i.length||!t.every(((e,t)=>e===i[t])))return t=i,e(...i)}}(((e,t)=>{const{onRangeInView:i}=this.props;if(!i)return;if(0===this.props.totalNumItems)return;const[s,a]=this.translateRowRangeToItemRange(e,t);isNaN(s)||isNaN(a)||i(s,a)})),this.props.sectionLabels||this.props.sectionStartIndices){if(!this.props.sectionLabels||!this.props.sectionStartIndices)throw new Error("Included only one of `sectionLabels` or `sectionStartIndices`.");if(this.props.sectionLabels.length!==this.props.sectionStartIndices.length)throw new Error("sectionLabels and sectionStartIndices must be of same length.")}this.state={tileWidth:this.props.maxTileWidth,contentTileHeight:0},i.JSStopwatch.create_stopwatch_if_not_exist("infinite_tile_grid_logging"),this.resizeObserver=new V.index(this.updateLayout)}componentDidMount(){window.addEventListener("resize",this.updateLayout),this.updateLayout(),this.updateScroll(!0);const e=document.querySelector(".maestro-secondary-sidebar-v2");e&&this.resizeObserver.observe(e)}componentDidUpdate(e){this.tileLoadLogger&&this.tileLoadLogger.updateNumTiles(this.props.totalNumItems),e.scrollToIndex!==this.props.scrollToIndex&&this.updateScroll(void 0===e.scrollToIndex||e.scrollToIndex<0),e.maxTileWidth!==this.props.maxTileWidth&&this.updateLayout()}componentWillUnmount(){this.resizeObserver.disconnect(),window.removeEventListener("resize",this.updateLayout),this.animationFrameRequestId&&window.cancelAnimationFrame(this.animationFrameRequestId),this.tileLoadLogger&&(clearInterval(this.logTrackingInterval),this.tileLoadLogger=null)}getRowHeight(e){if(void 0!==e&&this.rowHeights)return this.rowHeights[e];let t=this.state.tileWidth+this.props.tilePadding;return"ON"===E.CONTENT_TILES&&(t=this.state.contentTileHeight+this.props.tilePadding),this.props.showLabels&&(t+=this.props.labelHeight+4),t}getPageHeight(){const e=(document.documentElement.clientHeight||window.outerHeight)-(this.props.contentOffset||0),t=this.getRowHeight(),i=t*Math.ceil(e/t);return Math.max(i,t)}setupTileLogging(e,t){const i=this.getPageHeight(),s=t*Math.ceil(i/e);this.tileLoadLogger=new vi(this.props.totalNumItems,s,t,this.handleTTI),this.tileLoadLogger.pagesToLog.add(0);const a=this.tileLoadLogger.getTimeNow();this.tileLoadLogger.startTimeByPage.set(0,a),this.logTrackingInterval=setInterval(this.setLastViewedPage,200,i)}translateRowRangeToItemRange(e,t){const{itemRangeByRow:i}=this;return[i[e][0],i[t][1]]}render(){this.itemRangeByRow=[],this.rowHeights=[],this.tileIndexToRowIndex=[];const e=[],t=this.getRowHeight(),{containerClass:i,enableMaxHeightGrouping:a,numThresholdRows:n,scrollDeltaThreshold:l,sectionStartIndices:o,sectionLabels:r,totalNumItems:c,window:d}=this.props;if(o&&o.length>0)o.forEach(((i,a)=>{let n=c;a!==o.length-1&&(n=o[a+1]),this.rowHeights.push(32);const l=n-i,d=Math.ceil(l/this.props.tilesPerRow),h=r[a],u=s.React$1.createElement("div",{className:"tile-section-header",role:"heading","aria-level":2},h);e.push(u),this.itemRangeByRow.push([i,i]);for(let s=0;s<d;s++){const a=i+s*this.props.tilesPerRow,l=Math.min(a+this.props.tilesPerRow,n),o=[a,l];e.push(o),this.itemRangeByRow.push(o);for(let e=a;e<l;e++)this.tileIndexToRowIndex.push(this.rowHeights.length);this.rowHeights.push(t)}}));else{const i=Math.ceil(c/this.props.tilesPerRow);for(let s=0;s<i;s++){const i=s*this.props.tilesPerRow,a=Math.min(i+this.props.tilesPerRow,c),n=[i,a];e.push(n),this.itemRangeByRow.push(n);for(let e=i;e<a;e++)this.tileIndexToRowIndex.push(this.rowHeights.length);this.rowHeights.push(t)}}return s.React$1.createElement(B.CulledList,{enableMaxHeightGrouping:a,items:e,listItemHeight:this.rowHeights,itemBuffer:n,className:i,renderRow:this.renderRow,scrollThreshold:l,shouldUseWindowAsScrollContainer:!0,onRangeInView:this.handleRangeInView,tagName:"div",window:d})}}function ls(e){e.stopPropagation()}ns.defaultProps={enableMaxHeightGrouping:!1,numThresholdRows:10,tilePadding:16,tileHeight:160,maxTileWidth:160,labelHeight:"ON"===E.CONTENT_TILES?0:40,logTileLoading:!1,scrollDeltaThreshold:1,showLabels:!0,getTileItem:()=>null,handleTTI:()=>{}},ns.displayName="InfiniteTileGrid";class os extends s.React$1.PureComponent{render(){const{fileRename:e,arePostTTIModulesLoaded:t,user:a,item:n,createRenameCancelHandler:l,createRenameSubmitHandler:o}=this.props;let r;if(r=n instanceof i.File?i.filename(n.fq_path):n instanceof i.FileSharedWithMe?n.filename:n instanceof i.Paper?n.title:n.name,n instanceof i.File&&e&&i.paths_are_equal(e.file.fq_path,n.fq_path)){if(e.state===i.RenameState.PENDING_INPUT)return s.React$1.createElement(Fi,{defaultValue:r,label:r,onCancel:l(n),onSubmit:o(n)});if(e.state===i.RenameState.SAVING_INPUT)return s.React$1.createElement(as,{className:"tile-label__text--saving",label:m.intl.formatMessage({id:"OefYpa",defaultMessage:"Renaming…"})})}const c=i.Emstring.em_snippet(r,14,.5),d=t&&n instanceof i.File&&!i.File.isNoAccessSharedFolder(n);let h=s.React$1.createElement(as,{key:"label",label:c});if(r!==c){const e=r.length<=i.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH?r:s.React$1.createElement("div",{className:"tile-label-tooltip"},r);h=s.React$1.createElement(D.TitleBubble,{content:e,position:y.StickyPosition.BOTTOM,className:"tile-label__title-bubble",key:"tooltip"},h)}const u=s.React$1.createElement(bt,{item:n,user:a,className:"tile-star",key:"tileStar",tabIndex:-1});return s.React$1.createElement("span",null,[h,d&&!e&&u])}}os.displayName="TileLabel";class rs extends s.React$1.PureComponent{constructor(){super(...arguments),this.tileGridRef=s.React$1.createRef(),this.state={inSelectMode:!1,selectedIds:i.immutable.exports.Set(),menuOpenId:void 0},this.createRenameCancelHandler=e=>()=>{this.props.onRenameCancel(e)},this.createRenameSubmitHandler=e=>t=>{this.props.onRenameSubmit(e,t)},this.logOverflowMenuOpen=()=>{const{selectedFiles:e,user:t,viewType:s}=this.props,a=e?e.count((e=>e.is_dir)):0,n=e?e.count()-a:0;i.logContextMenuClick({uid:t.id,viewType:s,action_surface:i.ActionSurfaceLogValue.CENTER_PANE,numFilesSelected:n,numFoldersSelected:a})},this.hrefForItem=(e,t)=>t instanceof i.File?this.props.hrefForFile(e,t):t instanceof i.FileSharedWithMe?t.href:t.url,this.getTileItem=(e,t)=>{const{activeDropTarget:s,isCreateFolderUIActive:a,isPhotosPage:n,items:l,selection:o,user:r,viewType:c,focusedFileIndex:d,disabledMultiselect:h,cutItems:u}=this.props,{menuOpenId:p}=this.state,{inSelectMode:g}=this.state;if(a){if(0===e)return this.getCreateFolderTile();e-=1}const f=l.get(e);if(!f){const t=`Placeholder ${e}`;return{altText:t,id:t,isViewOnly:!0,isDraggable:!1,isSelectable:!1}}const S=i.isFile(f)||i.isFswm(f),b=f,E=g&&S,T=d===e,w=E&&o.selected.some((e=>b instanceof i.FileSharedWithMe?b.file_id===e:b.fq_path===e)),_=this.createToggleSelectHandler(b,w),C=this.createRightClickSelectHandler(b,w),R=this.createClickHandler({item:f,inSelectModeAndIsFile:E,toggleSelectHandler:_}),F=this.createRightClickHandler({item:f,rightClickSelectHandler:C}),v=this.createViewFileHandler(f,i.ActionSourceValue.ROW_DOUBLE_CLICK),I=this.createViewFileHandler(f,i.ActionSourceValue.ROW_TITLE),N=i.isFile(f)?this.renderTileOverflowMenu(f,t,n):void 0,D=this.renderLabelElement(e),y=function(e){let t=e instanceof i.File?i.filename(e.fq_path):i.isFswm(e)?e.filename:e instanceof i.Paper?e.title:e.name;if(e instanceof i.File)switch(e.type){case i.FileTypes.FOLDER:t=m.intl.formatMessage({id:"C/gp+a",defaultMessage:"Folder, {alt}"},{alt:t});break;case i.FileTypes.PACKAGE:t=m.intl.formatMessage({id:"FhSkpL",defaultMessage:"Package, {alt}"},{alt:t});break;case i.FileTypes.SHARED_FOLDER:t=m.intl.formatMessage({id:"rWEPV0",defaultMessage:"Shared folder, {alt}"},{alt:t});break;case i.FileTypes.SANDBOX:t=m.intl.formatMessage({id:"+vbakm",defaultMessage:"Sandbox, {alt}"},{alt:t});break;case i.FileTypes.TEAM_SHARED_FOLDER:t=m.intl.formatMessage({id:"ZtOyAr",defaultMessage:"Team shared folder, {alt}"},{alt:t});break;case i.FileTypes.TEAM_MEMBER_FOLDER:t=m.intl.formatMessage({id:"1yRjbu",defaultMessage:"Team member folder, {alt}"},{alt:t});break;default:t=m.intl.formatMessage({id:"e8WrLw",defaultMessage:"File, {alt}"},{alt:t})}return t}(f),M=f===s,L=this.hrefForItem(r,f),O=f instanceof i.File||f instanceof i.FileSharedWithMe?W.getThumbnailUrlForItem(f.thumbnail_url_tmpl,i.ViewTypeThumbnailSizes[c]):void 0;return{file:b,paper:f instanceof i.Paper?f:void 0,fileSharedWithMe:f instanceof i.FileSharedWithMe?f:void 0,id:i.itemId(f),labelNode:D,altText:y,thumbnailUrl:O,actionNode:N,onClick:R,onRightClick:F,onDoubleClick:v,onLabelClick:I,isDraggable:!n&&(w||!E),isViewOnly:h,isFocused:T,isSelectable:S,handleToggleSelect:_,checkboxAriaText:m.intl.formatMessage({id:"o3Djy2",defaultMessage:"Select tile"}),href:L,onDragEnter:n?void 0:this.createDragEnterHandler(b,w,M),onDragStart:n?void 0:this.createDragStartHandler(b,w,_),onDragEnd:n?void 0:this.createDragEndHandler(),isCheckboxFocusable:n,isCutToClipboard:u&&i.isCutToClipboard(f,u),className:p===i.itemId(f)?"tile--hover-forced":void 0}},this.shouldFileBeHighlightedDropTarget=(e,t)=>{const{dropTargetHighlightMode:i}=this.props;return He({file:e,dropTargetHighlightMode:i})},this.scrollIntoView=({top:e,bottom:t},i)=>{const{viewportTopOffset:s=0}=this.props,{height:a,scrollTop:n,scrollTo:l}=this.getScrollPane(),o=a-s,r=n+o;e<n?l(0,e):t>r&&l(0,i&&t-e<o/2?t-o/2:t-o)}}UNSAFE_componentWillMount(){this.setState({inSelectMode:this.props.selectedFiles.count()>0}),this.setSelectedTiles(this.props)}componentDidMount(){this.setupExternalDragHandler(),this.setupKeyboardShortcuts()}componentWillUnmount(){this.props.isPhotosPage||b.resetFileJumpKeyboardShortcuts(v.SELECTABLE_TILE_GRID_KEY_SCOPE),b.resetFilesViewKeyboardShortcuts(v.SELECTABLE_TILE_GRID_KEY_SCOPE),Le(v.SELECTABLE_TILE_GRID_KEY_SCOPE)}UNSAFE_componentWillReceiveProps(e){e.selectedFiles!==this.props.selectedFiles&&(this.setSelectedTiles(e),this.setState({inSelectMode:e.selectedFiles.count()>0}))}componentDidUpdate(e){(e.createNewFolderState===i.NewFolderCreationState.PENDING_INPUT&&this.props.createNewFolderState===i.NewFolderCreationState.SAVING_INPUT||e.fileRename!==this.props.fileRename||e.items!==this.props.items||e.starredState!==this.props.starredState)&&this.tileGridRef.current&&this.tileGridRef.current.forceUpdate(),e.isActive!==this.props.isActive&&(this.props.isActive?this.setupKeyboardShortcuts():b.resetFilesViewKeyboardShortcuts(v.SELECTABLE_TILE_GRID_KEY_SCOPE))}getTotalNumItems(){const{items:e,totalNumItems:t,isCreateFolderUIActive:i}=this.props;let s=Math.max(e.size,t);return i&&(s+=1),s}createToggleSelectHandler(e,t){const s=e instanceof i.FileSharedWithMe?e.file_id:e.fq_path;return e=>{const{onDeselectFile:i,onSelectFile:a}=this.props,n=Boolean(!("keyCode"in e)&&e.shiftKey);t?i(s,n):a(s,n?v.SelectOptions.EXTEND:v.SelectOptions.DEFAULT)}}createRightClickSelectHandler(e,t){const s=e instanceof i.FileSharedWithMe?e.file_id:e.fq_path;return e=>{const{onSelectFile:i}=this.props,a=Boolean(!("keyCode"in e)&&(e.shiftKey||e.metaKey||e.ctrlKey));t||i(s,a?v.SelectOptions.EXTEND:v.SelectOptions.DEFAULT)}}renderTileOverflowMenu(e,t,a){const{getOverflowMenuActions:n,arePostTTIModulesLoaded:l,inlineActions:o}=this.props;return o&&e instanceof i.File?s.React$1.createElement("div",{onClick:ls},s.React$1.createElement(o,{file:e,className:"tile__action-button--overflow-menu",onHoverLocked:({isOpen:t})=>{this.setState({menuOpenId:t?i.itemId(e):void 0})}})):l&&s.React$1.createElement(oi,{file:e,getOverflowMenuActions:n,size:li.Small,showBorders:!0,ariaHidden:!a,onMenuOpen:this.logOverflowMenuOpen})}renderLabelElement(e){const{items:t,focusedFileIndex:i,user:a,fileRename:n,arePostTTIModulesLoaded:l,isPhotosPage:o}=this.props;if(o)return;const r=t.get(e);if(!r)return;const{inSelectMode:c}=this.state,d=i===e;return s.React$1.createElement(os,{item:r,user:a,fileRename:n,arePostTTIModulesLoaded:l,inSelectMode:c,isTileFocused:d,createRenameCancelHandler:this.createRenameCancelHandler,createRenameSubmitHandler:this.createRenameSubmitHandler})}createViewFileHandler(e,t){return s=>{if(s.preventDefault(),s.stopPropagation(),"click"===s.type){const t=s;if(0===t.button){const s=this.hrefForItem(this.props.user,e);if(i.hasModifierKey(t))return void i.open_tab(s)}}e instanceof i.File?this.props.onNavigateToFileOrFolder(e,{actionSource:t}):e instanceof i.FileSharedWithMe?this.props.onOpenFileSharedWithMe(e):e instanceof i.Paper&&this.props.onOpenPaper(e)}}createClickHandler({item:e,inSelectModeAndIsFile:t,toggleSelectHandler:s}){const a=e instanceof i.File||e instanceof i.FileSharedWithMe;return t=>{if(a){const a="keyCode"in t;if(t.preventDefault(),a)s(t);else{const a=e instanceof i.FileSharedWithMe?e.file_id:e.fq_path;this.props.onSelectFile&&(t.shiftKey?this.props.onSelectFile(a,v.SelectOptions.EXTEND):t.ctrlKey||t.metaKey?s(t):this.props.onSelectFile(a,v.SelectOptions.ONLY))}}}}createRightClickHandler({item:e,rightClickSelectHandler:t}){const s=e instanceof i.File||e instanceof i.FileSharedWithMe;return a=>{if(!s)return;const n="keyCode"in a;if(a.preventDefault(),n)t(a);else{if(!this.props.onSelectFile)return;const t=e instanceof i.FileSharedWithMe?e.file_id:e.fq_path,s=a.shiftKey||a.ctrlKey||a.metaKey?v.SelectOptions.EXTEND:v.SelectOptions.ONLY;this.props.onSelectFile(t,s)}}}setSelectedTiles(e){const t=i.immutable.exports.Set().withMutations((t=>{e.selectedFiles.forEach((e=>{var s;t.add((s=e)instanceof i.FileSharedWithMe?s.file_id:s.fq_path)}))}));this.setState({selectedIds:t})}setupExternalDragHandler(){Me(v.SELECTABLE_TILE_GRID_KEY_SCOPE,(()=>!!this.props.isDraggingInternalFiles),(()=>!!this.props.isDraggingExternalFiles),this.props.onSetFileUploaderPath,".tile",(()=>this.props.activeDropTarget),this.props.onSetDropTarget)}setupKeyboardShortcuts(){const{user:e,viewType:t,onDelete:i,onShowRename:s,deselectAll:a,getIsCurrentPathWriteable:n,getIsFileJumping:l,onAddFileJumpKeyCode:o,onResetFileJump:r,onCopyToClipboard:c,onCutToClipboard:d,onFocusSearchBar:h,onPasteFromClipboard:u,selectAll:p}=this.props,m=b.generateGetIsGlobalEvent(this),g=m;this.props.isPhotosPage||b.setupFileJumpKeyboardShortcuts({scope:v.SELECTABLE_TILE_GRID_KEY_SCOPE,getIsFileJumping:l,onAddFileJumpKeyCode:o,onResetFileJump:r}),b.setupFilesViewKeyboardShortcuts({user:e,viewType:t,getIsGlobalEvent:m,getIsItemEvent:g,getSelectedFiles:()=>this.props.selectedFiles,isCurrentPathWriteable:n,selectAllAction:p,deselectAllAction:a,onCopyToClipboard:c,onCutToClipboard:d,onDelete:i,onFocusSearchBar:h,onPasteFromClipboard:u,onShowRename:s,onNavigateToFileOrFolder:()=>{},onNavigateToParentFolder:()=>{},scope:v.SELECTABLE_TILE_GRID_KEY_SCOPE,onShowHelpMenu:this.props.onOpenKeyboardShortcutModal})}createDragEnterHandler(e,t,i){return s=>{this.props.onDragEnter(s,e,t,i)}}createDragStartHandler(e,t,i){const{preventSelectionOnDrag:s}=this.props;return a=>{t?this.props.onDragStart(a):(s||i(a),this.props.onDragStart(a,[e]))}}createDragEndHandler(){return e=>{this.props.onDragEnd(e)}}getCreateFolderTile(){const{createNewFolderState:e,onNewFolderCancel:t,onNewFolderSubmit:a}=this.props;let n=m.intl.formatMessage({id:"pxGZm3",defaultMessage:"New folder"}),l=s.React$1.createElement("div",null);return e===i.NewFolderCreationState.PENDING_INPUT?(n=m.intl.formatMessage({id:"ss4CO0",defaultMessage:"Folder name"}),l=s.React$1.createElement(Fi,{label:n,onCancel:t,onSubmit:a})):e===i.NewFolderCreationState.SAVING_INPUT&&(n=m.intl.formatMessage({id:"p58M12",defaultMessage:"Creating new folder…"}),l=s.React$1.createElement(as,{className:"tile-label__text--saving",label:n})),{altText:n,id:"New folder tile",isDraggable:!1,isSelectable:!1,labelNode:l}}getScrollPane(){const{scrollContainer:e}=this.props;if(e&&e.current){const{clientHeight:t,scrollTop:i,scrollTo:s}=e.current;return{height:t,scrollTop:i,scrollTo:s?s.bind(e.current):()=>{}}}return{height:window.innerHeight,scrollTop:"scrollingElement"in window.document&&window.document.scrollingElement?window.document.scrollingElement.scrollTop:window.document.documentElement.scrollTop,scrollTo:window.scrollTo?window.scrollTo.bind(window):()=>{}}}getWindow(){const{scrollContainer:e}=this.props;return e&&e.current?i.createFakeWindow(e.current):window}render(){const{enableMaxHeightGrouping:e,sections:t,viewType:a,viewportTopOffset:n,scrollContainer:l,scrollPositionOffset:o,registerSelectableTile:r,isPhotosPage:c}=this.props,d=i.classnames({"file-tile-grid-container":!0,"file-tile-grid-container--show-checkboxes":this.state.inSelectMode,"file-tile-grid-container--click-to-select":!0}),h=new Set;if(this.state.selectedIds.forEach((e=>h.add(e))),l&&!l.current)return null;let u=i.ViewTypeGridSizes[a],p=i.ViewTypeGridSizes[a];"ON"===E.CONTENT_TILES&&(a===i.ViewType.Grid?(u=i.ContentTileConstants.SMALL_GRID_VIEW_MAX_WIDTH,p=i.ContentTileConstants.SMALL_GRID_VIEW_MAX_HEIGHT):a===i.ViewType.LargeGrid&&(u=i.ContentTileConstants.LARGE_GRID_VIEW_MAX_WIDTH,p=i.ContentTileConstants.LARGE_GRID_VIEW_MAX_HEIGHT));const m=!this.props.responsive.isMatchedLarge&&!this.props.responsive.isMatchedMedium;return s.React$1.createElement("div",{role:"grid","aria-multiselectable":"true"},s.React$1.createElement(ns,{key:"tileGrid",ref:this.tileGridRef,totalNumItems:this.getTotalNumItems(),containerClass:d,rowClass:"file-tile-row",enableMaxHeightGrouping:e,delayRenderFullTile:!this.props.isCreateFolderUIActive,logTileLoading:!0,numThresholdRows:i.FilesViewTileGridConstants.NUM_THRESHOLD_ROWS,scrollDeltaThreshold:i.FilesViewTileGridConstants.SCROLL_DELTA_THRESHOLD,sectionStartIndices:t.sectionStartIndices,sectionLabels:t.sectionLabels,showLabels:!c||"ON"===E.CONTENT_TILES,contentOffset:n,getTileItem:this.getTileItem,selectedIds:h,handleTTI:this.props.onTTI,onRangeInView:this.props.onRangeInView,tilesPerRow:this.props.tilesPerRow,onTilesPerRowChange:this.props.onTilesPerRowChange,activeDropTarget:this.props.activeDropTarget,maxTileWidth:u,tileHeight:p,shouldFileBeHighlightedDropTarget:this.shouldFileBeHighlightedDropTarget,scrollToIndex:this.props.focusedFileIndex,scrollIntoView:this.scrollIntoView,scrollPositionOffset:o||0,window:this.getWindow(),registerSelectableTile:r,isMobile:m}))}}rs.defaultProps={enableMaxHeightGrouping:!1},rs.displayName="FilesViewTileGrid";const cs=(e,t)=>!(e.top+e.height<t.top||e.top>t.top+t.height||e.left+e.width<t.left||e.left>t.left+t.width),ds=d.throttle((function(e,t,s,a,n){Object.keys(e).forEach((l=>{cs(e[l],t)?(null==n?void 0:n.selected.has(l))||s(l,v.SelectOptions.DEFAULT,i.ActionSourceValue.DRAG_TO_SELECT):(null==n?void 0:n.selected.has(l))&&a(l,!1,i.ActionSourceValue.DRAG_TO_SELECT)}))}),25),hs=e=>{let t=e.target;for(;t instanceof Node&&t!==e.currentTarget;){if(!0===t.draggable)return!0;t=t.parentElement}return!1},us=i.requireCssWithComponent((e=>{const[t,a]=s.React$1.useState(!1),[n,l]=s.React$1.useState(!1),[o,r]=s.React$1.useState(0),c=s.React$1.useRef(null),h=s.React$1.useRef({}),[u,p]=s.React$1.useState({top:0,left:0}),[m,g]=s.React$1.useState({top:0,left:0,width:0,height:0}),f=s.react.exports.useCallback(((e,t)=>{var i;const s=t.top+40,a=null===(i=c.current)||void 0===i?void 0:i.getBoundingClientRect();if(a){const i=t.width||a.width;h.current[e]={top:s,width:i,left:t.left,height:t.height}}}),[]);s.React$1.useEffect((()=>{t&&ds(h.current,m,e.handleSelect,e.handleDeselect,e.selection)}),[t,m,e.selection,e.handleSelect,e.handleDeselect]);const S=s.react.exports.useCallback((s=>{var o;if(n){if(1!==s.buttons)return l(!1),void a(!1);const n=null===(o=c.current)||void 0===o?void 0:o.getBoundingClientRect();let r=s.clientX-((null==n?void 0:n.left)||0),d=s.clientY-((null==n?void 0:n.top)||0);d<0&&(d=0),r<0&&(r=0),n&&r-10>n.width&&(r=n.width-10),n&&d-20>n.height&&(d=n.height-20);const h={top:Math.min(u.top,d),left:Math.min(u.left,r),height:Math.abs(u.top-d),width:Math.abs(u.left-r)};!t&&h.width<=5&&h.height<=5||(t?t&&g(h):(s.preventDefault(),e.updateSelection([],i.ActionSourceValue.DRAG_TO_SELECT,!0),g(h),a(!0)))}}),[n,u.top,u.left,t,e]),b=s.react.exports.useCallback((e=>{n&&(t&&r(Date.now()),a(!1),l(!1),g({top:0,left:0,width:0,height:0}),p({top:0,left:0}),e.preventDefault())}),[t,n]);s.React$1.useEffect((()=>{const e=d.throttle(S,8);return n&&(window.document.addEventListener("mouseup",b),window.document.addEventListener("mousemove",e)),()=>{window.document.removeEventListener("mousemove",e),window.document.removeEventListener("mouseup",b)}}),[n,t,S,b]);const E=s.react.exports.useCallback((e=>{Date.now()-o<50&&e.preventDefault(),window.document.removeEventListener("click",E,!0)}),[o]);if(s.React$1.useEffect((()=>(window.document.addEventListener("click",E,!0),()=>{window.document.removeEventListener("click",E,!0)})),[E]),!e.isDragToSelectEnabled){const t=(e,t)=>{};return s.React$1.createElement("div",null,e.children({registerSelectableItem:t}))}return s.React$1.createElement("div",{className:"files-view_drag-to-select",onMouseDown:t=>{var i;if(!t.isDefaultPrevented()&&!n&&1===t.buttons){const s=null===(i=c.current)||void 0===i?void 0:i.getBoundingClientRect(),a=t.clientX-((null==s?void 0:s.left)||0),n=t.clientY-((null==s?void 0:s.top)||0);((e,t,i,s)=>!(hs(e)||e.target!==e.currentTarget&&(null==i?void 0:i.selected)&&i.selected.some((e=>s[e]&&cs(s[e],Object.assign(Object.assign({},t),{height:0,width:0}))))))(t,{top:n,left:a},e.selection,h.current)&&(p({top:n,left:a}),g({top:n,left:a,width:0,height:0}),l(!0))}},ref:c},s.React$1.createElement("div",{className:"files-view_drag-to-select-removal"},e.children({registerSelectableItem:f})),t&&s.React$1.createElement("div",{className:"files-view_select-box",style:{top:m.top+"px",left:m.left+"px",width:m.width+"px",height:m.height+"px"}}))}),["/static/metaserver/static/css/files_view/drag_to_select-vfl1pMR5V.css"]),ps=({items:t,userId:a})=>{const[n,l]=s.React$1.useState(void 0);return s.React$1.useEffect((()=>{const t=i.makeCancelable(r.__awaiter(void 0,void 0,void 0,(function*(){return yield i.waitForTTI(),(yield new Promise((function(t,i){e(["./c_unity_browse_interface"],t,i)}))).unityBrowseInterface})));return t.then((e=>l(e))),()=>t.cancel()}),[]),s.React$1.useEffect((()=>{null==n||n.browse_visible_change_callback(t.toArray().filter((e=>e instanceof i.File)),a,0,t.size-1)}),[n,t,a]),null};ps.displayName="UnityListener";const ms=i.Loadable({loader:()=>new Promise((function(t,i){e(["./c_src_file-drag_index"],t,i)})).then((({InternalFileDrag:e})=>e))}),gs=[i.NameSpaceAccess.ACCESS_NO_ACCESS,i.NameSpaceAccess.ACCESS_READER,i.NameSpaceAccess.ACCESS_READER_NO_COMMENT],fs={keyboard:i.ActionSourceValue.KEYBOARD,drag_to_select:i.ActionSourceValue.DRAG_TO_SELECT},Ss=[];function bs(e){return e.some(Es)}function Es(e){return e instanceof i.File||e instanceof i.FileSharedWithMe}class Ts extends s.React$1.Component{constructor(){super(...arguments),this.internalDragStatusRef=s.React$1.createRef(),this.state={dropTarget:null,tilesPerRow:1,draggedFiles:null},this.handleCopyToClipboard=()=>{const{selectedFiles:e,onSetClipboard:t}=this.props;e.size&&t({files:e.toArray(),action:"copy"})},this.handleCutToClipboard=()=>{const{selectedFiles:e,onSetClipboard:t}=this.props,i=e.filter((e=>!e.read_only));i.size&&t({files:i.toArray(),action:"cut"})},this.handleNewFolderSubmit=e=>{""===e?(this.props.onNewFolderCancel(),this.handleNewFolderCancel({source:i.NameInputActionSource.SUBMIT})):this.props.onNewFolderSubmit(e)},this.handleNewFolderCancel=({source:e})=>{e!==i.NameInputActionSource.ESC&&q.Notify.error(m.intl.formatMessage({id:"9xXIAi",defaultMessage:"Please provide a name for the new folder."})),this.props.onNewFolderCancel()},this.handleSetFileUploaderPath=e=>{const t=e?e.path:this.props.path;let i=this.props.context.isCurrentPathWriteable();e&&e.hasOwnProperty("hasPermissionToUploadToFolder")&&(i=!!e.hasPermissionToUploadToFolder);const s=!!(null==e?void 0:e.isMovingIntoVault);this.props.setFileUploaderPath({path:t,hasPermissionToUploadToFolder:i,isMovingIntoVault:s,targetSurface:"files_view"})},this.handleDragStart=(e,t=[])=>{var a;const{path:n,selectedFiles:l,user:o,preventSelectionOnDrag:r}=this.props;let h=d.keyBy(t,"fq_path");0!==t.length&&r||(h=Object.assign(Object.assign({},h),l.toJS()));const u=d.values(h),{isInsideBackupFolder:p}=this.props;if(p)return void q.Notify.error(m.intl.formatMessage({id:"+HTDO0",defaultMessage:"Backup contents can’t be moved."}));if(null==u?void 0:u.some((e=>i.isBackupFolderIcon(e))))return void q.Notify.error(m.intl.formatMessage({id:"isN1D3",defaultMessage:"Backups can’t be moved."}));if(u.some((e=>i.File.isTeamSharedFolder(e))))return void q.Notify.error(m.intl.formatMessage({id:"1cIg3V",defaultMessage:"Team folders can’t be moved."}));if(u.some((e=>i.File.isTeamMemberFolder(e))))return void q.Notify.error(m.intl.formatMessage({id:"ZxTpZJ",defaultMessage:"Your member folder can’t be moved."}));const g=e.dataTransfer;if(!g)return;if(this.setState({draggedFiles:u}),g.setDragImage&&(null===(a=this.internalDragStatusRef)||void 0===a?void 0:a.current)){const e=s.reactDom.exports.findDOMNode(this.internalDragStatusRef.current);e&&g.setDragImage(e,-10,-10)}const f={userId:o.id,fromPath:n,fileInfos:u.map((e=>({target_ns:e.target_ns,file_id:e.file_id,is_dir:e.is_dir,fq_path:e.fq_path})))};g.setData(c.INTERNAL_FILE_DATA_TRANSFER_TYPE,JSON.stringify(f)),g.effectAllowed="copyMove",this.props.onDragStart&&this.props.onDragStart(e,u)},this.handleDragEnter=(e,t,s,a)=>{const{draggedFiles:n}=this.state;n&&i.isBackupFolderIcon(t)&&q.Notify.error(m.intl.formatMessage({id:"rRI7QJ",defaultMessage:"Files can’t be moved into backups."}));const l=null==n?void 0:n.some((e=>e.fq_path===t.fq_path));!function(e,t,s,a,n,l,o,r){if(!t&&!s)return;if(!e.is_dir||a&&s||i.isBackupFolderIcon(e))o(null),r();else{if(n)return;const t=l.isCurrentPathWriteable()&&!i.File.isReadOnlySharedFolder(e);o(e),r({path:e.fq_path,hasPermissionToUploadToFolder:t,isMovingIntoVault:Boolean(e.is_in_vault_folder)})}}(t,!!this.props.isDraggingExternalFiles,!!this.props.isDraggingInternalFiles,!!l,a,this.props.context,this.handleSetDropTarget,this.handleSetFileUploaderPath)},this.handleDragEnd=e=>{this.setState({draggedFiles:null}),this.props.onDragEnd&&this.props.onDragEnd(e)},this.handleSetDropTarget=e=>{this.setState({dropTarget:e}),this.props.updateDropTarget&&this.props.updateDropTarget(e)},this.handleSelectionChange=(e,t)=>{const i=t?t in v.SelectableListActionSource?fs[t]:t:void 0;this.props.onSelectionChange(e,i)},this.onAllCheckboxDeselectAll=()=>{const{selection:e,onSelectionChange:t}=this.props;t(e.set("selected",i.immutable.exports.OrderedSet()),i.ActionSourceValue.ALL_CHECKBOX)},this.onAllCheckboxSelectAll=()=>{const{items:e,selection:t,onSelectionChange:s}=this.props;s(t.set("selected",i.immutable.exports.OrderedSet(e.filter(Es).map((e=>"fq_path"in e?this.props.fileToId(e):e.file_id)))),i.ActionSourceValue.ALL_CHECKBOX)},this._handleGetOverflowMenuActions=(e,t)=>{const{getOverflowMenuActions:i,responsive:s}=this.props;return i(e,t,s)},this.handleTTI=()=>{this.props.onComponentTTI("FilesViewController")},this.getIsCurrentPathWriteable=()=>this.props.context.isCurrentPathWriteable(),this.onTilesPerRowChange=e=>{this.setState({tilesPerRow:e})},this.onDeselectAll=()=>{this.props.isSearchMode&&this.props.onFocusSearchBar()},this.logRightClick=e=>{const{selectedFiles:t,user:s,viewType:a}=this.props,n=t?t.count((e=>e.is_dir)):0,l=t?t.count()-n:0;i.logRightClickItems({uid:s.id,viewType:a,action_surface:i.ActionSurfaceLogValue.CENTER_PANE,numFilesSelected:l,numFoldersSelected:n})},this.InternalFileDragHelper=()=>{const e=this.state.draggedFiles||Ss,t=e.length;let a="",n=!1,l="";return t>0&&(a=i.filename(e[0].fq_path),n=e[0].is_dir,l=e[0].icon),s.React$1.createElement(ms,{ref:this.internalDragStatusRef,numberOfFiles:t,firstFileName:a,isFolder:n,icon:l})}}shouldComponentUpdate(e){return e.loadingState!==this.props.loadingState||e.loadingState!==i.LoadingState.LOADING_FIRST_PAGE&&e.loadingState!==i.LoadingState.UPDATING_FILTERED_VIEW||(a=e.context,n=this.props.context,!!(a&&n&&a.currentFQPath!==n.currentFQPath||(t=e.items,s=this.props.items,t!==s)));var t,s,a,n}renderEmptyFolderView(){const{context:e,customEmptyFolderView:t,onFocusSearchBar:i,onPasteFromClipboard:a,onNavigateToParentFolder:n,isDraggingExternalFiles:l,isColumnResizingEnabled:o,scrollContainerWidth:r,isInsideBackupFolder:c}=this.props;if(t){const e=t({isDraggingExternalFiles:!!l,handleTTI:this.handleTTI,isColumnResizingEnabled:o,width:r});if(e)return e}const{isInsideSharedFolder:d,currentSharedFolderPermissionRole:h}=e,u=d&&gs.includes(h)?void 0:c?m.intl.formatMessage({id:"qgGik0",defaultMessage:"Files added to your device will appear here"}):m.intl.formatMessage({id:"jXqkXG",defaultMessage:"Drag and drop files onto this window to upload."});return s.React$1.createElement(ke,{title:m.intl.formatMessage({id:"YLBqRL",defaultMessage:"This folder is empty"}),subtitle:u,onTTI:this.handleTTI,onFocusSearchBar:i,onPasteFromClipboard:a,onNavigateToParentFolder:n,onOpenKeyboardShortcutModal:this.props.openKeyboardShortcutsModal})}getSelectAllCheckboxCheckedVariant(){const{selectedFiles:e,items:t}=this.props;let i="unchecked";return e.size===t.filter(Es).size?i="checked":e.size&&(i="mixed"),i}isCreateFolderUIActive(){const{createNewFolderState:e}=this.props;return e&&"CREATE_FOLDER_INACTIVE"!==e}shouldShowEmptyFolderView(){return this.props.loadingState===i.LoadingState.LOADED&&!this.props.items.size&&!this.isCreateFolderUIActive()}render(){const{id:e,onDelete:t,onShowRename:l,onRenameSubmit:o,onRenameCancel:r,onSwitchViewType:c,onPasteFromClipboard:d,onColumnsChanged:h,onCanDisplayFolderSizesChanged:u,onFocusSearchBar:p,currentSort:m,createNewFolderState:g,context:f,columns:S,dropTargetHighlightMode:b,fileRename:E,getIsFileJumping:w,onAddFileJumpKeyCode:_,onResetFileJump:C,hideViewFileButton:R,items:F,itemIds:I,isCompactMode:N,isSearchMode:D,isSearchTopRightSortEnabled:y,isDraggingExternalFiles:M,isDraggingInternalFiles:L,isQueryingFolderSizes:O,isFileViewerShown:k,loadingState:x,onSortChange:A,path:$,responsive:P,selectedFiles:H,selection:W,renderSharedWithController:V,onShowShare:B,totalNumFiles:z,user:U,viewType:G,viewTypeColumns:K,onLocationLinkClick:j,onNavigateToFileOrFolder:q,onNavigateToParentFolder:Y,onOpenFileSharedWithMe:X,onOpenPaper:J,arePostTTIModulesLoaded:Z,scrollContainer:Q,stickyOffsetTop:ee,disabledMultiselect:te,isStickyColumnHeader:ie,onRangeInView:se,highDensity:ne,filteredContactName:le,sections:oe,preferredColumns:re,isDragToSelectEnabled:ce,cutItems:de,numVisibleColumns:he,isListView:ue,isActive:pe,enableUnity:me,inlineActionBar:ge,scrollContainerWidth:fe,columnResizeStorageSetting:Se,isColumnResizingEnabled:be,expManualTagging:Ee,useSkinnyCheckboxes:Te,isRightClickEnabled:we}=this.props,{isMatchedLarge:_e,isMatchedMedium:Ce}=P,{dropTarget:Re,tilesPerRow:Fe}=this.state;if(x===i.LoadingState.LOADING_FIRST_PAGE||x===i.LoadingState.UPDATING_FILTERED_VIEW)return Z?s.React$1.createElement(a.MediaTableSkeleton,{numRows:15}):null;const ve=!!H.size,Ie=!!be;if(this.shouldShowEmptyFolderView())return s.React$1.createElement("div",{className:"brws-files-view"},this.renderEmptyFolderView(),me&&s.React$1.createElement(ps,{items:this.props.unityItems,userId:U.id}));const Ne=_e?i.DEFAULT_COLUMN_HEADER_HEIGHT:i.COMPACT_COLUMN_HEADER_HEIGHT,ye=Ne+ee,Me=this.props.scrollPositionOffset||0;return s.React$1.createElement("div",{className:i.classnames("brws-files-view",`brws-files-view--${G.toLowerCase()}`,{"brws-files-view-condensed-list":G===i.ViewType.CondensedList}),onContextMenu:this.logRightClick},s.React$1.createElement(ae,{columns:S,viewTypeColumns:K,currentSort:m,onCanDisplayFolderSizesChanged:u,onColumnsChanged:h,isMatchedLarge:_e,isMatchedMedium:Ce,isSearchMode:D,viewType:G,responsiveContainer:D,preferredColumns:re,isMoreColumnsEnabled:Ie,numVisibleColumns:he,scrollContainerWidth:fe,columnResizeStorageSetting:Se},(({visibleColumns:a,handleSelection:h,canDisplayFolderSizes:u,containerWidth:x,handleReorder:K})=>{const ae=(D?i.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX:i.LIST_VIEW_COLUMN_FLEX)[a.length];Te&&ae&&(ae[0]=i.CHECKBOX_CELL_FLEX_RIGHT_RAIL);const re={columnFlex:ae,currentSort:m,isCompactMode:N,isSelectMode:ve,onDeselectAll:this.onAllCheckboxDeselectAll,onSelectAll:this.onAllCheckboxSelectAll,onSelection:(e,t,s)=>{var n,l;e.popoverTriggerLabel!==t.popoverTriggerLabel&&T.logEvent({user:U,action:i.WebUserActionLogEvent.SWITCH_COLUMN_TYPE,extra:{column_position:(s+1).toString(),selected_column_header:null!==(n=e.loggingLabel)&&void 0!==n?n:e.popoverTriggerLabel,open_from_column_header:null!==(l=e.loggingLabel)&&void 0!==l?l:t.popoverTriggerLabel,action_type:a.includes(e)?"deselected":"selected"}}),h(e,t)},onSort:A,onMenuOpen:(e,t)=>{T.logEvent({user:U,action:i.WebUserActionLogEvent.SELECT_COLUMN_MENU,extra:{column_position:(e+1).toString(),column_header:t}})},onReorder:K,onSwitchViewType:c,selectAllCheckboxState:this.getSelectAllCheckboxCheckedVariant(),showSelectAllCheckbox:bs(this.props.items),stickyOffsetHeight:Ne,stickyOffsetTop:ee,columns:S,visibleColumns:a,viewType:G,isSearchMode:D,isSearchTopRightSortEnabled:y,presentationOnly:ue,isMoreColumnsEnabled:ue&&Ie,items:F};return ue?s.React$1.createElement(v.SelectableList,{itemIds:I,keyScope:v.SELECTABLE_LIST_KEY_SCOPE,onSelectionChange:this.handleSelectionChange,selection:W,tilesPerRow:Fe,onDeselectAll:this.onDeselectAll,isActive:pe},(({focusedFileId:c,handleDeselect:h,handleFocusFile:m,handleSelect:S,isSelectableListEvent:T,updateSelection:F})=>s.React$1.createElement(us,{handleSelect:S,handleDeselect:h,updateSelection:F,selection:W,isDragToSelectEnabled:ce},(({registerSelectableItem:F})=>{var y,O;return s.React$1.createElement(n.Table,{"aria-rowcount":z,className:i.classnames("brws-files-view-list",{"brws-files-view-list-high-density":ne}),columnFlex:ae},s.React$1.createElement(De,Object.assign({},re,{variant:Q?"sticky-native":ie?"sticky":"fixed"})),s.React$1.createElement(Ci,{onTTI:this.handleTTI,registerListItem:F,instanceId:e,onDelete:t,onShowRename:l,activeDropTarget:Re,context:f,createNewFolderState:g,dropTargetHighlightMode:b,fileRename:E,focusedFileIndex:c?I.indexOf(c):void 0,getOverflowMenuActions:this._handleGetOverflowMenuActions,getIsCurrentPathWriteable:this.getIsCurrentPathWriteable,getIsFileJumping:w,onAddFileJumpKeyCode:_,onResetFileJump:C,isCompactMode:N,hideViewFileButton:!!R,isDraggingExternalFiles:M,isDraggingInternalFiles:L,isFileViewerShown:k,isSearchMode:D,isSelectMode:ve,isSelectableListEvent:T,arePostTTIModulesLoaded:Z,keyScope:v.SELECTABLE_LIST_KEY_SCOPE,onCopyToClipboard:this.handleCopyToClipboard,onCutToClipboard:this.handleCutToClipboard,onDragStart:this.handleDragStart,onDragEnter:this.handleDragEnter,onDragEnd:this.handleDragEnd,onDeselectFile:h,onFocusFile:m,onFocusSearchBar:p,onOpenKeyboardShortcutModal:this.props.openKeyboardShortcutsModal,onLocationLinkClick:j,onNavigateToFileOrFolder:q,onNavigateToParentFolder:Y,onNewFolderCancel:this.handleNewFolderCancel,onNewFolderSubmit:this.handleNewFolderSubmit,onOpenFileSharedWithMe:X,onOpenPaper:J,onPasteFromClipboard:d,onRenameCancel:r,onRenameSubmit:o,onSelectFile:S,onSetDropTarget:this.handleSetDropTarget,onSetFileUploaderPath:this.handleSetFileUploaderPath,responsive:P,scrollPositionOffset:Me,selectedFiles:H,selection:W,renderSharedWithController:V,hrefForFile:this.props.hrefForFile,onShowShare:B,user:U,viewportTopOffset:ye,visibleColumns:a,canDisplayFolderSizes:u,scrollContainer:Q,shareButtonLabel:this.props.shareButtonLabel,showShareButton:this.props.showShareButton,starredState:this.props.starredState,onRangeInView:se,containerWidth:x,highDensity:ne,filteredContactName:le,fileToId:this.props.fileToId,eligibleForFirstTaskSubtitle:this.props.eligibleForFirstTaskSubtitle,expVaultEnableViewOnlySharing:this.props.expVaultEnableViewOnlySharing,expManualTagging:Ee,preventSelectionOnDrag:this.props.preventSelectionOnDrag,defaultListviewIconSize:null===(y=this.props.overrides)||void 0===y?void 0:y.defaultListviewIconSize,isBoldFileNamesEnabled:null===(O=this.props.overrides)||void 0===O?void 0:O.isBoldFileNamesEnabled,isRightClickEnabled:we}))})))):s.React$1.createElement(v.SelectableList,{itemIds:I,keyScope:v.SELECTABLE_TILE_GRID_KEY_SCOPE,onSelectionChange:this.handleSelectionChange,selection:W,tilesPerRow:Fe,sectionStartIndices:oe.sectionStartIndices,isActive:pe},(({handleDeselect:e,handleDeselectAll:a,handleFocusFile:c,handleSelect:h,handleSelectAll:u,updateSelection:m,focusedFileId:S})=>s.React$1.createElement(us,{handleSelect:h,handleDeselect:e,updateSelection:m,selection:W,isDragToSelectEnabled:ce},(({registerSelectableItem:m})=>s.React$1.createElement(s.React$1.Fragment,null,s.React$1.createElement(n.Table,{columnFlex:Te?i.GRID_VIEW_COLUMN_FLEX_RIGHT_RAIL:i.GRID_VIEW_COLUMN_FLEX,role:"presentation",style:Q?{position:"sticky",top:ee,zIndex:1}:void 0},s.React$1.createElement(De,Object.assign({},re,{variant:Q?"default":ie?"sticky":"fixed",disableResizing:!0}))),s.React$1.createElement(rs,{onDelete:t,disabledMultiselect:te||!1,onShowRename:l,activeDropTarget:Re,arePostTTIModulesLoaded:Z,createNewFolderState:g,context:f,deselectAll:a,dropTargetHighlightMode:b,fileRename:E,getOverflowMenuActions:this._handleGetOverflowMenuActions,getIsCurrentPathWriteable:this.getIsCurrentPathWriteable,getIsFileJumping:w,onAddFileJumpKeyCode:_,onResetFileJump:C,onTTI:this.handleTTI,items:F,isCreateFolderUIActive:this.isCreateFolderUIActive(),isDraggingExternalFiles:M,isDraggingInternalFiles:L,isQueryingFolderSizes:O,isSearchMode:D,onCopyToClipboard:this.handleCopyToClipboard,onCutToClipboard:this.handleCutToClipboard,onDeselectFile:e,onDragEnter:this.handleDragEnter,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onFocusFile:c,onFocusSearchBar:p,onNewFolderCancel:this.handleNewFolderCancel,onNewFolderSubmit:this.handleNewFolderSubmit,onNavigateToFileOrFolder:q,onOpenFileSharedWithMe:X,onOpenPaper:J,onOpenKeyboardShortcutModal:this.props.openKeyboardShortcutsModal,onPasteFromClipboard:d,onRangeInView:se,onRenameCancel:r,onRenameSubmit:o,onSelectFile:h,onSetDropTarget:this.handleSetDropTarget,onSortChange:A,onTilesPerRowChange:this.onTilesPerRowChange,path:$,sections:oe,selectAll:u,selectedFiles:H,selection:W,onSetFileUploaderPath:this.handleSetFileUploaderPath,tilesPerRow:Fe,totalNumItems:z,user:U,viewportTopOffset:ye,viewType:G,starredState:this.props.starredState,hrefForFile:this.props.hrefForFile,focusedFileIndex:S?I.indexOf(S):void 0,scrollContainer:Q,scrollPositionOffset:Me,registerSelectableTile:m,cutItems:de,isActive:pe,inlineActions:ge,preventSelectionOnDrag:this.props.preventSelectionOnDrag,responsive:P}))))))})),s.React$1.createElement(Ri,{scrollContainer:Q,path:$,viewType:G}),this.InternalFileDragHelper(),me&&s.React$1.createElement(ps,{items:this.props.unityItems,userId:U.id}))}}Ts.defaultProps={fileToId:e=>e.fq_path},Ts.displayName="FilesViewComponent";const ws=i.connect(((e,{id:t})=>Object.assign(Object.assign({},i.selectInstance(e,{instanceId:t})),{itemIds:i.selectItemIds(e,{instanceId:t}),sections:i.selectSections(e,{instanceId:t}),responsive:i.selectResponsive(e,{instanceId:t}),isCompactMode:i.selectIsCompactMode(e,{instanceId:t}),viewType:i.selectViewType(e,{instanceId:t}),preferredColumns:i.selectPreferredColumns(e,{instanceId:t}),cutItems:i.selectCutItems(e,{instanceId:t}),numVisibleColumns:i.selectNumVisibleColumns(e,{instanceId:t}),isListView:i.selectIsListView(e,{instanceId:t}),isActive:i.isActiveFilesView(e,t),unityItems:i.selectItemsForUnityListener(e,{instanceId:t})})),((e,{id:t})=>({openKeyboardShortcutsModal:()=>e(i.openKeyboardShortcutsModal({instanceId:t}))})))(Ts),_s=({children:e,props:t,instanceId:a})=>{const{items:n,path:l}=t,o=i.useSelector((e=>t=>i.selectViewType(t,{instanceId:e}))(a));return s.react.exports.createElement(St,{props:t},s.react.exports.createElement(L.ThumbStoreProvider,{shouldPrewarm:o!==i.ViewType.Grid,items:n,path:l},s.react.exports.createElement(L.FilesViewOverrideContext.Provider,{value:t.overrides||{}},e)))};_s.displayName="FilesViewContextProvider";const Cs={arePostTTIModulesLoaded:!0,context:!0,createNewFolderState:!0,items:!0,selection:!0,user:!0,responsive:!0,clipboard:!0,currentSort:!0,disabledMultiselect:!0,dropTargetHighlightMode:!0,enableUnity:!0,expBizFoldersEmptyStateAdmin:!0,expBizFoldersEmptyStateUser:!0,fileRename:!0,filteredContactName:!0,renderFilenameSubtitleAsLink:!0,hideViewFileButton:!0,highDensity:!0,isOverFreeQuota:!0,isSearchMode:!0,loadingState:!0,starredState:!0,teamFolders:!0,viewTypeScope:!0,viewTypes:!0,eligibleForFirstTaskSubtitle:!0,expVaultEnableViewOnlySharing:!0,isActionBarEnabled:!0,inlineActionBar:!0,expFlowsAutomatedFolderUI:!0,expManualTagging:"OFF",currentFolderInfo:!0,isRightClickEnabled:!0,selectedFilter:!0},Rs=(e,t,i)=>{t[i]=e[i]};let Fs=0;const vs=e=>{const{id:t,isActive:a=!0}=e,n=i.useDispatch(),{ownProps:l,upsertedProps:o}=(e=>{const t={},i={};for(const s of Object.keys(e))if(Cs.hasOwnProperty(s)){const t=s;void 0!==e[t]&&Rs(e,i,t)}else Rs(e,t,s);return{ownProps:t,upsertedProps:i}})(e),r=s.React$1.useMemo((()=>t||"files-view:"+Fs++),[t]),c=r!==t;return n(i.upsertInstance(r,o)),s.React$1.useEffect((()=>()=>{c&&n(i.deleteInstance(r))}),[c,n,r]),s.React$1.useEffect((()=>{a&&t&&n(i.markActiveInstance(t))}),[a,t,n]),s.React$1.createElement(_s,{props:e,instanceId:r},s.React$1.createElement(ws,Object.assign({},l,{id:r})))};vs.displayName="UpsertWrapper";const Is=i.connect()(vs),Ns=i.getStoreForFilesView(),Ds=e=>s.React$1.createElement(i.Provider,{store:Ns},s.React$1.createElement(Is,Object.assign({},e)));Ds.displayName="FilesViewController",t.FilesViewController=Ds,t.Sticky=Fe,t.StickyContainer=ve,t.getWidthOfElement=function(e){try{const t=window.getComputedStyle(e,null),i=e.clientWidth,s=parseInt(t.getPropertyValue("padding-left"),10);let a=parseInt(t.getPropertyValue("padding-right"),10);if(isNaN(i)||isNaN(s)||isNaN(a))throw new Error("failed to calculate width");const n=e.clientHeight<(e.hasChildNodes()?e.children[0].clientHeight:0)?0:15;return a=Math.max(16,a)+n,i-s-a}catch(e){return}},t.isInsideVault=function(e){const t=e.split("/");return("/"===e[0]?t[1]:t[0])===H.VAULT_NAME},t.localStorage={type:"local_storage",localStorageKey:"dbx_files_view_column_sizes"},t.noStorage=te,t.swapColumns=Y}));
//# sourceMappingURL=c_browse_element_width.js-vflr50_u1.map
