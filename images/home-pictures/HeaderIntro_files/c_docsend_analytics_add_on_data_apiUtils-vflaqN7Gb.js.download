define(["exports","./c_tslib","./c_docsend_src_utils","./e_ui_page_files_router"],(function(e,n,s,i){"use strict";const t="x-dropbox-request-id",o=e=>{const n=parseInt(e["x-server-response-time"],10),s=isNaN(n)?void 0:n;return{requestId:e[t],serverTimeMs:s}},a=e=>{var n,s;if(!e)return{};let i="";return e.headers&&e.headers&&t in e.headers&&(i=e.headers[t]),{error:null===(n=null==e?void 0:e.raw)||void 0===n?void 0:n.responseBody,requestId:i,statusCode:null===(s=null==e?void 0:e.raw)||void 0===s?void 0:s.status}};e.deleteLink=(e,t,r,d,_)=>n.__awaiter(void 0,void 0,void 0,(function*(){const n=s.getLinkIdFromLink(r);try{const{headers:s}=yield e.ns("docsend_addon").rpcWithResponseHeaders("link/delete_link",{file_id:t,link:r},{});return i.ProEventsLogger.log("docsend_analytics_add_on_delete_link_success",Object.assign(Object.assign({linkId:n,fileExt:d},o(s)),{entryPoint:_})),!0}catch(e){return i.ProEventsLogger.log("docsend_analytics_add_on_delete_link_failure",Object.assign(Object.assign({},a(e)),{linkId:n,fileExt:d,entryPoint:_})),!1}})),e.getAnalyticsForDocumentVersion=(e,t,r,d,_,c)=>n.__awaiter(void 0,void 0,void 0,(function*(){const n=s.getLinkIdFromLink(r);try{const{result:s,headers:a}=yield e.ns("docsend_addon").rpcWithResponseHeaders("analytics/get_analytics_for_document_version",{file_id:t,link:r,docsend_version:c},{});return i.ProEventsLogger.log("docsend_analytics_add_on_get_analytics_for_document_version_success",Object.assign({linkId:n,fileExt:d,documentVersion:c,pageViews:s.top_viewed_pages,entryPoint:_},o(a))),s}catch(e){i.ProEventsLogger.log("docsend_analytics_add_on_get_analytics_for_document_version_failure",Object.assign(Object.assign({},a(e)),{linkId:n,fileExt:d,documentVersion:c,entryPoint:_}))}})),e.getLink=(e,t,r,d,_)=>n.__awaiter(void 0,void 0,void 0,(function*(){try{const{result:n,headers:a}=yield e.ns("docsend_addon").rpcWithResponseHeaders("link/get_link",{file_id:t},_);return i.ProEventsLogger.log("docsend_analytics_add_on_get_link_success",Object.assign({fileExt:r,linkId:s.getLinkIdFromLink(n.link),fileHasNewerVersion:n.file_has_newer_version,fileHlcMicroseconds:n.file_hlc_unix_micros,entryPoint:d},o(a))),n}catch(e){i.ProEventsLogger.log("docsend_analytics_add_on_get_link_failure",Object.assign(Object.assign({},a(e)),{fileExt:r,entryPoint:d}))}})),e.getOrCreateLink=(e,t,r,d)=>n.__awaiter(void 0,void 0,void 0,(function*(){try{const{result:n,headers:a}=yield e.ns("docsend_addon").rpcWithResponseHeaders("link/get_or_create_link",{file_id:t},{});return i.ProEventsLogger.log("docsend_analytics_add_on_get_or_create_link_success",Object.assign({fileExt:r,linkId:s.getLinkIdFromLink(n.link),fileHasNewerVersion:n.file_has_newer_version,fileHlcMicroseconds:n.file_hlc_unix_micros,entryPoint:d},o(a))),n}catch(e){i.ProEventsLogger.log("docsend_analytics_add_on_get_or_create_link_failure",Object.assign(Object.assign({},a(e)),{fileExt:r,entryPoint:d}))}})),e.getPlanStatus=(e,s)=>n.__awaiter(void 0,void 0,void 0,(function*(){try{const{result:n,headers:t}=yield e.ns("docsend_addon").rpcWithResponseHeaders("account/get_plan_status",void 0,{});return i.ProEventsLogger.log("docsend_analytics_add_on_get_plan_status_success",Object.assign({hasActivePlan:n.has_active_plan,hasAddOnAccess:n.has_addon_access,daysRemaining:n.trial_days_left,provisionStatus:n.provision_status,accessDeniedReason:n.addon_access_denied_reason,entryPoint:s},o(t))),n}catch(e){return void i.ProEventsLogger.log("docsend_analytics_add_on_get_plan_status_failure",Object.assign(Object.assign({},a(e)),{entryPoint:s}))}})),e.getSummaryAnalytics=(e,t,r,d,_)=>n.__awaiter(void 0,void 0,void 0,(function*(){const n=s.getLinkIdFromLink(r);try{const{result:s,headers:a}=yield e.ns("docsend_addon").rpcWithResponseHeaders("analytics/get_summary_analytics",{file_id:t,link:r},{});return i.ProEventsLogger.log("docsend_analytics_add_on_get_summary_analytics_success",Object.assign({linkId:n,fileExt:d,numVisitors:s.num_visitors,numVisits:s.num_visits,numDownloads:s.num_downloads,avgViewTimeMs:s.average_view_time_ms,entryPoint:_},o(a))),s}catch(e){i.ProEventsLogger.log("docsend_analytics_add_on_get_summary_analytics_failure",Object.assign(Object.assign({},a(e)),{linkId:n,fileExt:d,entryPoint:_}))}})),e.getVisitAnalytics=(e,t,r,d,_=50,c,l,g)=>n.__awaiter(void 0,void 0,void 0,(function*(){var n;const u=s.getLinkIdFromLink(r);try{const{result:s,headers:a}=yield e.ns("docsend_addon").rpcWithResponseHeaders("analytics/get_visits_analytics",{file_id:t,link:r,cursor:g,page_size:_},{});return i.ProEventsLogger.log("docsend_analytics_add_on_get_visit_analytics_success",Object.assign({linkId:u,fileExt:d,pageSize:_,pageNumber:c,currCursor:g,nextCursor:s.cursor,pageCount:null===(n=s.visits)||void 0===n?void 0:n.length,totalCount:s.total_count,entryPoint:l},o(a))),s}catch(e){i.ProEventsLogger.log("docsend_analytics_add_on_get_visit_analytics_failure",Object.assign(Object.assign({},a(e)),{linkId:u,fileExt:d,pageSize:_,currCursor:g,pageNumber:c,entryPoint:l}))}})),e.provisionAccount=(e,s)=>n.__awaiter(void 0,void 0,void 0,(function*(){try{const{result:n,headers:t}=yield e.ns("docsend_addon").rpcWithResponseHeaders("account/provision_account",void 0,{});return"PROVISIONED"===n.provision_status?(i.ProEventsLogger.log("docsend_analytics_add_on_provision_account_success",Object.assign({provisionStatus:n.provision_status,entryPoint:s},o(t))),!0):(i.ProEventsLogger.log("docsend_analytics_add_on_provision_account_failure",Object.assign({provisionStatus:n.provision_status,entryPoint:s},o(t))),!1)}catch(e){i.ProEventsLogger.log("docsend_analytics_add_on_provision_account_failure",Object.assign(Object.assign({},a(e)),{entryPoint:s}))}return!1})),e.updateDocument=(e,t,r,d,_)=>n.__awaiter(void 0,void 0,void 0,(function*(){const n=s.getLinkIdFromLink(_);try{const{result:s,headers:a}=yield e.ns("docsend_addon").rpcWithResponseHeaders("link/update_document",{file_id:t},{});return i.ProEventsLogger.log("docsend_analytics_add_on_update_document_success",Object.assign({fileExt:r,fileHlcMicroseconds:s.file_hlc_unix_micros,linkId:n,entryPoint:d},o(a))),s}catch(e){i.ProEventsLogger.log("docsend_analytics_add_on_update_document_failure",Object.assign(Object.assign({},a(e)),{fileExt:r,linkId:n,entryPoint:d}))}}))}));
//# sourceMappingURL=c_docsend_analytics_add_on_data_apiUtils.js-vflIuL107.map
