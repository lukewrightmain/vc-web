define(["exports","./c_unity_check_file_cache","./c_unity_features","./e_ui_page_files_router","./e_edison","./c_tslib","./c_core_uri","./c_lodash-es_lodash","./c_apex-metrics_src_types","metaserver/static/js/modules/constants/files_spa","./e_core_exception","./c_core_exception_info","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/constants/request","./c_core_notify","./c_core_i18n","./c_src_sink_index","./c_core_browser_detection","metaserver/static/js/modules/core/langpack","metaserver/static/js/modules/constants/env","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/viewer","metaserver/static/js/modules/constants/auth","./c_api_v2_noauth_client","./c_browser_cookies","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/ajax_strings","./c_csrf","./c_core_xhr","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/webtiming","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/trademark","metaserver/static/js/modules/constants/campaigns_orchestration","metaserver/static/js/modules/constants/maestro_nav_strings","metaserver/static/js/modules/constants/search","metaserver/static/js/modules/constants/undo_strings","metaserver/static/js/modules/constants/contacts","metaserver/static/js/modules/constants/login_and_register","metaserver/static/js/modules/constants/unity"],(function(e,s,t,c,a,n,i,_,r,o,l,h,m,u,d,v,f,j,p,C,k,g,y,b,F,I,U,x,w,E,D,S,A,H,L,M,T,B,G,K){"use strict";const N=s.UnityCheckFileCache&&t.UnityFeatures.isUnitySupported()?new class{constructor(){this.BATCH_SIZE_LIMIT=100,this.CHECK_FILES_PADDING=50,this.check_file_callback=e=>s.UnityCheckFileCache.set_batch(e),this.browse_visible_change_callback=(e,s,c,a)=>{if(!e.length)return;const n=Math.max(0,c-this.CHECK_FILES_PADDING),i=Math.min(e.length-1,a+this.CHECK_FILES_PADDING),_=e.slice(n,+i+1||void 0),r=this._get_files_to_check(_);if(!r.length)return;this._remove_unneeded_items_from_cache(_);const o=[];for(;r.length;){const e=r.splice(0,this.BATCH_SIZE_LIMIT);o.push(t.UnityFeatures.check_file_batch(e,s,this.check_file_callback))}return o},this._get_files_to_check=e=>{const t=[];for(const c of e)c.isDeleted||!0===s.UnityCheckFileCache.is_cached_and_locally_available(c.ns_id,c.ns_path)||t.push(c);return t},this._remove_unneeded_items_from_cache=e=>{const c={};for(const a of e)if(!0===s.UnityCheckFileCache.is_cached_and_locally_available(a.ns_id,a.ns_path)){const e=s.UnityCheckFileCache.get(a.ns_id,a.ns_path);e&&(c[t.UnityFeatures.server_path(a.ns_id,a.ns_path)]=e)}return s.UnityCheckFileCache.clear(),s.UnityCheckFileCache.set_batch(c)}}}:void 0;e.unityBrowseInterface=N}));
//# sourceMappingURL=c_unity_browse_interface.js-vflTGPMhv.map
