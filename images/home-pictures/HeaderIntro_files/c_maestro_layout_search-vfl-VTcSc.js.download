define(["require","exports","./c_tslib","./e_ui_page_files_router","./e_edison","./c_spectrum_media_table_skeleton","./c_core_exception_info","./c_core_i18n","./c_spectrum_match","./c_spectrum_vertically_fixed","./e_core_exception"],(function(e,t,a,s,r,i,n,c,o,l,h){"use strict";const d=e=>{const[t,a]=r.react.exports.useState((e=>"undefined"!=typeof window&&window.matchMedia(e).matches)(e));return r.react.exports.useEffect((()=>{let t=!0;const s=window.matchMedia(e),r=()=>{t&&a(!!s.matches)};try{s.addEventListener("change",r)}catch(e){s.addListener(r)}return a(s.matches),()=>{t=!1;try{s.addEventListener("change",r)}catch(e){s.addListener(r)}}}),[e]),t},p="maestro--responsive",m="(min-width: 736px)",u="(min-width: 1025px)";class R extends r.React$1.Component{render(){const e=this.props,{responsive:t}=e,s=a.__rest(e,["responsive"]),i=t&&t.isResponsive?"div":l.VerticallyFixed;return r.React$1.createElement(i,s)}}R.displayName="VerticallyFixedWrapper";class S extends r.React$1.Component{renderSearchBar(){const{searchVariant:e}=this.props;if(this.props.user){if(this.props.overrideSearchBar)return this.props.overrideSearchBar;switch(e){case"minimal":return r.React$1.createElement(s.MinimalSearchInput,{user:this.props.user});case"full-page":return r.React$1.createElement(s.GlobalHeaderSearchInputPortalTarget,null);case void 0:case null:return null}}return null}render(){return this.renderSearchBar()}}S.defaultProps={searchVariant:"minimal",isSearchBarExpanded:!1,currentPath:"/"},S.displayName="TopMenuContainerWithoutCSS";const g=s.requireCssWithComponent(S,["/static/metaserver/static/css/pagelet-vflQZ-elc.css"]);s.injectInternalStyle("metaserver/static/js/maestro/layout/header_campaigns.module.out.css",(e=>"._above-maestro-content-campaign-slot-wrapper_elq3x_1{padding:var(--spacing__base_unit)}"));const v="_above-maestro-content-campaign-slot-wrapper_elq3x_1";class E extends r.React$1.Component{constructor(){super(...arguments),this.state={deferSearchRenderToGlobalHeader:s.shouldUseReactRouter()}}getRelevantSearchPropsForGlobalHeader(){return{searchVariant:this.props.searchVariant,overrideSearchBar:this.props.overrideSearchBar||this.state.deferSearchRenderToGlobalHeader?r.React$1.createElement(g,Object.assign({},this.props)):void 0,shouldLoadSearchInGH:this.state.deferSearchRenderToGlobalHeader}}componentDidMount(){s.shouldUseReactRouter()||(s.globalHeaderBufferedEventEmitter.on(s.SEARCH_REQUEST_PROPS,(()=>{this.setState({deferSearchRenderToGlobalHeader:!0})})),s.globalHeaderBufferedEventEmitter.emit(s.SEARCH_SET_PROPS,this.getRelevantSearchPropsForGlobalHeader()))}componentDidUpdate(e,t){(s.shouldUseReactRouter()||e.isSearching===this.props.isSearching&&e.isSearchBarExpanded===this.props.isSearchBarExpanded)&&t.deferSearchRenderToGlobalHeader===this.state.deferSearchRenderToGlobalHeader||s.globalHeaderBufferedEventEmitter.emit(s.SEARCH_SET_PROPS,this.getRelevantSearchPropsForGlobalHeader())}componentWillUnmount(){s.shouldUseReactRouter()||s.globalHeaderBufferedEventEmitter.removeListener(s.SEARCH_REQUEST_PROPS)}render(){const e=this.props,{chromeClass:t,useMaestroPortal:i}=e,n=a.__rest(e,["chromeClass","useMaestroPortal"]);return i?r.React$1.createElement(r.React$1.Fragment,null,r.React$1.createElement(s.MaestroPortal,{element:s.MaestroPortalElement.TITLE,chromeClass:t},r.React$1.createElement(s.CampaignSlot,{slotId:"above_maestro_content",wrapperClassName:v}),r.React$1.createElement(_,{className:this.props.titleClass},n.title))):r.React$1.createElement("header",{className:"maestro-header page-header__shadow"},r.React$1.createElement(R,{className:"page-header",responsive:this.props.responsive},r.React$1.createElement(_,{className:this.props.titleClass},n.title)))}}E.defaultProps={isSearchBarExpanded:!1},E.displayName="PageletMaestroHeaderWithoutCSS";const _=({className:e,children:t})=>r.React$1.createElement("div",{className:s.classnames("page-header__title",e)},r.React$1.createElement(s.UserEducationEffect,{containerName:"PageletMaestroHeader",name:"Title",useSpan:!1},t));_.displayName="MaestroHeaderTitleWithUE";const b=s.requireCssWithComponent(E,["/static/metaserver/static/css/dig-components/index.web-vflvPodS4.css","/static/metaserver/static/css/maestro_layout-vflBbM3bK.css"]);class M extends r.React$1.Component{constructor(e){super(e),this.state={}}render(){return r.React$1.createElement(R,{responsive:this.props.responsive,className:"maestro-secondary-sidebar"},this.props.children)}}M.displayName="MaestroSecondarySidebar";const f=({actionSidebarRegion:e,responsive:t,sidebarClass:a,useRightRail:i})=>r.React$1.createElement(r.React$1.Fragment,null,e&&(i?r.React$1.createElement("div",{className:"maestro-secondary-sidebar-v2"},"function"==typeof e?e(t):e):r.React$1.createElement("div",{className:s.classnames(["maestro-secondary-sidebar__shadow",a]),role:"complementary","aria-label":"sidebar"},r.React$1.createElement(M,{responsive:t},"function"==typeof e?e(t):e))));f.displayName="SidebarRegion";class C extends r.React$1.PureComponent{constructor(e){super(e),this.isPageResponsive=()=>!(!document||!document.documentElement)&&document.documentElement.classList.contains(p),this.handleSetup=()=>{this.setState({setupComplete:!0})},this.handleMatchMedium=()=>{!1===this.state.responsive.isMatchedMedium&&this.setState((e=>({responsive:Object.assign(Object.assign({},e.responsive),{isMatchedMedium:!0})})))},this.handleUnmatchMedium=()=>{!0===this.state.responsive.isMatchedMedium&&this.setState((e=>({responsive:Object.assign(Object.assign({},e.responsive),{isMatchedMedium:!1})})))},this.handleMatchLarge=()=>{!1===this.state.responsive.isMatchedLarge&&this.setState((e=>({responsive:Object.assign(Object.assign({},e.responsive),{isMatchedLarge:!0})})))},this.handleUnmatchLarge=()=>{!0===this.state.responsive.isMatchedLarge&&this.setState((e=>({responsive:Object.assign(Object.assign({},e.responsive),{isMatchedLarge:!1})})))};const t=this.isPageResponsive();this.state={responsive:{isResponsive:t,isMatchedMedium:!t,isMatchedLarge:!t},setupComplete:!t}}render(){const{user:e,titleRegion:t,titleClass:a,chromeClass:i,embeddedAppRegion:n,searchBarProps:c,useMaestroPortal:l,actionSidebarRegion:h,useRightRail:d,useModernSearchDropdown:p,sidebarClass:R}=this.props,{setupComplete:S,responsive:g}=this.state,v=l,E=!l;return r.React$1.createElement("div",{className:s.classnames(["maestro-chrome",i])},g.isResponsive&&r.React$1.createElement(o.Match,{media:u,onSetup:this.handleSetup,onMatch:this.handleMatchLarge,onUnmatch:this.handleUnmatchLarge}),g.isResponsive&&r.React$1.createElement(o.Match,{media:m,onSetup:this.handleSetup,onMatch:this.handleMatchMedium,onUnmatch:this.handleUnmatchMedium}),S&&(E||v)&&r.React$1.createElement(b,Object.assign({user:e,title:"function"==typeof t?t(g):t,titleClass:a,chromeClass:i,responsive:g},c||{},{useMaestroPortal:l,useModernSearchDropdown:p})),S&&v&&r.React$1.createElement(s.MaestroPortal,{element:s.MaestroPortalElement.SIDEBAR,chromeClass:s.classnames(["maestro-sidebar-chrome",i])},r.React$1.createElement(f,{actionSidebarRegion:h,useRightRail:d,responsive:g,sidebarClass:R})),S&&r.React$1.createElement(s.MaestroPortal,{element:s.MaestroPortalElement.CONTENT,chromeClass:s.classnames(["maestro-content-chrome",i]),scrollHandler:this.props.scrollHandler},r.React$1.createElement("div",{className:"maestro-app"},r.React$1.createElement("div",{className:"maestro-app-content"},"function"==typeof n?n(g):n),!v&&r.React$1.createElement(f,{actionSidebarRegion:h,useRightRail:d,responsive:g}))))}}C.displayName="MaestroChrome";const $={},P=s.Loadable({loader:()=>a.__awaiter(void 0,void 0,void 0,(function*(){const{SearchRightRail:t}=yield new Promise((function(t,a){e(["./c_single_page_search_right_rail"],t,a)}));return t}))}),y=e=>r.React$1.createElement(P,Object.assign({},e));y.displayName="AsyncSearchRightRail";const x=s.Loadable({loader:()=>a.__awaiter(void 0,void 0,void 0,(function*(){const[{SearchView:t}]=yield Promise.all([new Promise((function(t,a){e(["./c_search_search_results_view"],t,a)}))]);return t})),loading:({inputBox:e})=>e.current&&e.current.value?r.React$1.createElement(i.MediaTableSkeleton,{numRows:15}):null,loadError:()=>r.React$1.createElement("div",null,c.intl.formatMessage({id:"V2lejD",defaultMessage:"Something went wrong. Please reload the page."}))});class N extends r.React$1.PureComponent{constructor(e){super(e),this.handleSearchExit=()=>{this.setState({isSearching:!1})},this.handleSearchEnter=()=>{this.setState({isSearching:!0})},this.renderSearchSidebar=e=>r.React$1.createElement(y,{responsive:e}),this.renderEmbeddedApp=e=>[this.inSearchMode?r.React$1.createElement(x,{key:"search",user:this.props.user,responsive:e,inputBox:this.state.inputBox}):null,r.React$1.createElement("div",{style:{display:this.inSearchMode?"none":void 0},key:"app"},"function"==typeof this.props.embeddedAppRegion?this.props.embeddedAppRegion(e,!this.inSearchMode):this.props.embeddedAppRegion)],this.state={isSearching:e.searchBarProps&&e.searchBarProps.isSearching||!1,inputBox:r.React$1.createRef()}}get inSearchMode(){return this.props.searchBarProps&&"full-page"===this.props.searchBarProps.searchVariant&&this.props.user&&this.state.isSearching}render(){const{actionSidebarRegion:e,searchBarProps:t,titleRegion:a,useRightRailOutsideSearch:i,wideSecondarySidebar:c,user:o}=this.props,l=this.inSearchMode||i,d=s.classnames({"maestro-chrome--search":!0,"maestro-chrome--search-active":this.inSearchMode,"exp-details-pane-variants":this.inSearchMode&&c,"maestro-chrome--right-rail":l},this.props.chromeClass),p=null==t?void 0:t.searchVariant;var m,u;"full-page"!==p&&(m="SearchChromeNotFullPageVariant",u=["SearchChrome called without full-page search variant",{severity:n.SEVERITY.NONCRITICAL,tags:["unified-search"],exc_extra:{search_variant:p}}],$[m]||($[m]=!0,h.reportStack(...u)));const R={inputBoxRef:this.state.inputBox,isActive:this.inSearchMode,onSearchEnter:this.handleSearchEnter,onSearchExit:this.handleSearchExit},S=r.React$1.createElement(C,Object.assign({},this.props,{actionSidebarRegion:this.inSearchMode?this.renderSearchSidebar:e,titleRegion:a,searchBarProps:Object.assign(Object.assign(Object.assign({},t||{}),{isSearching:this.state.isSearching}),R),useRightRail:l,embeddedAppRegion:this.renderEmbeddedApp,titleClass:"page-header__title--search",chromeClass:d}));return o?r.React$1.createElement(s.SearchProvider,{userId:o.id,searchInputProps:R},S):S}}N.displayName="SearchChrome",t.AsyncSearchRightRail=y,t.MaestroChrome=C,t.MaestroHeaderTitle=({children:e})=>r.React$1.createElement(s.Title,{className:"page-header__heading",tagName:"h1"},e),t.SearchChrome=N,t.useResponsiveProps=()=>{const[e,t]=r.React$1.useState(!(!document||!document.documentElement)&&document.documentElement.classList.contains(p));return{isResponsive:e,isMatchedMedium:d(m),isMatchedLarge:d(u)}}}));
//# sourceMappingURL=c_maestro_layout_search.js-vfl7DPnrF.map
