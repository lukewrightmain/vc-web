define(["exports","./c_tslib","./c_downloads","./c_share_download_ui_api","./e_ui_page_files_router","./c_core_i18n","./c_integrations_data_selectors"],(function(e,t,n,i,o,s,a){"use strict";function r(e,t,n){e&&e.event(t,n)}function d(e){return e.link_state[".tag"].indexOf("_linked")>=0}var _;e.OpenButtonAction=void 0,(_=e.OpenButtonAction||(e.OpenButtonAction={}))[_.DOWNLOAD=0]="DOWNLOAD",_[_.UNITY_FILE=1]="UNITY_FILE",_[_.UNITY_FOLDER=2]="UNITY_FOLDER",_[_.OPEN_WITH=3]="OPEN_WITH",_[_.APP_ACTION=5]="APP_ACTION",_[_.PREPARE_FOR_SIGNATURE=6]="PREPARE_FOR_SIGNATURE",_[_.SHARE_TO_SLACK=7]="SHARE_TO_SLACK",_[_.PRESENT_IN_ZOOM=8]="PRESENT_IN_ZOOM",_[_.SHARE_TO_TRELLO=9]="SHARE_TO_TRELLO",_[_.INVITE_VIA_EMAIL=10]="INVITE_VIA_EMAIL",_[_.OPEN_WITH_CLOUD_DOC=11]="OPEN_WITH_CLOUD_DOC",_[_.OPEN_MORE_APPS=12]="OPEN_MORE_APPS",_[_.OPEN_ADD_APPS=13]="OPEN_ADD_APPS",_[_.DECOMPRESS_FILE=14]="DECOMPRESS_FILE",_[_.PREVIEW_FILE=15]="PREVIEW_FILE",_[_.TRANSFER=16]="TRANSFER",_[_.OPEN_IN_DESKTOP=17]="OPEN_IN_DESKTOP",_[_.GO_TO_FOLDER=18]="GO_TO_FOLDER",_[_.OPEN_IN_REPLAY=19]="OPEN_IN_REPLAY",_[_.OPEN_IN_NEW_TAB=20]="OPEN_IN_NEW_TAB",_[_.CONVERT_AND_SHARE=24]="CONVERT_AND_SHARE",_[_.SELL_WITH_SHOP=25]="SELL_WITH_SHOP",_[_.SHARE_WITH_COLLECTION=26]="SHARE_WITH_COLLECTION",_[_.CREATE_CLIENT_PORTAL=21]="CREATE_CLIENT_PORTAL",_[_.EDIT_CLIENT_PORTAL=22]="EDIT_CLIENT_PORTAL",_[_.SHARE_WITH_ANALYTICS=23]="SHARE_WITH_ANALYTICS",_[_.PUBLISH_TO_SOCIAL=24]="PUBLISH_TO_SOCIAL";const l={0:{displayName:s.intl.formatMessage({id:"wYkgel",defaultMessage:"DEFAULT"})},1:{displayName:s.intl.formatMessage({id:"EMXHTJ",defaultMessage:"Send for signature"}),developerDescription:s.intl.formatMessage({id:"EMXHTJ",defaultMessage:"Send for signature"})},2:{displayName:s.intl.formatMessage({id:"aIQiHy",defaultMessage:"PDF Editing"}),developerDescription:s.intl.formatMessage({id:"fG5ZbA",defaultMessage:"PDF editing"})},3:{displayName:s.intl.formatMessage({id:"e6EJBF",defaultMessage:"View or Edit"}),developerDescription:s.intl.formatMessage({id:"p+tBI0",defaultMessage:"View or edit"})},4:{displayName:s.intl.formatMessage({id:"gN/zWT",defaultMessage:"Image Editing"}),developerDescription:s.intl.formatMessage({id:"KQT2xh",defaultMessage:"Image editing"})},5:{displayName:s.intl.formatMessage({id:"miE3lp",defaultMessage:"Video comment"}),developerDescription:s.intl.formatMessage({id:"miE3lp",defaultMessage:"Video comment"})},6:{displayName:s.intl.formatMessage({id:"Mcwc+5",defaultMessage:"Send fax"}),developerDescription:s.intl.formatMessage({id:"Mcwc+5",defaultMessage:"Send fax"})},8:{displayName:s.intl.formatMessage({id:"UwFkjc",defaultMessage:"Edit"}),developerDescription:s.intl.formatMessage({id:"RBrgq4",defaultMessage:"Video Editing"})},9:{displayName:s.intl.formatMessage({id:"Ufb68N",defaultMessage:"Send with"}),developerDescription:s.intl.formatMessage({id:"tBDUcB",defaultMessage:"Send Files"})},10:{displayName:s.intl.formatMessage({id:"sDGta5",defaultMessage:"Cloud Editors"}),developerDescription:s.intl.formatMessage({id:"sDGta5",defaultMessage:"Cloud Editors"})},11:{displayName:s.intl.formatMessage({id:"gffk/L",defaultMessage:"Send to notary"}),developerDescription:s.intl.formatMessage({id:"O/A0V6",defaultMessage:"Notarize"})},12:{displayName:s.intl.formatMessage({id:"oNuOaL",defaultMessage:"Expense"}),developerDescription:s.intl.formatMessage({id:"oNuOaL",defaultMessage:"Expense"})},13:{displayName:s.intl.formatMessage({id:"VlZABW",defaultMessage:"Publish"}),developerDescription:s.intl.formatMessage({id:"itZX4g",defaultMessage:"Publish Video"})},14:{displayName:s.intl.formatMessage({id:"E0v6mC",defaultMessage:"Share with"}),developerDescription:s.intl.formatMessage({id:"uukIVm",defaultMessage:"Share a file"})}};var c;!function(e){function t(e){return l[e]||null}e.DEFAULT=0,e.ESIGNATURE=1,e.PDF_EDITING=2,e.VIEW_OR_EDIT=3,e.IMAGE_EDITING=4,e.VIDEO_COMMENT=5,e.SEND_FAX=6,e.OPEN_WITH_CLOUD_DOC=7,e.VIDEO_EDITING=8,e.SEND_WITH=9,e.CLOUD_EDITORS=10,e.SEND_TO_NOTARY=11,e.EXPENSE=12,e.PUBLISH=13,e.SHARE_WITH=14,e.getDisplayName=function(e){const n=t(e);return n&&n.displayName},e.getDeveloperDescription=function(e){const n=t(e);return n&&n.developerDescription||null}}(c||(c={}));const p="fp_app_id:dropbox_transfer",u="fp_app_id:slack_dropbox",E="fp_app_id:trello",g="fp_app_id:zoom";var f=Object.freeze({__proto__:null,TRANSFER_FP_APP_ID:p,SLACK_FP_APP_ID:u,TRELLO_FP_APP_ID:E,ZOOM_FP_APP_ID:g});function O(e,t){if(e.priority&&t.priority){const n=t.priority-e.priority;return 0!==n?n:e.description<t.description?-1:e.description>t.description?1:0}return e.priority?-1:t.priority?1:e.description<t.description?-1:e.description>t.description?1:0}function A(e){return function(e){return void 0!==e.ext}(e)?e.ext:function(e){return void 0!==e.fq_path}(e)?"."+o.file_extension(o.filename(e.fq_path)):function(e){return void 0!==e.filename}(e)?"."+o.file_extension(e.filename):void 0}function S(e){return!!e.is_in_vault_folder}const I=e=>o.getStateAtNamespace(e,o.EXTENSIONS_NAMESPACE_KEY)||o.defaultExtensionsState,N=e=>I(e).featureFlags,T=e=>I(e).docsendAdvancedSharingHasOpenedSharingSettings,D=e=>I(e).docsendAdvancedSharingHasShared,P=e=>I(e).docsendAdvancedSharingHasSeenShareModal,m=e=>I(e).docsendAdvancedSharingHasConfirmedSplitShareMenu,M=e=>{const t=a.getListServicesInfo(e).latestListServicesResult;return t&&o.convertToSharingServiceInfo(t)},L=e=>I(e).cloudDocsInfo,h=e=>I(e).actions,R=e=>I(e).bylines,v=e=>I(e).categoryInfos;function F(e,t){return!(e.length>1&&!t.multiselect_enabled)&&e.every((e=>function(e,t){return void 0===t.filters||t.filters.every((t=>"matcher_any"===t[".tag"]&&!!t.matcher_any.some((t=>{if("extension"===t[".tag"]){const n=A(e);return t.extension===n}return"max_size_bytes"===t[".tag"]?e.bytes<=t.max_size_bytes:"is_file"===t[".tag"]?e.is_dir!==t.is_file:"is_cloud_doc"!==t[".tag"]||function(e){return!!e.is_cloud_doc}(e)===t.is_cloud_doc}))))}(e,t)))}function y(e){var t;const n=e.is_dir,i=S(e),o=null===(t=e.per_node_metadata)||void 0===t?void 0:t.link_node;return!(n||i||o)}function H(e){const t=e.per_node_metadata;return!(S(e)||(null==t?void 0:t.link_node)||(null==t?void 0:t.suppress_ns_partition)||(null==t?void 0:t.suppress_shared_link))}function C(e,t){return function(e,t){return e.every(y)?t.filter((t=>F(e,t))):[]}(t,h(e))}function W(e,t){return t.every(H)?C(e,t).filter((e=>w(e)&&![u,g,E].includes(e.app_id))):[]}function B(e,t){return C(e,[t]).filter((e=>!w(e)))}function x(e,t,n){return W(e,t).filter((e=>e.app_id!==n))}function w(e){return"share_menu"===e.menu_alignment[".tag"]}var G=Object.freeze({__proto__:null,getExtensionsState:I,getFeatureFlags:N,getDocsendAdvancedSharingHasOpenedSharingSettings:T,getDocsendAdvancedSharingHasShared:D,getDocsendAdvancedSharingHasSeenShareModal:P,getDocsendAdvancedSharingHasConfirmedSplitShareMenu:m,getSharingServiceInfoAdapter:M,getCloudDocInfo:L,getActions:h,getBylines:R,getCategoryInfos:v,getActionsForFiles:C,getShareActionsForFiles:W,getOpenActionsForFile:B,getNonHellosignActionsForFiles:x,isShareAction:w});e.TRANSFER_FP_APP_ID=p,e.actionCompareFn=O,e.cloudEditorNameToParams=function(e){return"gdoc"===e?o.GoogleFileTypes.GOOGLE_DSS_DOC:"gsheet"===e?o.GoogleFileTypes.GOOGLE_DSS_SHEET:"gslides"===e?o.GoogleFileTypes.GOOGLE_DSS_SLIDES:"word"===e?o.MicrosoftEditors.WORD:"excel"===e?o.MicrosoftEditors.EXCEL:"powerpoint"===e?o.MicrosoftEditors.POWERPOINT:"preview"},e.constants_esnext=f,e.downloadSingleFile=({href:e,source:s,isFswm:a=!1},{onAttempt:r,onSuccess:d,onError:_}={})=>t.__awaiter(void 0,void 0,void 0,(function*(){null==r||r();const t=a?yield i.fetchDownloadUrl(e,void 0,o.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE):e;n.get({url:t,source:`${s}_direct`,error:_}),null==d||d()})),e.downloadSingleFileAsZip=({fqPath:e,rootNsId:i,source:s,blockHash:a,user:r},{onAttempt:d,onSuccess:_}={})=>t.__awaiter(void 0,void 0,void 0,(function*(){null==d||d(),n.get_zip({fq_paths:[e],subject_uid:r.id,block_hash:a,parent_path:o.parent_dir(e),source:s,root_ns_id:i}),null==_||_()})),e.getAppActionExtras=function(e){return{action_id:e.id,encoded_app_id:e.app_id,action_type:d(e)?"select_action":"select_connect"}},e.getBylines=R,e.getCategoryInfos=v,e.getCloudDocInfo=L,e.getDocsendAdvancedSharingHasConfirmedSplitShareMenu=m,e.getDocsendAdvancedSharingHasOpenedSharingSettings=T,e.getDocsendAdvancedSharingHasSeenShareModal=P,e.getDocsendAdvancedSharingHasShared=D,e.getFeatureFlags=N,e.getFileExt=A,e.getNonHellosignActionsForFiles=x,e.getOpenActionsForFile=B,e.getOpenOptionsWithLogging=function(e,t){return e.map((e=>Object.assign(Object.assign({},e),{handler:()=>{e.handler(),r(t,"select_legacy_action",{type:e.type})}})))},e.getShareActionsForFiles=W,e.getSharingServiceInfoAdapter=M,e.handleShowByline=function(e,t){return()=>{r(t,"show_byline",{extension_id:e})}},e.isLinked=d,e.isShareAction=w,e.isWopiAction=function(e){return["fp_action_id:word_online","fp_action_id:excel_online","fp_action_id:powerpoint_online"].indexOf(e.id)>=0},e.logEvent=r,e.partitionActions=function(e,t=0){const n=[],i=[],o=[],s=[],a=[];return e.sort(O).forEach((e=>{e.category===c.CLOUD_EDITORS?n.push(e):e.app_id===p?i.push(e):d(e)||function(e){return"oauth_prelinked"===e.link_state[".tag"]}(e)?o.push(e):void 0!==e.priority&&e.priority>0&&s.length<t?s.push(e):a.push(e)})),{cloudEditors:n,transferActions:i,installedActions:o,promotedActions:s,unpromotedActions:a}},e.partitionActionsByLinkStatus=function(e){const t=[],n=[];return e.map((e=>{e.app_id&&(d(e)?t.push(e.app_id):n.push(e.app_id))})),{connected_apps:t,unconnected_apps:n}},e.partitionOptions=function(t){const n=[],i=[];let o,s,a,r,d,_;return t.forEach((t=>{const{type:l}=t;l===e.OpenButtonAction.UNITY_FILE||l===e.OpenButtonAction.UNITY_FOLDER?n.push(t):l===e.OpenButtonAction.OPEN_WITH||l===e.OpenButtonAction.OPEN_WITH_CLOUD_DOC?i.push(t):l===e.OpenButtonAction.DOWNLOAD?o=t:l===e.OpenButtonAction.PREVIEW_FILE?s=t:l===e.OpenButtonAction.OPEN_IN_REPLAY?a=t:l===e.OpenButtonAction.OPEN_IN_DESKTOP?r=t:l===e.OpenButtonAction.GO_TO_FOLDER?d=t:l===e.OpenButtonAction.OPEN_IN_NEW_TAB&&(_=t)})),{unityOptions:n,cloudEditorOptions:i,downloadOption:o,previewOption:s,openInReplayOption:a,openInDesktopOption:r,openInNewTabOption:_,goToFolderOption:d}},e.selectors_esnext=G}));
//# sourceMappingURL=c_extensions_data_selectors.js-vfl5gRSB5.map
