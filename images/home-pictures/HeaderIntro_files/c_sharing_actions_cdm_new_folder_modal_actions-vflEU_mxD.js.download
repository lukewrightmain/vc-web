define(["exports","./c_tslib","./e_ui_page_files_router","./c_sharing_ui_util","./c_deprecated_ajax_ajax_form_extract_errors","./c_api_v2_noauth_client","./c_core_i18n"],(function(e,o,n,t,a,s,r){"use strict";e.createTSDPlus1NsfFolder=function({user:e,pathName:i,folderName:l,autoTeamGroupAccessLevel:c,autoTeamGroupId:d,showFileSystemWarningsModal:u,onPending:_,onComplete:m,onCancel:h,shouldLaunchAutomationModal:f}){const A=e.id,C=new n.FolderShareApiClient({userId:A,isNonUserRelativeContext:!1}),g=t.getNewFolderPathFromContentName(l,i);_(),new a.SharingApi(e).validate_new_sf_path(l,g,(()=>{!function({userId:e,fqPath:a,autoTeamGroupAccessLevel:i,folderApiClient:l,autoTeamGroupId:c,showFileSystemWarningsModal:d,onComplete:u,onCancel:_}){const m=i===n.ACCESS_LEVEL.READER;(function(e){var{folderApiClient:n,showFileSystemWarningsModal:t,onCancel:a}=e,s=o.__rest(e,["folderApiClient","showFileSystemWarningsModal","onCancel"]);return t?n.shareWithFsws(Object.assign(Object.assign({},s),{folderPolicy:null})).then((({metadata:e,fsws:o})=>o?new Promise(((e,i)=>{t({fsws:o,onFinalAccept:()=>{n.share(Object.assign(Object.assign({},s),{folderPolicy:null})).then(e,i)},confirmText:r.intl.formatMessage({id:"5Z9j+l",defaultMessage:"Create folder"}),onAbortAction:a})})):Promise.resolve(e))):n.shareWithoutFsws(Object.assign(Object.assign({},s),{folderPolicy:null})).then((({metadata:e})=>Promise.resolve(e)))})({folderApiClient:l,showFileSystemWarningsModal:d,fqPath:a,confidential:m,onCancel:_}).then((function(o){const t=o.shared_folder_id;return m?(n.WebUserActionLog.log(e,n.WebUserActionLogEvent.CONF_BY_CREATE_CONFIDENTIAL_FOLDER,{ns_id:t,who_has_access:n.WebUserActionLogExtraValue.EVERYONE_GROUP_VIEW_ACCESS,location:n.WebUserActionLogExtraValue.BROWSE}),l.addMembers({contentId:t,members:[new s.UnionScalar("dropbox_id",c)],accessLevel:n.ACCESS_LEVEL.READER})):Promise.resolve()})).then(u).catch(s.catchApiError((e=>{const o=e&&e.message;_(t.convertIfHTML(o))})))}({userId:A,fqPath:g,autoTeamGroupAccessLevel:c,folderApiClient:C,autoTeamGroupId:d,showFileSystemWarningsModal:u,onComplete:()=>{m({user:e,folderName:l,fqPath:g,shouldLaunchAutomationModal:f})},onCancel:h})}),(e=>{const o=a.extractErrors(e.responseText);h(o.folder_name&&o.folder_name.message_text)}))}}));
//# sourceMappingURL=c_sharing_actions_cdm_new_folder_modal_actions.js-vflgxwGRN.map
