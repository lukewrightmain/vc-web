define(["exports","./c_tslib","./e_ui_page_files_router","./c_flows_lib_api","./e_core_exception","./c_core_exception_info","./e_edison","./c_core_uri","./c_lodash-es_lodash","./c_apex-metrics_src_types","metaserver/static/js/modules/constants/files_spa","./c_core_notify","./c_core_i18n","./c_src_sink_index","./c_core_browser_detection","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/core/langpack","metaserver/static/js/modules/constants/env","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/viewer","metaserver/static/js/modules/constants/auth","./c_api_v2_noauth_client","metaserver/static/js/modules/constants/request","./c_browser_cookies","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/ajax_strings","./c_csrf","./c_core_xhr","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/webtiming","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/trademark","metaserver/static/js/modules/constants/campaigns_orchestration","metaserver/static/js/modules/constants/maestro_nav_strings","metaserver/static/js/modules/constants/search","metaserver/static/js/modules/constants/undo_strings","metaserver/static/js/modules/constants/contacts","metaserver/static/js/modules/constants/login_and_register","./c_flows_logging_flows_loggers"],(function(s,e,t,o,n,a,c,r,i,l,_,u,d,m,v,p,j,f,g,b,w,h,y,k,x,C,B,F,O,S,q,I,T,E,N,R,A,D,L){"use strict";s.FlowsBoltClient=void 0,function(s){let c=null;const r={};let i=0;const l=()=>{c&&(c.unsubscribe(),c=null)},_=()=>e.__awaiter(this,void 0,void 0,(function*(){if(c)return;const s=yield o.getBoltData();if(!((null==s?void 0:s.app_id)&&s.unique_id&&s.revision&&s.token))return void n.reportStack("Flows bolt subscription failed",{severity:a.SEVERITY.NONCRITICAL});const e=new t.SignedChannelState(s.app_id,s.unique_id,s.revision,s.token);c=new t.ThunderClient([e],(s=>{const e=s.map((s=>s.payloads)).reduce(((s,e)=>s.concat(e)),[]).map((s=>s.payload));for(const s of Object.values(r))s(e)}),(()=>{l(),_()})),c.start()}));s.subscribe=function(s){const e="flows-subscription-"+i++;return r[e]=s,1===Object.keys(r).length&&_(),e},s.unsubscribe=function(s){delete r[s],0===Object.keys(r).length&&l()}}(s.FlowsBoltClient||(s.FlowsBoltClient={})),s.isCompleteFlowsBoltPayload=s=>!!((null==s?void 0:s.revkey)&&s.action_type&&s.status)}));
//# sourceMappingURL=c_flows_utils_bolt.js-vflJjDqA4.map
