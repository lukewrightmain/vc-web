define(["exports","./e_ui_page_files_router","./e_edison","./c_ui_overlay","./c_lodash-es_lodash"],(function(t,o,i,e,s){"use strict";const r={[e.StickyPosition.TOP_LEFT]:"top-left",[e.StickyPosition.TOP]:"top",[e.StickyPosition.TOP_RIGHT]:"top-right",[e.StickyPosition.LEFT_TOP]:"left-top",[e.StickyPosition.LEFT]:"left",[e.StickyPosition.LEFT_BOTTOM]:"left-bottom",[e.StickyPosition.RIGHT_TOP]:"right-top",[e.StickyPosition.RIGHT]:"right",[e.StickyPosition.RIGHT_BOTTOM]:"right-bottom",[e.StickyPosition.BOTTOM_LEFT]:"bottom-left",[e.StickyPosition.BOTTOM]:"bottom",[e.StickyPosition.BOTTOM_RIGHT]:"bottom-right",[e.StickyPosition.TOP_ALIGN_LEFT]:"top-align-left",[e.StickyPosition.TOP_ALIGN_RIGHT]:"top-align-right",[e.StickyPosition.LEFT_ALIGN_TOP]:"left-align-top",[e.StickyPosition.LEFT_ALIGN_BOTTOM]:"left-align-bottom",[e.StickyPosition.RIGHT_ALIGN_TOP]:"right-align-top",[e.StickyPosition.RIGHT_ALIGN_BOTTOM]:"right-align-bottom",[e.StickyPosition.BOTTOM_ALIGN_LEFT]:"bottom-align-left",[e.StickyPosition.BOTTOM_ALIGN_RIGHT]:"bottom-align-right"};class n extends i.React$1.Component{constructor(){super(...arguments),this._getArrowStyleFromPosition=()=>r[this.props.position],this._adjustArrowPosition=(t=!1)=>{if(!this.props.shouldShowArrow)return;const o=i.reactDom.exports.findDOMNode(this.refs.bubbleArrowContainer);if(o){switch(this.props.position){case e.StickyPosition.TOP_ALIGN_LEFT:case e.StickyPosition.BOTTOM_ALIGN_LEFT:o.style.left=this.props.targetNode.offsetWidth/2+"px";break;case e.StickyPosition.TOP_ALIGN_RIGHT:case e.StickyPosition.BOTTOM_ALIGN_RIGHT:o.style.right=this.props.targetNode.offsetWidth/2+"px";break;case e.StickyPosition.LEFT_ALIGN_TOP:case e.StickyPosition.RIGHT_ALIGN_TOP:o.style.top=this.props.targetNode.offsetHeight/2+"px";break;case e.StickyPosition.LEFT_ALIGN_BOTTOM:case e.StickyPosition.RIGHT_ALIGN_BOTTOM:o.style.bottom=this.props.targetNode.offsetHeight/2+"px"}if((!t||t&&this.props.shouldArrowDecrement)&&(this.props.verticalArrowOffset||this.props.horizontalArrowOffset)){const t=getComputedStyle(o);this._getArrowStyleFromPosition().match(/^(top|bottom)/)&&(o.style.left=String(parseFloat(t.left)-this.props.horizontalArrowOffset)+"px"),this._getArrowStyleFromPosition().match(/^(left|right)/)&&(o.style.top=String(parseFloat(t.top)-this.props.verticalArrowOffset)+"px")}}}}componentDidMount(){return this._adjustArrowPosition()}componentDidUpdate(){return this._adjustArrowPosition(!0)}render(){return i.React$1.createElement("div",{className:this.props.isMaestroDesign?"maestro":""},i.React$1.createElement("div",{ref:"dropdown",className:o.classnames("bubble-dropdown-v2",`bubble-dropdown-v2--${this._getArrowStyleFromPosition()}`,this.props.className),"aria-labelledby":this.props.targetNode.id},this.props.children,this.props.shouldShowArrow?i.React$1.createElement("div",{ref:"bubbleArrowContainer",className:"bubble-arrow-container"},i.React$1.createElement("div",{className:"bubble-arrow-border"}),i.React$1.createElement("div",{className:"bubble-arrow"})):null))}}n.displayName="BubbleDropdownContents",n.propTypes={targetNode:o.PropTypes.instanceOf(HTMLElement).isRequired,position:o.PropTypes.oneOf([e.StickyPosition.TOP_LEFT,e.StickyPosition.TOP,e.StickyPosition.TOP_RIGHT,e.StickyPosition.LEFT_TOP,e.StickyPosition.LEFT,e.StickyPosition.LEFT_BOTTOM,e.StickyPosition.RIGHT_TOP,e.StickyPosition.RIGHT,e.StickyPosition.RIGHT_BOTTOM,e.StickyPosition.BOTTOM_LEFT,e.StickyPosition.BOTTOM,e.StickyPosition.BOTTOM_RIGHT,e.StickyPosition.TOP_ALIGN_LEFT,e.StickyPosition.TOP_ALIGN_RIGHT,e.StickyPosition.LEFT_ALIGN_TOP,e.StickyPosition.LEFT_ALIGN_BOTTOM,e.StickyPosition.RIGHT_ALIGN_TOP,e.StickyPosition.RIGHT_ALIGN_BOTTOM,e.StickyPosition.BOTTOM_ALIGN_LEFT,e.StickyPosition.BOTTOM_ALIGN_RIGHT]),verticalArrowOffset:o.PropTypes.number,horizontalArrowOffset:o.PropTypes.number,shouldShowArrow:o.PropTypes.bool,shouldArrowDecrement:o.PropTypes.bool,className:o.PropTypes.string,isMaestroDesign:o.PropTypes.bool},n.defaultProps={verticalArrowOffset:0,horizontalArrowOffset:0,shouldShowArrow:!0,shouldArrowDecrement:!0,className:null,isMaestroDesign:!1};class a extends i.React$1.Component{constructor(){super(...arguments),this.state={isVisible:!1,targetNode:null,shouldAutoFocusDropdownContent:!1},this.hasOnShowNotBeenCalledSinceLastOpened=!1,this.updateTargetNode=()=>{const t=i.reactDom.exports.findDOMNode(this.refs.bubbleDropdownContainer).childNodes[0];return t&&(t.setAttribute("aria-expanded",this.state.isVisible),t.hasAttribute("id")||t.setAttribute("id",`bubbleDropdownTarget-${s.uniqueId()}`)),this.setState({targetNode:t})},this.showDropdown=()=>{if(!this.props.disabled)return this.setState({isVisible:!0})},this.hideDropdown=()=>{if(!this.props.disabled)return this.setState({isVisible:!1})},this._handleClick=t=>{const o=!(t.clientX>0&&t.clientY>0);return this.setState({shouldAutoFocusDropdownContent:o},this._toggle)},this._toggle=()=>{if(!this.props.disabled)return this.setState({isVisible:!this.state.isVisible})},this._hasShown=()=>{if(this.hasOnShowNotBeenCalledSinceLastOpened)return this.state.targetNode.setAttribute("aria-expanded",!0),this.props.onShowDropdown(),this.hasOnShowNotBeenCalledSinceLastOpened=!1},this._hasHidden=()=>(this.state.targetNode.setAttribute("aria-expanded",!1),this.props.onHideDropdown())}componentDidMount(){return this.updateTargetNode()}UNSAFE_componentWillUpdate(t,o){this.state.isVisible&&!this.props.disabled||!o.isVisible||t.disabled||(this.hasOnShowNotBeenCalledSinceLastOpened=!0)}componentDidUpdate(t,o){o.isVisible!==this.state.isVisible&&(this.state.isVisible||this._hasHidden());if(i.reactDom.exports.findDOMNode(this.refs.bubbleDropdownContainer).childNodes[0]!==this.state.targetNode)return this.updateTargetNode()}render(){const{targetNode:t}=this.state;return i.React$1.createElement("div",{className:"bubble-dropdown-v2-container",onClick:this._handleClick,ref:"bubbleDropdownContainer"},this.props.targetButton,this.state.isVisible&&!this.props.disabled&&t?i.React$1.createElement(e.PositionedOverlay,{targetNode:t,isTargetPositionFixed:this.props.targetFixed,isContentFocusable:this.props.isContentFocusable,shouldTrapKeyboardFocus:this.props.shouldTrapKeyboardFocus,shouldAutoFocusOverlayContent:this.state.shouldAutoFocusDropdownContent,position:this.props.position,positionOffset:{horizontal:this.props.horizontalDisplacement,vertical:this.props.verticalDisplacement},onRendered:()=>this._hasShown(),onBlur:()=>this.hideDropdown()},i.React$1.createElement(n,{ref:"bubbleDropdownContents",targetNode:t,position:this.props.position,verticalArrowOffset:this.props.verticalDisplacement,horizontalArrowOffset:this.props.horizontalDisplacement,shouldShowArrow:this.props.shouldShowArrow,className:this.props.className,shouldArrowDecrement:this.props.shouldArrowDecrement,isMaestroDesign:this.props.isMaestroDesign},this.props.children)):void 0)}}a.displayName="BubbleDropdown",a.propTypes={targetButton(t,o,i){if(null==t.targetButton||"button"!==t.targetButton.type)return new Error("BubbleDropdown's targetButton must be a `<button>`")},position:o.PropTypes.oneOf([e.StickyPosition.TOP_LEFT,e.StickyPosition.TOP,e.StickyPosition.TOP_RIGHT,e.StickyPosition.LEFT_TOP,e.StickyPosition.LEFT,e.StickyPosition.LEFT_BOTTOM,e.StickyPosition.RIGHT_TOP,e.StickyPosition.RIGHT,e.StickyPosition.RIGHT_BOTTOM,e.StickyPosition.BOTTOM_LEFT,e.StickyPosition.BOTTOM,e.StickyPosition.BOTTOM_RIGHT,e.StickyPosition.TOP_ALIGN_LEFT,e.StickyPosition.TOP_ALIGN_RIGHT,e.StickyPosition.LEFT_ALIGN_TOP,e.StickyPosition.LEFT_ALIGN_BOTTOM,e.StickyPosition.RIGHT_ALIGN_TOP,e.StickyPosition.RIGHT_ALIGN_BOTTOM,e.StickyPosition.BOTTOM_ALIGN_LEFT,e.StickyPosition.BOTTOM_ALIGN_RIGHT]),targetFixed:o.PropTypes.bool,verticalDisplacement:o.PropTypes.number,horizontalDisplacement:o.PropTypes.number,className:o.PropTypes.string,disabled:o.PropTypes.bool,shouldShowArrow:o.PropTypes.bool,isContentFocusable:o.PropTypes.bool,shouldTrapKeyboardFocus:o.PropTypes.bool,onShowDropdown:o.PropTypes.func,onHideDropdown:o.PropTypes.func,shouldArrowDecrement:o.PropTypes.bool,isMaestroDesign:o.PropTypes.bool},a.defaultProps={targetFixed:!1,verticalDisplacement:0,horizontalDisplacement:0,className:null,disabled:!1,shouldShowArrow:!0,isContentFocusable:!0,shouldTrapKeyboardFocus:!1,onShowDropdown:s.noop,onHideDropdown:s.noop,shouldArrowDecrement:!0,isMaestroDesign:!1};const p=o.requireCssWithComponent(a,["/static/metaserver/static/css/components/bubble_dropdown_v2-vflhhYVBe.css"]);t.BubbleDropdown=p}));
//# sourceMappingURL=c_ui_bubble_dropdown_v2.js-vfl9RmftI.map
