define(["exports","./e_edison","./e_ui_page_files_router","./c_files_view_file_thumbnail","./c_core_i18n","./c_content_suggestions_models_suggested_item","./c_lodash-es_lodash"],(function(e,t,s,i,a,n,o){"use strict";const l={type:s.FileTypes.FOLDER,icon:"folder"};class r extends t.React$1.PureComponent{constructor(e){super(e),this.cardRef=t.React$1.createRef(),this.onDismissItemClick=e=>{e.stopPropagation(),e.preventDefault();const{position:t,suggested:i,user:n,dismissSuggestedItem:o,logger:l,source:r}=this.props;l.logClickDismissSuggestedItem(i,"dismiss-suggested-item",t,r),o(n,i).then((()=>{l.logDismissSuggestedItem(i,"dismiss-suggested-item",t,"no_feedback_modal",this.props.source)})).catch((()=>{const e=i.filename;let t;t=e?a.intl.formatMessage({id:"YmEqih",defaultMessage:"There was a problem dismissing {item_name}"},{item_name:e}):a.intl.formatMessage({id:"rBSlLP",defaultMessage:"There was a problem dismissing your selection"}),s.Snackbar.fail(t,"content-suggestions")}))},this.onParentFolderClick=e=>{e.stopPropagation(),e.preventDefault();const{suggested:t,position:i,logger:a,openSuggestedParent:n,source:o}=this.props;n(t,(()=>a.logOpenParentFolder(t,"parent-folder",i,o)),s.isMetaKeyPressed(e))},this.onFilenameClick=e=>{e.preventDefault(),e.stopPropagation(),this.handleNavigation(e,"title")},this.onMouseEnter=()=>{this.props.shouldTruncateFilenameOnTileHover&&this.setState({shouldTruncateFilename:!0})},this.onMouseLeave=()=>{this.setState({shouldTruncateFilename:!1})},this.onFileThumbnailClick=e=>{e.preventDefault(),e.stopPropagation(),this.handleNavigation(e,"icon")},this.onFileThumbnailKeyPress=e=>{e.target===this.cardRef.current&&e.key===s.Key_enum.Key.Enter&&(e.preventDefault(),e.stopPropagation(),this.handleNavigation(e,"icon"))},this.handleNavigation=(e,t)=>{const{suggested:i,position:a,logger:n,openSuggestedItem:o}=this.props;o(i,(()=>n.logOpenSuggestedItem(i,t,a,this.props.source)),s.isMetaKeyPressed(e))},this.state={shouldTruncateFilename:!1}}render(){const{suggested:e,tileWidth:a,tileMarginRight:r,useTileWidthForCard:c,user:u,filenameMaxChars:h,filenameWidthAfterTruncation:f,subheaderLabelMaxChars:p,showIconsInsteadOfThumbnails:_,fileIconSize:b,isExtensionThumbnailableFnOverride:C}=this.props,v=n.suggestedItemToFileIconFields(e,_),T=e.breadcrumb.length?e.breadcrumb[0]:null,E=T?T.name:s.Viewer.get_root_name(u),k=T?T.url:s.browse_uri_for_fq_path(u,"").toString(),y=e.fqPath.split("/"),F=o.uniqueId("home__suggest_filename-");return y.pop(),t.React$1.createElement("div",{className:"home__suggest_card",onClick:this.onFileThumbnailClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onKeyPress:this.onFileThumbnailKeyPress,ref:this.cardRef,style:c?{width:a,marginRight:r}:void 0},t.React$1.createElement("a",{className:"home__suggest_image",href:e.url,tabIndex:-1,onClick:this.onFileThumbnailClick,"aria-hidden":"true",style:c?void 0:{width:a}},t.React$1.createElement(i.FileThumbnail,{file:v,thumbnailSize:256,iconSize:b||72,key:e.key,"aria-hidden":"true",isExtensionThumbnailableFnOverride:C})),t.React$1.createElement(g,{onClick:this.onDismissItemClick,folderId:F}),t.React$1.createElement("div",{className:"home__suggest_details",style:c?void 0:{width:a}},t.React$1.createElement(m,{filename:e.filename,url:e.url,onClick:this.onFilenameClick,maxChars:h,shouldTruncate:this.state.shouldTruncateFilename,widthAfterTruncation:f}),t.React$1.createElement("div",{className:"home__suggest_subheader"},t.React$1.createElement(s.FolderIcon,{file:l,className:"home__suggest_subheader-icon","aria-hidden":"true"}),t.React$1.createElement(d,{folderName:E,folderPathArray:y,folderUrl:k,folderId:F,onClick:this.onParentFolderClick,maxChars:p}))))}}r.displayName="SuggestedFileCard";const c=s.requireCssWithComponent(r,["/static/metaserver/static/css/dig-components/index.web-vflvPodS4.css"]),m=e=>{const{filename:i,onClick:a,url:n,maxChars:o,shouldTruncate:l,widthAfterTruncation:r}=e,c="home__suggest_filename";let m=s.Emstring.em_snippet(i,o||14,.5);if(l&&r){const e=document.getElementsByClassName(c)[0];if(e){const t=function(e){const t=window.getComputedStyle(e,null),s=t.getPropertyValue("font-weight")||"normal",i=t.getPropertyValue("font-size"),a=t.getPropertyValue("font-family");return`${s} ${i} ${a}`}(e);m=m.substring(0,function(e,t,s){let i=e.length;for(;u(e.substring(0,i),t)>s;)i--;return i}(m,t,r))}}const d=t.React$1.createElement("a",{className:c,href:n,onClick:a},m);return i!==m?t.React$1.createElement(s.Tooltip,{className:"home__suggest-v2_tooltip",id:"suggested-file-card-filename-tooltip",title:i,placement:"top"},d):d};function u(e,t){const s=document.createElement("canvas"),i=s&&s.getContext("2d")||null;if(!i)return-1;i.font=t;return i.measureText(e).width}const d=e=>{const{folderName:i,folderPathArray:a,folderUrl:n,folderId:o,onClick:l,maxChars:r}=e,c=s.Emstring.em_snippet(i,r||10,.5),m=t.React$1.createElement("a",{id:o,className:"home__suggest_subheader-label",href:n,onClick:l,"aria-label":i},c);return a.length>2?t.React$1.createElement(s.Tooltip,{className:"home__suggest-v2_tooltip",id:"suggested-file-card-v2-foldername-tooltip",title:a.join("/"),placement:"bottom"},m):i!==c?t.React$1.createElement(s.Tooltip,{className:"home__suggest-v2_tooltip",id:"suggested-file-card-v2-foldername-tooltip",title:i,placement:"bottom"},m):m},g=e=>{const i=s.useUniqueId({prefix:"home__suggest_dismiss-"});return t.React$1.createElement(s.IconButton,{id:i,variant:"transparent",className:"home__suggest_dismiss",onClick:e.onClick,"aria-label":a.intl.formatMessage({id:"KaeLBh",defaultMessage:"Dismiss suggestion"}),"aria-labelledby":s.classnames(i,e.folderId)},t.React$1.createElement(s.UIIcon,{src:s.CloseLine,"aria-hidden":"true"}))};e.SuggestedFileCard=c}));
//# sourceMappingURL=c_content_suggestions_suggested_file_card.js-vflOkEM_X.map
