define(["exports","./c_tslib","./e_ui_page_files_router","./e_edison","./c_vault_lib_urls","./c_api_v2_noauth_client"],(function(e,t,n,s,r,i){"use strict";const c="vault_session_token";function o(){return(new n.UserApiV2Client).ns("vault").rpc("get_metadata",{},{subjectUserId:n.mustGetActiveUserId()})}function u(){return(new n.UserApiV2Client).ns("vault").rpc("get_content_suggestions",{},{subjectUserId:n.mustGetActiveUserId()})}function a(){const e=n.mustGetActiveUserId();return n.UserLocalStorage.delete(e,c),(new n.UserApiV2Client).ns("vault").rpc("lock",{},{subjectUserId:e})}function d(e){const t=n.mustGetActiveUserId(),s={password:e};return(new n.UserApiV2Client).ns("vault").rpc("unlock",s,{subjectUserId:t}).then((e=>{const s=e.extend_session_token;return n.UserLocalStorage.set(t,c,s),e}))}function l(){const e=n.mustGetActiveUserId(),t={extend_session_token:n.UserLocalStorage.get(e,c)};return(new n.UserApiV2Client).ns("vault").rpc("extend_unlocked_session",t,{subjectUserId:e}).then((e=>{const t=e.extend_session_token;return n.UserLocalStorage.set(n.mustGetActiveUserId(),c,t),e}))}function _(e,t){const s={current_password:e,new_password:t};return(new n.UserApiV2Client).ns("vault").rpc("set_password",s,{subjectUserId:n.mustGetActiveUserId()})}function v(e){return t.__awaiter(this,void 0,void 0,(function*(){const t={events:[{event_action:e.eventAction,event_object:e.eventObject,action_surface:e.actionSurface,extra:JSON.stringify(e.extra||{})}]};let s;try{s=n.mustGetActiveUserId()}catch(e){return(new i.NoAuthApiV2Client).ns("vault").rpc("log_product_analytics_event_logged_out",t,{})}return(new n.UserApiV2Client).ns("vault").rpc("log_product_analytics_event",t,{subjectUserId:s})}))}function U(e){return t.__awaiter(this,void 0,void 0,(function*(){return(new n.UserApiV2Client).ns("vault").rpc("submit_feedback",e,{subjectUserId:n.mustGetActiveUserId()})}))}function p(){return t.__awaiter(this,void 0,void 0,(function*(){return(new n.UserApiV2Client).ns("vault").rpc("initiate_add_files_reminder",void 0,{subjectUserId:n.mustGetActiveUserId()})}))}function f(e){return t.__awaiter(this,void 0,void 0,(function*(){return(new n.UserApiV2Client).ns("vault").rpc("initiate_password_reset",e,{subjectUserId:n.mustGetActiveUserId()})}))}function w(e){return t.__awaiter(this,void 0,void 0,(function*(){return(new n.UserApiV2Client).ns("vault").rpc("benefactor/validate_invite",e,{subjectUserId:n.mustGetActiveUserId()})}))}var A=Object.freeze({__proto__:null,getMetadata:o,getContentSuggestions:u,lock:a,unlock:d,extendUnlockedSession:l,flatten:function(e){const t={password:e};return(new n.UserApiV2Client).ns("vault").rpc("flatten",t,{subjectUserId:n.mustGetActiveUserId()})},setPassword:_,create:function(){return(new n.UserApiV2Client).ns("vault").rpc("create",{},{subjectUserId:n.mustGetActiveUserId()})},logProductAnalyticsEvent:v,submitFeedback:U,initiateAddFilesReminder:p,initiatePasswordReset:f,performPasswordReset:function(e){return t.__awaiter(this,void 0,void 0,(function*(){return(new n.UserApiV2Client).ns("vault").rpc("perform_password_reset",e,{subjectUserId:n.mustGetActiveUserId()})}))},benefactorValidateInvite:w,beneficiarySendDownloadLink:function(e){return t.__awaiter(this,void 0,void 0,(function*(){const t={owner_email:e};return(new n.UserApiV2Client).ns("vault").rpc("beneficiary/send_download_link",t,{subjectUserId:n.mustGetActiveUserId()})}))},deleteVault:function(e){return t.__awaiter(this,void 0,void 0,(function*(){return(new n.UserApiV2Client).ns("vault").rpc("delete",e,{subjectUserId:n.mustGetActiveUserId()})}))}});e.api_esnext=A,e.benefactorValidateInvite=w,e.extendUnlockedSession=l,e.getContentSuggestions=u,e.getMetadata=o,e.initiateAddFilesReminder=p,e.initiatePasswordReset=f,e.lock=a,e.logProductAnalyticsEvent=v,e.setPassword=_,e.submitFeedback=U,e.unlock=d,e.useVaultLockManager=(e,t,i)=>{s.react.exports.useEffect((()=>{i&&(n.UserLocalStorage.delete(n.mustGetActiveUserId(),c),r.redirectOnLockExpiration())}),[i]),s.react.exports.useEffect((()=>{if(null==t)return;const n=t-Date.now(),s=setTimeout(e,Math.max(5e3,n));return()=>{clearTimeout(s)}}),[t,e])}}));
//# sourceMappingURL=c_vault_lib_api.js-vflzUyY4c.map
